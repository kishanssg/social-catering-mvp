import{c as je,a as W,j as e,C as re}from"./index-osaUwGyb.js";import{r as d,b as Ne,f as ve}from"./vendor-D4VeuP1H.js";import{f as _e,a as te}from"./dateUtils-DbQ3rpJl.js";import{X as Q,T as we}from"./Toast-CC8pQhSy.js";import{C as B,f as U}from"./index-COMDDm9r.js";import{M as H}from"./map-pin-CnjmBPbQ.js";import{U as K}from"./users-BH7DCPUm.js";import{A as Y}from"./alert-circle-CJyRylVs.js";import{S as Z,A as ke,C as J,T as ie}from"./ConfirmationModal-BfxemWax.js";import{D as le}from"./dollar-sign-BEdYK9I2.js";import{C as Ce}from"./x-circle-C-byjyVw.js";import{P as ne}from"./plus-TBkU-sjH.js";import{C as G}from"./calendar-CyKH8LIJ.js";import{P as Se}from"./pen-square-D9VdSRNh.js";import{C as oe}from"./chevron-down-eucs6phP.js";import{p as V}from"./index-JNbz_lUZ.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=je("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);function Fe({shiftId:F,onClose:N,onSuccess:E}){var O,n;const[r,L]=d.useState(null),[m,c]=d.useState([]),[i,$]=d.useState([]),[u,k]=d.useState(""),[f,a]=d.useState(null),[T,x]=d.useState({}),[y,D]=d.useState(!0),[h,P]=d.useState(!1),[p,M]=d.useState(null),R=(s,l)=>{x(g=>({...g,[s]:l}))};d.useEffect(()=>{v()},[F]),d.useEffect(()=>{r&&C()},[r]),d.useEffect(()=>{if(!u)$(m);else{const s=u.toLowerCase();$(m.filter(l=>{var g;return l.first_name.toLowerCase().includes(s)||l.last_name.toLowerCase().includes(s)||l.email.toLowerCase().includes(s)||((g=l.skills_json)==null?void 0:g.some(_=>_.toLowerCase().includes(s)))}))}},[u,m]);async function v(){try{const s=await W.get(`/shifts/${F}`);s.data.status==="success"?L(s.data.data):M("Failed to load shift details")}catch(s){console.error("Failed to load shift details:",s),M("Failed to load shift details")}}async function C(){try{const s=await W.get("/workers?active=true");if(s.data.status==="success"){const l=s.data.data.workers||s.data.data;if(r!=null&&r.role_needed){const g=l.filter(_=>{var j;return(j=_.skills_json)==null?void 0:j.includes(r.role_needed)});c(g)}else c(l)}else M("Failed to load workers")}catch(s){console.error("Failed to load workers:",s),M("Failed to load workers")}finally{D(!1)}}async function A(){var s,l,g,_,j,z;if(!(!f||!r)){P(!0),M(null);try{const S=(await W.post("/staffing",{assignment:{shift_id:r.id,worker_id:f.id,status:"assigned",assigned_at_utc:new Date().toISOString(),hourly_rate:T[f.id]||Number(r.pay_rate)||0}})).data;if(S.status==="success")E();else{let I=S.message||"Failed to assign worker";S.details&&S.details.length>0?I+=`

Details:
â€¢ `+S.details.join(`
â€¢ `):S.errors&&(I+=`

Details:
â€¢ `+S.errors.join(`
â€¢ `)),M(I)}}catch(w){console.error("Failed to assign worker:",w);let S="Failed to assign worker";(l=(s=w.response)==null?void 0:s.data)!=null&&l.details&&w.response.data.details.length>0?S+=`

Details:
â€¢ `+w.response.data.details.join(`
â€¢ `):(_=(g=w.response)==null?void 0:g.data)!=null&&_.errors?S+=`

Details:
â€¢ `+w.response.data.errors.join(`
â€¢ `):(z=(j=w.response)==null?void 0:j.data)!=null&&z.message?S=w.response.data.message:w.message&&(S=w.message),M(S)}finally{P(!1)}}}return y?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-white rounded-lg p-6 max-w-2xl w-full mx-4",children:e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-teal-600"})})})}):e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full mx-4 max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Assign Worker"}),r&&e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[r.client_name," â€¢ ",r.role_needed]})]}),e.jsx("button",{onClick:N,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition",children:e.jsx(Q,{size:20})})]}),e.jsxs("div",{className:"flex h-[600px]",children:[e.jsx("div",{className:"w-1/3 border-r border-gray-200 p-6 bg-gray-50",children:r?e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Shift Details"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(B,{size:16,className:"text-gray-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:_e(r.start_time_utc)}),e.jsxs("div",{className:"text-sm text-gray-600",children:[te(r.start_time_utc)," - ",te(r.end_time_utc)]})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(H,{size:16,className:"text-gray-400 mt-0.5 flex-shrink-0"}),e.jsx("div",{className:"text-sm text-gray-900",children:r.location||((n=(O=r.event)==null?void 0:O.venue)==null?void 0:n.formatted_address)||"Location not specified"})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(K,{size:16,className:"text-gray-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-900",children:r.role_needed}),r.required_skill&&e.jsxs("div",{className:"text-sm text-gray-600",children:["Requires: ",r.required_skill]})]})]}),e.jsxs("div",{className:"pt-2 border-t border-gray-200",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Pay Rate:"})," $",(Number(r.pay_rate)||0).toFixed(2),"/hour"]}),r.uniform_name&&e.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[e.jsx("span",{className:"font-medium",children:"Uniform:"})," ",r.uniform_name]})]}),r.notes&&e.jsx("div",{className:"pt-2 border-t border-gray-200",children:e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Notes:"}),e.jsx("div",{className:"mt-1 whitespace-pre-line",children:r.notes.split("Uniform:").map((s,l)=>l===0?s.trim():e.jsxs("div",{children:[e.jsx("br",{}),e.jsx("span",{className:"font-medium",children:"Uniform:"})," ",s.trim()]},l))})]})})]})]})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Y,{size:32,className:"text-gray-400 mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Failed to load shift details"})]})}),e.jsxs("div",{className:"flex-1 flex flex-col",children:[e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsxs("div",{className:"relative",children:[e.jsx(Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:16}),e.jsx("input",{type:"text",placeholder:"Search workers...",value:u,onChange:s=>k(s.target.value),className:"w-full pl-9 pr-4 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-1 focus:ring-teal-500 focus:border-teal-500"})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:p?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Y,{size:32,className:"text-red-400 mx-auto mb-2"}),e.jsx("div",{className:"text-sm text-red-600",children:p.split(`
`).map((s,l)=>e.jsx("p",{className:s.startsWith("â€¢")?"ml-2":"",children:s},l))})]}):i.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(K,{size:32,className:"text-gray-400 mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-gray-600",children:u?"No workers found matching your search":r!=null&&r.role_needed?`No workers found with "${r.role_needed}" skill`:"No available workers"}),(r==null?void 0:r.role_needed)&&!u&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:['Try adding "',r.role_needed,'" skill to workers or select a different shift.']})]}):e.jsx("ul",{children:i.map(s=>{const l=(f==null?void 0:f.id)===s.id,g=T[s.id]||Number(r.pay_rate)||0,_=T[s.id]&&T[s.id]!==(Number(r.pay_rate)||0);return e.jsxs("li",{className:`flex items-center justify-between px-4 py-3 border-b last:border-b-0 ${l?"bg-teal-50":"bg-white"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"w-8 h-8 rounded-full bg-teal-100 flex items-center justify-center text-teal-700 text-xs font-semibold",children:[s.first_name[0],s.last_name[0]]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[s.first_name," ",s.last_name]}),e.jsx("div",{className:"text-xs text-gray-600",children:(s.skills_json||[]).slice(0,3).join(", ")})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[_&&e.jsx("span",{className:"text-xs text-amber-600 font-medium",children:"Custom"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(le,{className:"h-4 w-4 text-gray-400"}),e.jsx("input",{type:"number",step:"1",min:"0",placeholder:(Number(r.pay_rate)||0).toString(),value:g||"",onChange:j=>{const z=j.target.value;(z===""||/^\d*\.?\d*$/.test(z))&&R(s.id,parseFloat(z)||0)},className:"w-20 px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent",onMouseDown:j=>j.stopPropagation(),onFocus:j=>j.stopPropagation()}),e.jsx("span",{className:"text-xs text-gray-600",children:"/hr"})]}),e.jsx("button",{onClick:()=>a(s),className:`px-3 py-1.5 rounded-lg text-sm font-medium border ${l?"bg-teal-600 text-white border-teal-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:l?"Selected":"Select"})]})]},s.id)})})}),e.jsxs("div",{className:"p-4 border-t border-gray-200 bg-white",children:[p&&e.jsx("div",{className:"mb-3 p-2 bg-red-50 border border-red-200 rounded text-xs text-red-600",children:p.split(`
`).map((s,l)=>e.jsx("p",{className:s.startsWith("â€¢")?"ml-2":"",children:s},l))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:N,className:"flex-1 px-3 py-2 text-sm bg-gray-100 text-gray-700 font-medium rounded hover:bg-gray-200 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:A,disabled:!f||h,className:"flex-1 px-3 py-2 text-sm bg-teal-600 text-white font-medium rounded hover:bg-teal-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:h?"Assigning...":"Assign Worker"})]})]})]})]})]})})}function Ee({isOpen:F,eventId:N,roleName:E,unfilledShiftIds:r,defaultPayRate:L,onClose:m,onDone:c}){const[i,$]=d.useState([]),[u,k]=d.useState([]),[f,a]=d.useState(""),[T,x]=d.useState(!1),[y,D]=d.useState(!1),[h,P]=d.useState({}),[p,M]=d.useState(0),R=(n,s)=>{P(l=>({...l,[n]:s}))};d.useEffect(()=>{F&&($([]),k([]),a(""),P({}),x(!0),(async()=>{var n;try{const s=await W.get("/workers?active=true"),g=(((n=s.data)==null?void 0:n.data)||s.data||[]).filter(_=>(_.skills_json||[]).includes(E));if(console.log(`QuickFill: Found ${g.length} workers with skill "${E}"`),$(g),L){const _=Number(L)||0;M(_),console.log(`QuickFill: Default pay rate for ${E}: $${_}/hr`)}else console.log(`QuickFill: No default pay rate provided for ${E}`)}catch(s){console.error("Error loading workers:",s)}finally{x(!1)}})())},[F,E,L]);const v=d.useMemo(()=>{const n=f.trim().toLowerCase(),s=i;return n?s.filter(l=>`${l.first_name} ${l.last_name}`.toLowerCase().includes(n)||(l.email||"").toLowerCase().includes(n)):s},[i,f]),C=r.length,A=n=>{k(s=>s.includes(n)?s.filter(l=>l!==n):s.length>=C?s:[...s,n])},O=async()=>{var l;if(u.length===0||C===0)return;D(!0);let n=0,s=0;try{const g=u.map(z=>i.find(w=>w.id===z)).filter(Boolean),_=[...r];let j=0;for(;_.length>0&&g.length>0;){const z=g[j%g.length],w=_.shift();try{const S=h[z.id]||Number(p)||0||0;((l=(await W.post("/staffing",{assignment:{shift_id:w,worker_id:z.id,status:"assigned",assigned_at_utc:new Date().toISOString(),hourly_rate:S}})).data)==null?void 0:l.status)==="success"?n+=1:s+=1}catch{s+=1}j+=1}c({assigned:n,conflicts:s})}finally{D(!1)}};return F?e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[10000] flex items-center justify-center p-4",onClick:n=>{n.target===n.currentTarget&&m()},children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-3xl w-full overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-5 border-b border-gray-100",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-bold text-gray-900",children:["Quick Fill â€” ",E]}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Unfilled shifts: ",C]})]}),e.jsx("button",{onClick:m,className:"w-8 h-8 rounded-lg hover:bg-gray-100 flex items-center justify-center text-gray-500",children:e.jsx(Q,{size:18})})]}),e.jsxs("div",{className:"px-6 py-5 space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Z,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx("input",{value:f,onChange:n=>a(n.target.value),placeholder:"Search eligible workersâ€¦",className:"w-full pl-9 pr-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500"})]}),e.jsx("div",{className:"max-h-[340px] overflow-y-auto border border-gray-200 rounded-lg",children:T?e.jsx("div",{className:"p-6 text-center text-gray-500",children:"Loadingâ€¦"}):v.length===0?e.jsx("div",{className:"p-6 text-center text-gray-500",children:"No eligible workers"}):e.jsx("ul",{children:v.map(n=>{const s=u.includes(n.id);return e.jsxs("li",{className:`flex items-center justify-between px-4 py-3 border-b last:border-b-0 ${s?"bg-teal-50":"bg-white"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"w-8 h-8 rounded-full bg-teal-100 flex items-center justify-center text-teal-700 text-xs font-semibold",children:[n.first_name[0],n.last_name[0]]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[n.first_name," ",n.last_name]}),e.jsx("div",{className:"text-xs text-gray-600",children:(n.skills_json||[]).slice(0,3).join(", ")})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[h[n.id]&&h[n.id]!==(Number(p)||0)&&e.jsx("span",{className:"text-xs text-amber-600 font-medium",children:"Custom"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(le,{className:"h-4 w-4 text-gray-400"}),e.jsx("input",{type:"number",step:"1",min:"0",placeholder:Number(p)?(Number(p)||0).toString():"Rate",value:h[n.id]||Number(p)||0||"",onChange:l=>{const g=l.target.value;(g===""||/^\d*\.?\d*$/.test(g))&&R(n.id,parseFloat(g)||0)},className:"w-20 px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent",onMouseDown:l=>l.stopPropagation(),onFocus:l=>l.stopPropagation()}),e.jsx("span",{className:"text-xs text-gray-600",children:"/hr"})]}),e.jsx("button",{onClick:()=>A(n.id),disabled:!s&&u.length>=C,className:`px-3 py-1.5 rounded-lg text-sm font-medium border ${s?"bg-teal-600 text-white border-teal-600":u.length>=C?"bg-gray-100 text-gray-400 border-gray-200 cursor-not-allowed":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:s?"Selected":"Select"})]})]},n.id)})})}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[e.jsx(Ce,{size:16,className:"text-teal-600"}),e.jsxs("span",{children:["Will assign ",e.jsx("strong",{children:Math.min(u.length,C)})," worker",Math.min(u.length,C)!==1?"s":""," to ",C," shift",C!==1?"s":"","."]})]}),(Number(p)||0)>0&&e.jsxs("div",{className:"border-t pt-4 mt-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-gray-600",children:["Default rate for ",E,":"]}),e.jsxs("span",{className:"font-medium",children:["$",(Number(p)||0).toFixed(2),"/hr"]})]}),Object.keys(h).length>0&&e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["ðŸ’¡ Empty fields will use default rate ($",(Number(p)||0).toFixed(2),"/hr)"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[e.jsx(ke,{size:14,className:"text-yellow-600"}),"Conflicts and already-filled shifts will be skipped automatically."]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3 px-6 py-5 bg-gray-50",children:[e.jsx("button",{onClick:m,className:"px-4 py-2 rounded-lg border border-gray-300 text-gray-700 hover:bg-gray-100",children:"Cancel"}),e.jsx("button",{onClick:O,disabled:y||u.length===0||C===0,className:"px-5 py-2 rounded-lg bg-teal-600 text-white font-semibold hover:bg-teal-700 disabled:opacity-50",children:y?"Assigningâ€¦":`Assign to ${C} shifts`})]})]})}):null}function Je(){const F=Ne(),[N,E]=ve(),r=(N.get("tab")==="completed"?"completed":N.get("tab"))||"active",L=N.get("filter")||"all",[m,c]=d.useState(r),[i,$]=d.useState(L),[u,k]=d.useState(""),[f,a]=d.useState("date"),[T,x]=d.useState(!0),[y,D]=d.useState([]),[h,P]=d.useState(new Set),[p,M]=d.useState({isOpen:!1}),[R,v]=d.useState({isVisible:!1,message:"",type:"success"}),[C,A]=d.useState({isOpen:!1,isLoading:!1}),[O,n]=d.useState({isOpen:!1,isLoading:!1}),[s,l]=d.useState({isOpen:!1,isLoading:!1}),[g,_]=d.useState({isOpen:!1,unfilledShiftIds:[]});d.useEffect(()=>{j()},[m,i]),d.useEffect(()=>{const t=(N.get("tab")==="completed"?"completed":N.get("tab"))||"active",o=N.get("filter")||"all";t!==m&&c(t),o!==i&&$(o)},[N,m,i]),d.useEffect(()=>{const t=N.get("event_id"),o=N.get("shift_id");if(t){const b=parseInt(t);isNaN(b)||(P(new Set([b])),o&&console.log(`Auto-expanding event ${b} with shift ${o}`))}},[N]);async function j(){x(!0);try{const o=`/events?tab=${m==="completed"?"completed":m}${i!=="all"?`&filter=${i}`:""}`;console.log("Loading events with URL:",o,"filterStatus:",i);const b=await W.get(o);b.data.status==="success"&&(console.log("Received events:",b.data.data.length),D(b.data.data))}catch(t){console.error("Failed to load events:",t)}finally{x(!1)}}const z=t=>{c(t),E({tab:t}),$("all")},w=t=>{$(t)},S=t=>{const o=new Set(h);o.has(t)?o.delete(t):o.add(t),P(o)};async function I(t){const o=y==null?void 0:y.find(b=>b.id===t);l({isOpen:!0,isLoading:!1,eventId:t,eventTitle:o==null?void 0:o.title})}async function de(){if(s.eventId){l(t=>({...t,isLoading:!0}));try{const t=await W.delete(`/events/${s.eventId}`);t.data.status==="success"?(l({isOpen:!1,isLoading:!1}),v({isVisible:!0,message:`"${t.data.event_title}" moved to trash`,type:"success",action:{label:"Undo",onClick:()=>ce(t.data.event_id),variant:"primary"}}),j()):v({isVisible:!0,message:t.data.message||"Failed to delete event",type:"error"})}catch(t){console.error("Failed to delete event:",t),v({isVisible:!0,message:"Failed to delete event",type:"error"})}finally{l(t=>({...t,isLoading:!1}))}}}async function ce(t){try{const o=await W.post(`/events/${t}/restore`);o.data.status==="success"?(v({isVisible:!0,message:"Event restored to draft",type:"success"}),j()):v({isVisible:!0,message:o.data.message||"Failed to restore event",type:"error"})}catch(o){console.error("Failed to restore event:",o),v({isVisible:!0,message:"Failed to restore event",type:"error"})}}function me(){l({isOpen:!1,isLoading:!1})}function ee(t){A({isOpen:!0,eventId:t,isLoading:!1})}async function xe(){if(C.eventId){A(t=>({...t,isLoading:!0}));try{const t=await W.post(`/events/${C.eventId}/publish`);t.data.status==="success"?(v({isVisible:!0,message:t.data.message||"Event published",type:"success"}),A({isOpen:!1,isLoading:!1}),j()):(v({isVisible:!0,message:t.data.message||"Failed to publish event",type:"error"}),A({isOpen:!1,isLoading:!1}))}catch(t){console.error("Failed to publish event:",t),v({isVisible:!0,message:"Failed to publish event",type:"error"}),A({isOpen:!1,isLoading:!1})}}}function ge(){A({isOpen:!1,isLoading:!1})}function ue(t,o){n({isOpen:!0,assignmentId:t,isLoading:!1,workerName:o})}async function fe(){var t,o;if(O.assignmentId){n(b=>({...b,isLoading:!0}));try{const b=await W.delete(`/staffing/${O.assignmentId}`);((t=b.data)==null?void 0:t.status)==="success"?(v({isVisible:!0,message:"Worker unassigned",type:"success"}),n({isOpen:!1,isLoading:!1}),j()):(v({isVisible:!0,message:((o=b.data)==null?void 0:o.message)||"Failed to unassign worker",type:"error"}),n({isOpen:!1,isLoading:!1}))}catch(b){console.error("Failed to unassign worker:",b),v({isVisible:!0,message:"Failed to unassign worker",type:"error"}),n({isOpen:!1,isLoading:!1})}}}const he=t=>{M({isOpen:!0,shiftId:t})},se=()=>{M({isOpen:!1})},pe=()=>{se(),v({isVisible:!0,message:"Worker assigned successfully",type:"success"}),j()},X=y.filter(t=>{var o;if(u){const b=u.toLowerCase();if(!(t.title.toLowerCase().includes(b)||((o=t.venue)==null?void 0:o.name.toLowerCase().includes(b))))return!1}if(m==="active")switch(i){case"needs_workers":return t.unfilled_roles_count>0;case"partially_filled":return t.unfilled_roles_count>0&&t.assigned_workers_count>0;case"fully_staffed":return t.unfilled_roles_count===0&&t.assigned_workers_count>0;case"all":default:return!0}return!0}).sort((t,o)=>{var b,q;switch(f){case"name":return t.title.localeCompare(o.title);case"staffing":return t.staffing_percentage-o.staffing_percentage;case"date":default:const ye=((b=t.schedule)==null?void 0:b.start_time_utc)||t.created_at,be=((q=o.schedule)==null?void 0:q.start_time_utc)||o.created_at;return new Date(ye).getTime()-new Date(be).getTime()}});return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsxs("div",{className:"max-w-7xl mx-auto p-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Events"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage events and assign workers"})]}),e.jsxs("button",{onClick:()=>F("/events/create"),className:"flex items-center gap-2 px-4 py-2 bg-teal-600 text-white font-medium rounded-lg hover:bg-teal-700 transition-colors shadow-sm",children:[e.jsx(ne,{size:20}),"Create New Event"]})]}),e.jsxs("div",{className:"flex gap-6 border-b border-gray-200 mb-6",children:[e.jsx("button",{onClick:()=>z("draft"),className:`pb-3 px-1 font-medium transition-colors border-b-2 ${m==="draft"?"border-teal-600 text-teal-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Draft Events"}),e.jsx("button",{onClick:()=>z("active"),className:`pb-3 px-1 font-medium transition-colors border-b-2 ${m==="active"?"border-teal-600 text-teal-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Active Events"}),e.jsx("button",{onClick:()=>z("completed"),className:`pb-3 px-1 font-medium transition-colors border-b-2 ${m==="completed"?"border-teal-600 text-teal-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Completed Events"})]}),e.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center gap-4 mb-6",children:[e.jsxs("div",{className:"flex-1 max-w-md relative",children:[e.jsx(Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),e.jsx("input",{type:"text",placeholder:"Search events or venues...",value:u,onChange:t=>k(t.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent"})]}),e.jsxs("select",{value:f,onChange:t=>a(t.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500 bg-white",children:[e.jsx("option",{value:"date",children:"Sort by Date"}),e.jsx("option",{value:"name",children:"Sort by Name"}),m!=="draft"&&e.jsx("option",{value:"staffing",children:"Sort by Staffing"})]}),m==="active"&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>w("all"),className:`px-3 py-2 text-sm font-medium rounded-lg transition ${i==="all"?"bg-teal-100 text-teal-700":"bg-white text-gray-600 hover:bg-gray-50 border border-gray-300"}`,children:"All"}),e.jsx("button",{onClick:()=>w("needs_workers"),className:`px-3 py-2 text-sm font-medium rounded-lg transition ${i==="needs_workers"?"bg-red-100 text-red-700":"bg-white text-gray-600 hover:bg-gray-50 border border-gray-300"}`,children:"Needs Workers"}),e.jsx("button",{onClick:()=>w("partially_filled"),className:`px-3 py-2 text-sm font-medium rounded-lg transition ${i==="partially_filled"?"bg-yellow-100 text-yellow-700":"bg-white text-gray-600 hover:bg-gray-50 border border-gray-300"}`,children:"Partial"}),e.jsx("button",{onClick:()=>w("fully_staffed"),className:`px-3 py-2 text-sm font-medium rounded-lg transition ${i==="fully_staffed"?"bg-green-100 text-green-700":"bg-white text-gray-600 hover:bg-gray-50 border border-gray-300"}`,children:"Ready"})]})]}),T?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-teal-600"})}):e.jsxs(e.Fragment,{children:[m==="draft"&&e.jsx($e,{events:X,onDelete:I,onPublish:ee,onNavigate:t=>F(t),searchQuery:u}),m==="active"&&e.jsx(Le,{events:X,expandedEvents:h,onToggleEvent:S,onAssignWorker:he,onUnassign:ue,onQuickFill:(t,o,b,q)=>_({isOpen:!0,eventId:t,roleName:o,unfilledShiftIds:b,payRate:q}),onPublish:ee,onDelete:I,searchQuery:u}),m==="completed"&&e.jsx(Te,{events:X,expandedEvents:h,onToggleEvent:S,searchQuery:u})]})]}),p.isOpen&&p.shiftId&&e.jsx(Fe,{shiftId:p.shiftId,onClose:se,onSuccess:pe}),e.jsx(we,{isVisible:R.isVisible,message:R.message,type:R.type,action:R.action,onClose:()=>v({...R,isVisible:!1})}),e.jsx(J,{isOpen:C.isOpen,onClose:ge,onConfirm:xe,title:"Publish Event",message:"Publish this event? This will create shifts and make them available for staffing.",confirmText:C.isLoading?"Publishingâ€¦":"Publish",cancelText:"Cancel",isLoading:C.isLoading,isDestructive:!1}),e.jsx(J,{isOpen:O.isOpen,onClose:()=>n({isOpen:!1,isLoading:!1}),onConfirm:fe,title:"Unassign Worker",message:`Remove ${O.workerName||"this worker"} from this shift?`,confirmText:O.isLoading?"Removingâ€¦":"Unassign",cancelText:"Cancel",isLoading:O.isLoading,isDestructive:!0}),e.jsx(J,{isOpen:s.isOpen,onClose:me,onConfirm:de,title:"Delete Event",message:`Are you sure you want to delete "${s.eventTitle}"? This action cannot be undone.`,confirmText:s.isLoading?"Deletingâ€¦":"Delete",cancelText:"Cancel",isLoading:s.isLoading,isDestructive:!0}),e.jsx(Ee,{isOpen:g.isOpen,eventId:g.eventId||0,roleName:g.roleName||"",unfilledShiftIds:g.unfilledShiftIds,defaultPayRate:g.payRate,onClose:()=>_({isOpen:!1,unfilledShiftIds:[]}),onDone:({assigned:t,conflicts:o})=>{_({isOpen:!1,unfilledShiftIds:[]}),v({isVisible:!0,message:`Assigned ${t} workers â€¢ ${o} skipped`,type:o>0?"error":"success"}),j()}})]})}function $e({events:F,onDelete:N,onPublish:E,onNavigate:r,searchQuery:L}){const m=i=>i?U(V(i),"MMM d, yyyy"):"No date set",c=i=>i?U(V(i),"h:mm a"):"";return F.length===0?e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ“…"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:L?"No draft events found":"No draft events yet"}),e.jsx("p",{className:"text-gray-600 mb-6",children:L?"Try adjusting your search query":"Create your first event to get started"}),!L&&e.jsxs("button",{onClick:()=>r("/events/create"),className:"inline-flex items-center gap-2 px-4 py-2 bg-teal-600 text-white font-medium rounded-lg hover:bg-teal-700 transition-colors",children:[e.jsx(ne,{size:20}),"Create Event"]})]}):e.jsx("div",{className:"space-y-4",children:F.map(i=>e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 hover:shadow-md transition-shadow",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 flex-1",children:i.title}),e.jsx("span",{className:"px-2.5 py-1 bg-gray-100 text-gray-700 text-xs font-medium rounded-full",children:"Draft"})]}),i.venue&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 mb-2",children:[e.jsx(H,{size:16,className:"text-gray-400 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:i.venue.name})]}),i.schedule&&e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600 mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(G,{size:16,className:"text-gray-400 flex-shrink-0"}),e.jsx("span",{children:m(i.schedule.start_time_utc)})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(B,{size:16,className:"text-gray-400 flex-shrink-0"}),e.jsxs("span",{children:[c(i.schedule.start_time_utc)," - ",c(i.schedule.end_time_utc)]})]})]}),i.total_workers_needed>0&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(K,{size:16,className:"text-gray-400"}),e.jsxs("span",{children:[i.total_workers_needed," workers needed"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>r(`/events/${i.id}/edit`),className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition",title:"Edit",children:e.jsx(Se,{size:18})}),e.jsx("button",{onClick:()=>E(i.id),className:"px-4 py-2 bg-teal-600 text-white text-sm font-medium rounded-lg hover:bg-teal-700 transition-colors",children:"Publish"}),e.jsx("button",{onClick:()=>N(i.id),className:"p-2 text-red-600 hover:text-red-700 hover:bg-red-50 rounded-lg transition",title:"Delete",children:e.jsx(ie,{size:18})})]})]})})},i.id))})}function Le({events:F,expandedEvents:N,onToggleEvent:E,onAssignWorker:r,onUnassign:L,onQuickFill:m,onPublish:c,onDelete:i,searchQuery:$}){const u=a=>U(V(a),"EEE, MMM d, yyyy"),k=a=>U(V(a),"h:mm a"),f=a=>{switch(a){case"fully_staffed":return e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 bg-green-100 text-green-700 text-xs font-medium rounded-full",children:[e.jsx(ae,{size:14}),"Ready"]});case"partially_staffed":return e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 bg-yellow-100 text-yellow-700 text-xs font-medium rounded-full",children:[e.jsx(Y,{size:14}),"Partial"]});case"needs_workers":return e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 bg-red-100 text-red-700 text-xs font-medium rounded-full",children:[e.jsx(Q,{size:14}),"Needs Workers"]});default:return null}};return F.length===0?e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ“…"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:$?"No active events found":"No active events"}),e.jsx("p",{className:"text-gray-600",children:$?"Try adjusting your search query or filters":"Publish draft events to see them here"})]}):e.jsx("div",{className:"space-y-4",children:F.map(a=>{const T=N.has(a.id);return e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[e.jsxs("div",{onClick:()=>E(a.id),className:"w-full px-6 py-4 flex items-center justify-between hover:bg-gray-50 transition-colors cursor-pointer",children:[e.jsxs("div",{className:"flex-1 text-left",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:a.title}),f(a.staffing_status)]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600 mb-3",children:[a.venue&&e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(H,{size:14,className:"text-gray-400"}),a.venue.name]}),a.schedule&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(G,{size:14,className:"text-gray-400"}),u(a.schedule.start_time_utc)]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(B,{size:14,className:"text-gray-400"}),k(a.schedule.start_time_utc)]})]})]}),e.jsxs("div",{className:"mb-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm mb-1",children:[e.jsxs("span",{className:"font-medium text-gray-700",children:[a.assigned_workers_count," of ",a.total_workers_needed," roles filled"]}),e.jsxs("span",{className:"font-semibold text-gray-900",children:[a.staffing_percentage,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-full rounded-full transition-all ${a.staffing_percentage===100?"bg-green-500":a.staffing_percentage>0?"bg-yellow-500":"bg-red-500"}`,style:{width:`${a.staffing_percentage}%`}})})]}),a.unfilled_roles_count>0&&e.jsxs("p",{className:"text-sm text-red-600 font-medium",children:[a.unfilled_roles_count," role",a.unfilled_roles_count!==1?"s":""," still need workers"]}),a.shifts_by_role&&a.shifts_by_role.length>0&&e.jsxs("div",{className:"text-sm text-gray-600 mt-2",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Est. Cost: "}),e.jsxs("span",{className:"font-semibold text-green-600",children:["$",(()=>{let x=0;return a.shifts_by_role.forEach(y=>{y.shifts.forEach(D=>{const h=(new Date(D.end_time_utc).getTime()-new Date(D.start_time_utc).getTime())/36e5;D.assignments.forEach(P=>{const p=Number(P.hourly_rate||D.pay_rate||0);x+=p*h})})}),x.toFixed(0)})()]})]})]}),e.jsxs("div",{className:"ml-4 flex items-center gap-2",children:[(!a.shifts_by_role||a.shifts_by_role.length===0)&&i&&e.jsx("button",{onClick:x=>{x.stopPropagation(),i(a.id)},className:"px-3 py-1.5 bg-red-600 text-white text-sm font-medium rounded-lg hover:bg-red-700 transition-colors",children:"Delete Event"}),i&&e.jsx("button",{onClick:x=>{x.stopPropagation(),i(a.id)},title:"Delete",className:"p-1.5 text-red-600 hover:text-red-700 hover:bg-red-50 rounded transition-colors",children:e.jsx(ie,{size:14})}),e.jsx("div",{className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:T?e.jsx(re,{size:24,className:"text-gray-600 hover:text-gray-800"}):e.jsx(oe,{size:24,className:"text-gray-600 hover:text-gray-800"})})]})]}),T&&e.jsx("div",{className:"border-t border-gray-200 bg-gray-50 px-6 py-4",children:a.shifts_by_role&&a.shifts_by_role.length>0?e.jsx("div",{className:"space-y-4",children:a.shifts_by_role.map(x=>e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:x.role_name}),e.jsxs("span",{className:"text-sm text-gray-600",children:[x.filled_shifts,"/",x.total_shifts," assigned"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[x.filled_shifts<x.total_shifts&&e.jsxs("span",{className:"px-2.5 py-1 bg-red-100 text-red-700 text-xs font-medium rounded-full",children:[x.total_shifts-x.filled_shifts," needed"]}),x.filled_shifts<x.total_shifts&&e.jsx("button",{onClick:y=>{var P;y.stopPropagation();const D=x.shifts.filter(p=>p.staffing_progress.percentage<100).sort((p,M)=>new Date(p.start_time_utc).getTime()-new Date(M.start_time_utc).getTime()).map(p=>p.id),h=(P=x.shifts[0])==null?void 0:P.pay_rate;m(a.id,x.role_name,D,h)},className:"px-2.5 py-1 text-xs font-semibold bg-teal-600 text-white rounded hover:bg-teal-700",title:"Quick Fill by Skill",children:"Quick Fill by Skill"})]})]}),e.jsx("div",{className:"space-y-2",children:x.shifts.map((y,D)=>e.jsxs("div",{className:"flex items-center justify-between py-2 px-3 bg-gray-50 rounded border border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-6 h-6 bg-gray-200 text-gray-700 rounded-md flex items-center justify-center text-xs font-medium",children:D+1}),e.jsxs("span",{className:"text-sm text-gray-700",children:[k(y.start_time_utc)," - ",k(y.end_time_utc)]}),y.assignments.length>0&&e.jsx("div",{className:"flex items-center gap-1",children:y.assignments.map(h=>e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("span",{className:"px-2 py-0.5 bg-teal-100 text-teal-700 text-xs rounded",children:[h.worker.first_name," ",h.worker.last_name[0],".",e.jsxs("span",{className:"ml-1 text-teal-600 font-medium",children:["$",Number(h.hourly_rate||y.pay_rate||0).toFixed(0),"/hr"]})]}),e.jsx("button",{onClick:P=>{P.stopPropagation(),L(h.id,`${h.worker.first_name} ${h.worker.last_name}`)},className:"w-5 h-5 flex items-center justify-center text-red-600 hover:text-red-700 hover:bg-red-50 rounded",title:"Unassign worker",children:e.jsx(Q,{size:12})})]},h.id))})]}),y.staffing_progress.percentage===100?e.jsxs("span",{className:"flex items-center gap-1.5 text-sm font-medium text-green-600",children:[e.jsx(ae,{size:16}),"Assigned"]}):e.jsx("button",{onClick:h=>{h.stopPropagation(),r(y.id)},className:"px-3 py-1.5 bg-teal-600 text-white text-sm font-medium rounded-lg hover:bg-teal-700 transition-colors",children:"Assign Worker"})]},y.id))})]},x.role_name))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-gray-500 mb-4",children:a.status==="draft"?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"font-medium",children:"This event is still in draft status"}),e.jsx("p",{className:"text-sm",children:"Publish the event to generate shifts and assign workers"})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"font-medium",children:"No shifts available"}),e.jsx("p",{className:"text-sm",children:"This event may not have any shifts generated yet"})]})}),e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[a.status==="draft"&&e.jsx("button",{onClick:()=>c(a.id),className:"px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-colors",children:"Publish Event"}),i&&e.jsx("button",{onClick:()=>i(a.id),className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"Delete Event"})]})]})})]},a.id)})})}function Te({events:F,expandedEvents:N,onToggleEvent:E,searchQuery:r}){const L=c=>U(V(c),"MMM d, yyyy"),m=c=>U(V(c),"h:mm a");return F.length===0?e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ“‹"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:r?"No past events found":"No past events yet"}),e.jsx("p",{className:"text-gray-600",children:r?"Try adjusting your search query":"Completed events will appear here"})]}):e.jsx("div",{className:"space-y-4",children:F.map(c=>{var u;const i=N.has(c.id);let $=0;return(u=c.shifts_by_role)==null||u.forEach(k=>{k.shifts.forEach(f=>{f.assignments.forEach(a=>{const T=a.hours_worked?parseFloat(a.hours_worked.toString()):0;$+=T})})}),$=Number($)||0,e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[e.jsxs("div",{onClick:()=>E(c.id),className:"w-full px-6 py-4 flex items-center justify-between hover:bg-gray-50 transition-colors cursor-pointer",children:[e.jsxs("div",{className:"flex-1 text-left",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:c.title}),e.jsx("span",{className:"px-2.5 py-1 bg-gray-100 text-gray-700 text-xs font-medium rounded-full",children:"Completed"})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[c.schedule&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(G,{size:14,className:"text-gray-400"}),L(c.schedule.start_time_utc)]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(B,{size:14,className:"text-gray-400"}),m(c.schedule.start_time_utc)," - ",m(c.schedule.end_time_utc)]})]}),c.venue&&e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(H,{size:14,className:"text-gray-400"}),c.venue.name]})]})]}),e.jsx("div",{className:"ml-4 flex items-center",children:e.jsx("div",{className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:i?e.jsx(re,{size:24,className:"text-gray-600 hover:text-gray-800"}):e.jsx(oe,{size:24,className:"text-gray-600 hover:text-gray-800"})})})]}),i&&c.shifts_by_role&&e.jsxs("div",{className:"border-t border-gray-200 bg-gray-50 px-6 py-4",children:[e.jsx("div",{className:"mb-4 p-4 bg-white rounded-lg border border-gray-200",children:e.jsxs("div",{className:"grid grid-cols-4 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Workers"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:c.assigned_workers_count})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Hours"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:$.toFixed(2)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Event Cost"}),e.jsxs("p",{className:"text-2xl font-semibold text-green-600",children:["$",(()=>{let k=0;return c.shifts_by_role.forEach(f=>{f.shifts.forEach(a=>{const T=(new Date(a.end_time_utc).getTime()-new Date(a.start_time_utc).getTime())/36e5;a.assignments.forEach(x=>{const y=Number(x.hourly_rate||a.pay_rate||0);k+=y*T})})}),k.toFixed(0)})()]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Staffing"}),e.jsxs("p",{className:"text-2xl font-semibold text-gray-900",children:[c.staffing_percentage,"%"]})]})]})}),e.jsx("div",{className:"space-y-3",children:c.shifts_by_role.map(k=>e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:k.role_name}),e.jsx("div",{className:"space-y-2",children:k.shifts.flatMap(f=>f.assignments.map(a=>e.jsxs("div",{className:"flex items-center justify-between py-2 px-3 bg-gray-50 rounded",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"w-8 h-8 rounded-full bg-teal-100 text-teal-700 flex items-center justify-center text-sm font-medium",children:[a.worker.first_name[0],a.worker.last_name[0]]}),e.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[a.worker.first_name," ",a.worker.last_name]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[a.hours_worked&&e.jsxs("span",{className:"font-medium",children:[parseFloat(a.hours_worked.toString()).toFixed(2)," hrs"]}),e.jsxs("span",{className:"font-medium text-green-600",children:["$",Number(a.hourly_rate||f.pay_rate||0).toFixed(0),"/hr"]}),a.hours_worked&&e.jsxs("span",{className:"font-semibold text-blue-600",children:["$",(parseFloat(a.hours_worked.toString())*Number(a.hourly_rate||f.pay_rate||0)).toFixed(0)]}),e.jsxs("span",{className:"text-xs text-gray-500",children:[m(f.start_time_utc)," - ",m(f.end_time_utc)]})]})]},a.id)))})]},k.role_name))})]})]},c.id)})})}export{Je as EventsPage};
