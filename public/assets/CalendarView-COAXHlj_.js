import{J as E,f as h,K as w,N as k,z as $,A,O as P,Q as W,V as F,Y as O,j as e,X as L,v as f,U as K,G as U,P as Y,F as z,y as R,d as V}from"./index-nZ9UCDkZ.js";import{L as M,b}from"./vendor-B6rXSep8.js";import{u as B}from"./useShifts-CRkV52KA.js";import{S as G}from"./ShiftStatusBadge-eFzrIEhS.js";import{M as I}from"./map-pin-BEQrcp1y.js";import{U as J}from"./user-plus-BOKLkjCa.js";function Q(a,c,i){const[r,m]=E(i?.in,a,c);return r.getFullYear()===m.getFullYear()&&r.getMonth()===m.getMonth()}const X=a=>{const c=w(a),i=k(a),r=$(c,{weekStartsOn:0}),m=A(i,{weekStartsOn:0}),t=P({start:r,end:m}),s=new Date;return t.map(n=>({date:n,isCurrentMonth:Q(n,a),isToday:W(n,s)}))},q=a=>h(a,"MMMM yyyy"),H=a=>F(a),Z=a=>O(a,1),v=a=>h(a,"yyyy-MM-dd"),ee=()=>["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],se=({date:a,isCurrentMonth:c,isToday:i,shifts:r,onClick:m})=>{const t=h(a,"d"),s=r.filter(x=>x.status==="published"),n=r.filter(x=>x.status==="draft"),o=s.some(x=>(x.assignments?.length||0)<x.capacity),g=s.some(x=>(x.assignments?.length||0)>=x.capacity),p=r.reduce((x,u)=>x+(u.assignments?.length||0),0),y=r.length>0?`${r.length} shift${r.length!==1?"s":""} - Click to view details`:"";return e.jsxs("button",{onClick:()=>m(a),title:y,className:`
        min-h-[80px] sm:min-h-[120px] p-1 sm:p-2 border border-gray-200 
        hover:bg-gray-50 transition-colors flex flex-col items-start relative
        ${c?"bg-white":"bg-gray-50 text-gray-400"}
        ${i?"ring-2 ring-blue-500 ring-inset bg-blue-50":""}
        ${r.length>0?"hover:border-blue-300":""}
      `,children:[e.jsx("div",{className:`
        text-xs sm:text-sm font-semibold mb-1 sm:mb-2 flex items-center justify-center
        ${i?"bg-blue-600 text-white rounded-full h-5 w-5 sm:h-6 sm:w-6":""}
      `,children:t}),r.length>0&&e.jsxs("div",{className:"w-full space-y-0.5 sm:space-y-1",children:[s.length>0&&e.jsxs("div",{className:`text-xs px-1 sm:px-2 py-0.5 sm:py-1 rounded ${o?"bg-yellow-100 text-yellow-800 border border-yellow-200":g?"bg-green-100 text-green-800 border border-green-200":"bg-blue-100 text-blue-800 border border-blue-200"}`,children:[s.length," ",o?"needs staff":g?"filled":"published"]}),n.length>0&&e.jsxs("div",{className:"text-xs px-1 sm:px-2 py-0.5 sm:py-1 rounded bg-gray-100 text-gray-800 border border-gray-200",children:[n.length," draft"]}),p>0&&e.jsxs("div",{className:"text-xs text-gray-600 mt-0.5 sm:mt-1",children:[p," worker",p!==1?"s":""]}),r.length>2&&e.jsxs("div",{className:"text-xs text-gray-500 mt-0.5 sm:mt-1",children:["+",r.length-2," more"]})]}),r.length>0&&e.jsx("div",{className:"absolute top-1 right-1 w-2 h-2 bg-blue-500 rounded-full opacity-0 group-hover:opacity-100 transition-opacity"})]})},te=({days:a,shifts:c,onDayClick:i})=>{const r=ee(),m=c.reduce((s,n)=>{const o=h(new Date(n.start_time_utc),"yyyy-MM-dd");return s[o]||(s[o]=[]),s[o].push(n),s},{}),t=s=>{const n=h(s,"yyyy-MM-dd");return m[n]||[]};return e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[e.jsx("div",{className:"grid grid-cols-7 border-b border-gray-200",children:r.map(s=>e.jsx("div",{className:"py-3 text-center text-sm font-semibold text-gray-700 bg-gray-50",children:s},s))}),e.jsx("div",{className:"grid grid-cols-7",children:a.map((s,n)=>e.jsx(se,{date:s.date,isCurrentMonth:s.isCurrentMonth,isToday:s.isToday,shifts:t(s.date),onClick:i},n))})]})},ae=({date:a,shifts:c,onClose:i})=>{const r=t=>{try{return h(new Date(t),"h:mm a")}catch{return t}},m=[...c].sort((t,s)=>new Date(t.start_time_utc).getTime()-new Date(s.start_time_utc).getTime());return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-3xl w-full max-h-[90vh] flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:h(a,"EEEE, MMMM d, yyyy")}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[c.length," ",c.length===1?"shift":"shifts"," scheduled"]})]}),e.jsx("button",{onClick:i,className:"text-gray-400 hover:text-gray-600",children:e.jsx(L,{className:"h-6 w-6"})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:c.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(f,{className:"h-12 w-12 text-gray-400 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:"No shifts scheduled for this day"})]}):e.jsx("div",{className:"space-y-4",children:m.map(t=>{const s=t.assignments?.length||0,n=s<t.capacity;return e.jsxs(M,{to:`/shifts/${t.id}`,className:"block bg-white border rounded-lg p-5 hover:border-blue-500 hover:shadow-md transition-all",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:t.client_name}),e.jsx("p",{className:"text-sm text-gray-600",children:t.role_needed})]}),e.jsx(G,{status:t.status})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(f,{className:"h-4 w-4"}),e.jsxs("span",{children:[r(t.start_time_utc)," - ",r(t.end_time_utc)]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(K,{className:"h-4 w-4"}),e.jsxs("span",{className:n?"text-yellow-600 font-medium":"text-green-600 font-medium",children:[s,"/",t.capacity," assigned"]})]}),t.location&&e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(I,{className:"h-4 w-4"}),e.jsx("span",{className:"truncate",children:t.location})]}),t.pay_rate&&e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(U,{className:"h-4 w-4"}),e.jsxs("span",{children:["$",t.pay_rate,"/hr"]})]})]}),s>0&&e.jsxs("div",{className:"mt-3 pt-3 border-t",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-2",children:"Assigned Workers:"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[t.assignments?.slice(0,3).map(o=>{const g=o.worker?`${o.worker.first_name} ${o.worker.last_name}`:`Worker ${o.worker_id}`;return e.jsx("span",{className:"px-2 py-1 text-xs bg-blue-50 text-blue-700 rounded",children:g},o.id)}),s>3&&e.jsxs("span",{className:"px-2 py-1 text-xs text-gray-500",children:["+",s-3," more"]})]})]}),n&&t.status==="published"&&e.jsxs("div",{className:"mt-3 flex items-center gap-2 text-xs text-yellow-700 bg-yellow-50 px-3 py-2 rounded",children:[e.jsx(J,{className:"h-4 w-4"}),e.jsxs("span",{children:["Needs ",t.capacity-s," more ",t.capacity-s===1?"worker":"workers"]})]})]},t.id)})})}),e.jsx("div",{className:"flex items-center justify-end p-6 border-t bg-gray-50",children:e.jsx("button",{onClick:i,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Close"})})]})})},xe=()=>{const[a,c]=b.useState(new Date),[i,r]=b.useState(null),m=w(a),t=k(a),{shifts:s,loading:n,error:o}=B({start_date:v(m),end_date:v(t)}),g=X(a),y=(l=>{if(!l)return[];const d=h(l,"yyyy-MM-dd");return s.filter(T=>h(new Date(T.start_time_utc),"yyyy-MM-dd")===d)})(i);b.useEffect(()=>{const l=d=>{d.key==="ArrowLeft"?x():d.key==="ArrowRight"?u():d.key==="t"||d.key==="T"?j():d.key==="Escape"&&i&&r(null)};return window.addEventListener("keydown",l),()=>window.removeEventListener("keydown",l)},[i,a]);const x=()=>{c(H(a))},u=()=>{c(Z(a))},j=()=>{c(new Date)},D=l=>{r(l)},N=s.length,S=s.filter(l=>l.status==="published").length,C=s.filter(l=>(l.assignments?.length||0)<l.capacity&&l.status==="published").length,_=s.reduce((l,d)=>l+(d.assignments?.length||0),0);return n?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-48 animate-pulse mb-2"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-64 animate-pulse"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"flex gap-3",children:Array.from({length:4}).map((l,d)=>e.jsxs("div",{className:"bg-gray-200 rounded-lg px-4 py-3 animate-pulse min-w-[80px]",children:[e.jsx("div",{className:"h-6 bg-gray-300 rounded mb-1"}),e.jsx("div",{className:"h-3 bg-gray-300 rounded w-12"})]},d))}),e.jsx("div",{className:"h-10 bg-gray-200 rounded-lg w-32 animate-pulse"})]})]}),e.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"h-10 w-10 bg-gray-200 rounded-lg animate-pulse"}),e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded w-32 animate-pulse"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-48 animate-pulse"})]}),e.jsx("div",{className:"h-10 w-10 bg-gray-200 rounded-lg animate-pulse"})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-16 animate-pulse mb-3"}),e.jsx("div",{className:"flex flex-wrap gap-4",children:Array.from({length:5}).map((l,d)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-gray-200 rounded animate-pulse"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-20 animate-pulse"})]},d))})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[e.jsx("div",{className:"grid grid-cols-7 border-b border-gray-200",children:Array.from({length:7}).map((l,d)=>e.jsx("div",{className:"py-3 text-center",children:e.jsx("div",{className:"h-4 bg-gray-200 rounded w-8 mx-auto animate-pulse"})},d))}),e.jsx("div",{className:"grid grid-cols-7",children:Array.from({length:35}).map((l,d)=>e.jsxs("div",{className:"min-h-[120px] p-2 border border-gray-200 bg-white",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-6 animate-pulse mb-2"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded animate-pulse"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 animate-pulse"})]})]},d))})]})]}):o?e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsx("p",{className:"text-red-800",children:o})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Calendar"}),e.jsx("p",{className:"text-gray-500 mt-1",children:"Visual overview of all shifts and assignments"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-4",children:[e.jsxs("div",{className:"flex gap-2 sm:gap-3 overflow-x-auto pb-2 sm:pb-0",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg px-3 sm:px-4 py-2 sm:py-3 text-center min-w-[70px] sm:min-w-[80px]",children:[e.jsx("div",{className:"text-lg sm:text-xl font-bold text-blue-600",children:N}),e.jsx("div",{className:"text-xs text-blue-700 mt-1",children:"Total"})]}),e.jsxs("div",{className:"bg-yellow-50 rounded-lg px-3 sm:px-4 py-2 sm:py-3 text-center min-w-[70px] sm:min-w-[80px]",children:[e.jsx("div",{className:"text-lg sm:text-xl font-bold text-yellow-600",children:C}),e.jsx("div",{className:"text-xs text-yellow-700 mt-1",children:"Need Staff"})]}),e.jsxs("div",{className:"bg-green-50 rounded-lg px-3 sm:px-4 py-2 sm:py-3 text-center min-w-[70px] sm:min-w-[80px]",children:[e.jsx("div",{className:"text-lg sm:text-xl font-bold text-green-600",children:S}),e.jsx("div",{className:"text-xs text-green-700 mt-1",children:"Published"})]}),e.jsxs("div",{className:"bg-purple-50 rounded-lg px-3 sm:px-4 py-2 sm:py-3 text-center min-w-[70px] sm:min-w-[80px]",children:[e.jsx("div",{className:"text-lg sm:text-xl font-bold text-purple-600",children:_}),e.jsx("div",{className:"text-xs text-purple-700 mt-1",children:"Workers"})]})]}),e.jsxs(M,{to:"/shifts/new",className:"btn-primary flex items-center gap-2 w-full sm:w-auto justify-center",children:[e.jsx(Y,{className:"h-4 w-4"}),e.jsx("span",{children:"Create Shift"})]})]})]}),e.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("button",{onClick:x,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors","aria-label":"Previous month",children:e.jsx(z,{className:"h-6 w-6"})}),e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:q(a)}),e.jsx("button",{onClick:j,className:"px-3 py-1 text-sm btn-primary",children:"Today"})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[e.jsx("kbd",{className:"px-2 py-1 bg-gray-100 rounded",children:"←"})," /",e.jsx("kbd",{className:"px-2 py-1 bg-gray-100 rounded",children:"→"})," Navigate months •",e.jsx("kbd",{className:"px-2 py-1 bg-gray-100 rounded",children:"T"})," Today"]})]}),e.jsx("button",{onClick:u,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors","aria-label":"Next month",children:e.jsx(R,{className:"h-6 w-6"})})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Legend"}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-yellow-100 border border-yellow-200"}),e.jsx("span",{className:"text-gray-700",children:"Needs Workers"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-blue-100 border border-blue-200"}),e.jsx("span",{className:"text-gray-700",children:"Published"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-green-100 border border-green-200"}),e.jsx("span",{className:"text-gray-700",children:"Fully Staffed"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-gray-100 border border-gray-200"}),e.jsx("span",{className:"text-gray-700",children:"Draft"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded border-2 border-blue-500"}),e.jsx("span",{className:"text-gray-700",children:"Today"})]})]})]}),e.jsx(te,{days:g,shifts:s,onDayClick:D}),N===0&&e.jsxs("div",{className:"bg-white rounded-lg shadow p-12 text-center",children:[e.jsx(V,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No shifts this month"}),e.jsx("p",{className:"text-gray-500",children:"Create shifts to see them on the calendar"})]}),i&&e.jsx(ae,{date:i,shifts:y,onClose:()=>r(null)})]})};export{xe as default};
