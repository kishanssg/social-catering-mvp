import{a as C,j as e,C as S}from"./index-C1NmElHX.js";import{i as E,b as z,r as c}from"./vendor-79DyBOV9.js";import{L as A}from"./LoadingSpinner-C7p8wGMN.js";import{A as R,P as f}from"./phone-BBHpfldU.js";import{C as U}from"./calendar-DB7Ugs6j.js";import{M as F}from"./map-pin-Bs8og3gE.js";import{U as P}from"./user-CS3F2Kft.js";import{U as $}from"./users-C7Xcvbd8.js";import{F as D}from"./file-text-DbKn_9om.js";import{C as L}from"./chevron-down-BsSz4bSX.js";function J(){const{id:m}=E(),i=z(),[s,o]=c.useState(null),[j,x]=c.useState(!0),[g,v]=c.useState(new Set);c.useEffect(()=>{b()},[m]);async function b(){x(!0);try{const t=await C.get(`/events/${m}`);t.data.status==="success"&&o(t.data.data)}catch(t){console.error("Failed to load event:",t),o(null)}finally{x(!1)}}const y=t=>{const r=new Set(g);r.has(t)?r.delete(t):r.add(t),v(r)};if(j)return e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx(A,{message:"Loading event details..."})});if(!s)return e.jsx("div",{className:"p-8",children:e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"❌"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Event Not Found"}),e.jsx("button",{onClick:()=>i("/events"),className:"mt-4 px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition",children:"Back to Events"})]})});const N=t=>new Date(t).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),l=t=>new Date(t).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}),_=s.shifts.reduce((t,r)=>(t[r.role_needed]||(t[r.role_needed]=[]),t[r.role_needed].push(r),t),{});return e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-5xl mx-auto p-8",children:[e.jsxs("button",{onClick:()=>i("/events"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-6 transition-colors",children:[e.jsx(R,{size:20}),"Back to Events"]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 mb-6",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4 mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-2xl font-semibold text-gray-900 mb-2",children:s.title}),e.jsxs("div",{className:"inline-flex items-center gap-1.5 px-3 py-1.5 bg-green-100 text-green-700 text-sm font-medium rounded-full",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-green-500"}),"Published"]})]}),e.jsx("div",{className:"flex items-center gap-2",children:s.unfilled_roles_count>0&&e.jsx("button",{onClick:()=>i(`/events?tab=active&event_id=${s.id}`),className:"px-4 py-2 bg-teal-600 text-white font-medium rounded-lg hover:bg-teal-700 transition-colors",children:"Assign Workers"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mt-6",children:[s.schedule&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-600 mb-2",children:[e.jsx(U,{size:18}),e.jsx("span",{className:"text-sm font-medium",children:"Date & Time"})]}),e.jsx("p",{className:"text-gray-900 font-medium",children:N(s.schedule.start_time_utc)}),e.jsxs("p",{className:"text-gray-600",children:[l(s.schedule.start_time_utc)," - ",l(s.schedule.end_time_utc)]}),s.schedule.break_minutes>0&&e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[s.schedule.break_minutes," min break"]})]}),s.venue&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-600 mb-2",children:[e.jsx(F,{size:18}),e.jsx("span",{className:"text-sm font-medium",children:"Venue"})]}),e.jsx("p",{className:"text-gray-900 font-medium",children:s.venue.name}),e.jsx("p",{className:"text-gray-600 text-sm",children:s.venue.formatted_address}),s.venue.phone&&e.jsxs("p",{className:"text-gray-600 text-sm mt-1",children:[e.jsx(f,{size:14,className:"inline mr-1"}),s.venue.phone]})]}),s.supervisor_name&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-600 mb-2",children:[e.jsx(P,{size:18}),e.jsx("span",{className:"text-sm font-medium",children:"Event Supervisor"})]}),e.jsx("p",{className:"text-gray-900 font-medium",children:s.supervisor_name}),s.supervisor_phone&&e.jsxs("p",{className:"text-gray-600 text-sm",children:[e.jsx(f,{size:14,className:"inline mr-1"}),s.supervisor_phone]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-600 mb-2",children:[e.jsx($,{size:18}),e.jsx("span",{className:"text-sm font-medium",children:"Staffing Status"})]}),e.jsx("p",{className:"text-gray-900 font-medium mb-2",children:s.staffing_summary}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:`h-full transition-all ${s.staffing_percentage===100?"bg-green-500":s.staffing_percentage>0?"bg-yellow-500":"bg-red-500"}`,style:{width:`${s.staffing_percentage}%`}})}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[s.staffing_percentage,"% complete"]})]})]}),s.check_in_instructions&&e.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-600 mb-2",children:[e.jsx(D,{size:18}),e.jsx("span",{className:"text-sm font-medium",children:"Check-in Instructions"})]}),e.jsx("p",{className:"text-gray-700 text-sm leading-relaxed",children:s.check_in_instructions})]}),s.venue&&(s.venue.arrival_instructions||s.venue.parking_info)&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[s.venue.arrival_instructions&&e.jsxs("div",{className:"mb-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"Arrival Instructions:"}),e.jsx("p",{className:"text-sm text-gray-600",children:s.venue.arrival_instructions})]}),s.venue.parking_info&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"Parking:"}),e.jsx("p",{className:"text-sm text-gray-600",children:s.venue.parking_info})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Roles & Shifts"}),e.jsx("div",{className:"space-y-3",children:Object.entries(_).map(([t,r])=>{const p=g.has(t),u=r.length,h=r.filter(n=>n.staffing_progress.percentage===100).length,d=u-h,a=s.skill_requirements.find(n=>n.skill_name===t);return e.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[e.jsx("button",{onClick:()=>y(t),className:"w-full px-4 py-3 flex items-center justify-between hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("h3",{className:"font-medium text-gray-900",children:t}),e.jsxs("p",{className:"text-sm text-gray-600",children:[h," of ",u," shifts filled",(a==null?void 0:a.pay_rate)&&e.jsxs("span",{className:"ml-2 text-gray-500",children:["• $",a.pay_rate,"/hr"]})]})]}),d===0?e.jsx("span",{className:"px-2.5 py-1 bg-green-100 text-green-700 text-xs font-medium rounded-full",children:"All Filled"}):e.jsxs("span",{className:"px-2.5 py-1 bg-red-100 text-red-700 text-xs font-medium rounded-full",children:[d," Need Workers"]}),p?e.jsx(S,{size:20,className:"text-gray-400"}):e.jsx(L,{size:20,className:"text-gray-400"})]})}),p&&e.jsxs("div",{className:"border-t border-gray-200 bg-gray-50 px-4 py-3",children:[a&&e.jsxs("div",{className:"mb-4 pb-4 border-b border-gray-200",children:[a.description&&e.jsx("p",{className:"text-sm text-gray-700 mb-2",children:a.description}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.uniform_name&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-white border border-gray-200 text-xs text-gray-600 rounded",children:["Uniform: ",a.uniform_name]}),a.certification_name&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-white border border-gray-200 text-xs text-gray-600 rounded",children:["Cert: ",a.certification_name]})]})]}),e.jsx("div",{className:"space-y-2",children:r.map((n,w)=>e.jsxs("div",{className:"flex items-center justify-between py-2 px-3 bg-white rounded border border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-600",children:["Shift ",w+1]}),e.jsxs("span",{className:"text-sm text-gray-600",children:[l(n.start_time_utc)," - ",l(n.end_time_utc)]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[n.staffing_progress.percentage===100?e.jsx("span",{className:"text-sm font-medium text-green-600",children:"✓ Assigned"}):e.jsx("span",{className:"text-sm font-medium text-red-600",children:"Needs Worker"}),n.staffing_progress.percentage<100&&e.jsx("button",{onClick:k=>{k.stopPropagation(),i(`/events?tab=active&shift_id=${n.id}`)},className:"px-3 py-1 bg-teal-600 text-white text-xs font-medium rounded hover:bg-teal-700 transition-colors",children:"Assign"})]})]},n.id))}),d>0&&e.jsxs("button",{onClick:()=>i(`/events?tab=active&event_id=${s.id}&role=${encodeURIComponent(t)}`),className:"mt-3 w-full px-4 py-2 bg-teal-600 text-white text-sm font-medium rounded-lg hover:bg-teal-700 transition-colors",children:["Assign All ",t," Shifts (",d,")"]})]})]},t)})})]})]})})}export{J as EventDetailPage};
