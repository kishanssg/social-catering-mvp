{"version":3,"file":"ActivityLogsPage.js","sources":["../../../social-catering-ui/social-catering-ui/src/pages/ActivityLogsPage.tsx"],"sourcesContent":["import { useState, useEffect } from 'react';\nimport { apiService } from '../services/api';\nimport LoadingSpinner from '../components/LoadingSpinner';\nimport ErrorMessage from '../components/ErrorMessage';\n\ninterface ActivityLog {\n  id: number;\n  action: string;\n  entity_type: string;\n  entity_id: number;\n  actor_user_id: number;\n  actor_user: {\n    id: number;\n    email: string;\n  };\n  created_at: string;\n}\n\ninterface Pagination {\n  current_page: number;\n  per_page: number;\n  total_count: number;\n  total_pages: number;\n  has_next_page: boolean;\n  has_prev_page: boolean;\n}\n\n\nconst ActivityLogsPage = () => {\n  const [logs, setLogs] = useState<ActivityLog[]>([]);\n  const [pagination, setPagination] = useState<Pagination | null>(null);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [filters, setFilters] = useState({\n    entity_type: '',\n    action: '',\n    page: 1\n  });\n\n  const fetchLogs = async () => {\n    try {\n      setIsLoading(true);\n      setError(null);\n\n      const params = new URLSearchParams();\n      if (filters.entity_type) params.append('entity_type', filters.entity_type);\n      if (filters.action) params.append('log_action', filters.action);\n      params.append('page', filters.page.toString());\n\n      const response = await apiService.getActivityLogs(params);\n      \n      if (response.status === 'success') {\n        setLogs(response.data.activity_logs);\n        setPagination(response.data.pagination);\n      }\n    } catch (err: any) {\n      const errorMessage = err.response?.data?.error || 'Failed to load activity logs';\n      setError(errorMessage);\n      console.error('Activity logs fetch error:', err);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    fetchLogs();\n  }, [filters]);\n\n  const handleFilterChange = (key: string, value: string) => {\n    setFilters(prev => ({\n      ...prev,\n      [key]: value,\n      page: 1 // Reset to first page when filtering\n    }));\n  };\n\n  const handlePageChange = (page: number) => {\n    setFilters(prev => ({ ...prev, page }));\n  };\n\n  const formatDate = (dateString: string) => {\n    return new Date(dateString).toLocaleString('en-US', {\n      year: 'numeric',\n      month: 'short',\n      day: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit',\n      second: '2-digit'\n    });\n  };\n\n  const getActionColor = (action: string) => {\n    switch (action) {\n      case 'created':\n        return 'bg-green-100 text-green-800';\n      case 'updated':\n        return 'bg-blue-100 text-blue-800';\n      case 'destroyed':\n        return 'bg-red-100 text-red-800';\n      default:\n        return 'bg-gray-100 text-gray-800';\n    }\n  };\n\n  const getEntityIcon = (entityType: string) => {\n    switch (entityType) {\n      case 'Worker':\n        return 'üë§';\n      case 'Shift':\n        return 'üìÖ';\n      case 'Assignment':\n        return 'üîó';\n      case 'User':\n        return 'üë®‚Äçüíº';\n      default:\n        return 'üìÑ';\n    }\n  };\n\n  if (isLoading) {\n    return <LoadingSpinner message=\"Loading activity logs...\" />;\n  }\n\n  if (error) {\n    return <ErrorMessage message={error} onRetry={fetchLogs} />;\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h1 className=\"text-2xl font-bold text-gray-900\">Activity Logs</h1>\n          <p className=\"text-gray-600\">\n            Track all changes made to the system\n            {pagination && ` (${pagination.total_count} total entries)`}\n          </p>\n        </div>\n      </div>\n\n      {/* Filters */}\n      <div className=\"bg-white p-4 rounded-lg border border-gray-200\">\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Entity Type\n            </label>\n            <select\n              value={filters.entity_type}\n              onChange={(e) => handleFilterChange('entity_type', e.target.value)}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            >\n              <option value=\"\">All Types</option>\n              <option value=\"Worker\">Workers</option>\n              <option value=\"Shift\">Shifts</option>\n              <option value=\"Assignment\">Assignments</option>\n              <option value=\"User\">Users</option>\n            </select>\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Action\n            </label>\n            <select\n              value={filters.action}\n              onChange={(e) => handleFilterChange('action', e.target.value)}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            >\n              <option value=\"\">All Actions</option>\n              <option value=\"created\">Created</option>\n              <option value=\"updated\">Updated</option>\n              <option value=\"destroyed\">Deleted</option>\n            </select>\n          </div>\n\n          <div className=\"flex items-end\">\n            <button\n              onClick={() => setFilters({ entity_type: '', action: '', page: 1 })}\n              className=\"px-4 py-2 text-sm text-gray-600 hover:text-gray-800 border border-gray-300 rounded-md hover:bg-gray-50\"\n            >\n              Clear Filters\n            </button>\n          </div>\n        </div>\n      </div>\n\n      {/* Activity Logs List */}\n      <div className=\"bg-white rounded-lg border border-gray-200\">\n        {logs.length === 0 ? (\n          <div className=\"text-center py-12\">\n            <div className=\"text-gray-400 text-6xl mb-4\">üìù</div>\n            <h3 className=\"text-lg font-medium text-gray-900 mb-2\">No activity logs found</h3>\n            <p className=\"text-gray-500\">\n              {filters.entity_type || filters.action \n                ? 'Try adjusting your filters to see more results.'\n                : 'Activity logs will appear here as changes are made to the system.'\n              }\n            </p>\n          </div>\n        ) : (\n          <div className=\"divide-y divide-gray-200\">\n            {logs.map((log) => (\n              <div key={log.id} className=\"p-4 hover:bg-gray-50\">\n                <div className=\"flex items-start space-x-3\">\n                  <div className=\"flex-shrink-0\">\n                    <div className=\"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm\">\n                      {getEntityIcon(log.entity_type)}\n                    </div>\n                  </div>\n                  \n                  <div className=\"flex-1 min-w-0\">\n                    <div className=\"flex items-center space-x-2 mb-1\">\n                      <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${getActionColor(log.action)}`}>\n                        {log.action}\n                      </span>\n                      <span className=\"text-sm font-medium text-gray-900\">\n                        {log.entity_type}\n                      </span>\n                      <span className=\"text-sm text-gray-500\">\n                        #{log.entity_id}\n                      </span>\n                    </div>\n                    \n                    <div className=\"text-sm text-gray-600\">\n                      <span className=\"font-medium\">{log.actor_user.email}</span>\n                      {' '}performed this action\n                    </div>\n                    \n                    <div className=\"text-xs text-gray-500 mt-1\">\n                      {formatDate(log.created_at)}\n                    </div>\n                  </div>\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n\n      {/* Pagination */}\n      {pagination && pagination.total_pages > 1 && (\n        <div className=\"flex items-center justify-between bg-white px-4 py-3 border border-gray-200 rounded-lg\">\n          <div className=\"flex-1 flex justify-between sm:hidden\">\n            <button\n              onClick={() => handlePageChange(pagination.current_page - 1)}\n              disabled={!pagination.has_prev_page}\n              className=\"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed\"\n            >\n              Previous\n            </button>\n            <button\n              onClick={() => handlePageChange(pagination.current_page + 1)}\n              disabled={!pagination.has_next_page}\n              className=\"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed\"\n            >\n              Next\n            </button>\n          </div>\n          \n          <div className=\"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between\">\n            <div>\n              <p className=\"text-sm text-gray-700\">\n                Showing{' '}\n                <span className=\"font-medium\">\n                  {((pagination.current_page - 1) * pagination.per_page) + 1}\n                </span>{' '}\n                to{' '}\n                <span className=\"font-medium\">\n                  {Math.min(pagination.current_page * pagination.per_page, pagination.total_count)}\n                </span>{' '}\n                of{' '}\n                <span className=\"font-medium\">{pagination.total_count}</span>{' '}\n                results\n              </p>\n            </div>\n            \n            <div>\n              <nav className=\"relative z-0 inline-flex rounded-md shadow-sm -space-x-px\">\n                <button\n                  onClick={() => handlePageChange(pagination.current_page - 1)}\n                  disabled={!pagination.has_prev_page}\n                  className=\"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed\"\n                >\n                  Previous\n                </button>\n                \n                {Array.from({ length: Math.min(5, pagination.total_pages) }, (_, i) => {\n                  const page = i + 1;\n                  return (\n                    <button\n                      key={page}\n                      onClick={() => handlePageChange(page)}\n                      className={`relative inline-flex items-center px-4 py-2 border text-sm font-medium ${\n                        page === pagination.current_page\n                          ? 'z-10 bg-blue-50 border-blue-500 text-blue-600'\n                          : 'bg-white border-gray-300 text-gray-500 hover:bg-gray-50'\n                      }`}\n                    >\n                      {page}\n                    </button>\n                  );\n                })}\n                \n                <button\n                  onClick={() => handlePageChange(pagination.current_page + 1)}\n                  disabled={!pagination.has_next_page}\n                  className=\"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed\"\n                >\n                  Next\n                </button>\n              </nav>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default ActivityLogsPage;\n"],"names":["ActivityLogsPage","logs","setLogs","useState","pagination","setPagination","isLoading","setIsLoading","error","setError","filters","setFilters","fetchLogs","params","response","apiService","err","errorMessage","useEffect","handleFilterChange","key","value","prev","handlePageChange","page","formatDate","dateString","getActionColor","action","getEntityIcon","entityType","jsx","LoadingSpinner","ErrorMessage","jsxs","e","log","_","i"],"mappings":"+KA4BA,MAAMA,EAAmB,IAAM,CAC7B,KAAM,CAACC,EAAMC,CAAO,EAAIC,EAAAA,SAAwB,CAAA,CAAE,EAC5C,CAACC,EAAYC,CAAa,EAAIF,EAAAA,SAA4B,IAAI,EAC9D,CAACG,EAAWC,CAAY,EAAIJ,EAAAA,SAAS,EAAI,EACzC,CAACK,EAAOC,CAAQ,EAAIN,EAAAA,SAAwB,IAAI,EAChD,CAACO,EAASC,CAAU,EAAIR,WAAS,CACrC,YAAa,GACb,OAAQ,GACR,KAAM,CAAA,CACP,EAEKS,EAAY,SAAY,CAC5B,GAAI,CACFL,EAAa,EAAI,EACjBE,EAAS,IAAI,EAEb,MAAMI,EAAS,IAAI,gBACfH,EAAQ,aAAaG,EAAO,OAAO,cAAeH,EAAQ,WAAW,EACrEA,EAAQ,QAAQG,EAAO,OAAO,aAAcH,EAAQ,MAAM,EAC9DG,EAAO,OAAO,OAAQH,EAAQ,KAAK,UAAU,EAE7C,MAAMI,EAAW,MAAMC,EAAW,gBAAgBF,CAAM,EAEpDC,EAAS,SAAW,YACtBZ,EAAQY,EAAS,KAAK,aAAa,EACnCT,EAAcS,EAAS,KAAK,UAAU,EAE1C,OAASE,EAAU,CACjB,MAAMC,EAAeD,EAAI,UAAU,MAAM,OAAS,+BAClDP,EAASQ,CAAY,EACrB,QAAQ,MAAM,6BAA8BD,CAAG,CACjD,QAAA,CACET,EAAa,EAAK,CACpB,CACF,EAEAW,EAAAA,UAAU,IAAM,CACdN,EAAA,CACF,EAAG,CAACF,CAAO,CAAC,EAEZ,MAAMS,EAAqB,CAACC,EAAaC,IAAkB,CACzDV,EAAWW,IAAS,CAClB,GAAGA,EACH,CAACF,CAAG,EAAGC,EACP,KAAM,CAAA,EACN,CACJ,EAEME,EAAoBC,GAAiB,CACzCb,EAAWW,IAAS,CAAE,GAAGA,EAAM,KAAAE,GAAO,CACxC,EAEMC,EAAcC,GACX,IAAI,KAAKA,CAAU,EAAE,eAAe,QAAS,CAClD,KAAM,UACN,MAAO,QACP,IAAK,UACL,KAAM,UACN,OAAQ,UACR,OAAQ,SAAA,CACT,EAGGC,EAAkBC,GAAmB,CACzC,OAAQA,EAAA,CACN,IAAK,UACH,MAAO,8BACT,IAAK,UACH,MAAO,4BACT,IAAK,YACH,MAAO,0BACT,QACE,MAAO,2BAAA,CAEb,EAEMC,EAAiBC,GAAuB,CAC5C,OAAQA,EAAA,CACN,IAAK,SACH,MAAO,KACT,IAAK,QACH,MAAO,KACT,IAAK,aACH,MAAO,KACT,IAAK,OACH,MAAO,QACT,QACE,MAAO,IAAA,CAEb,EAEA,OAAIxB,EACKyB,EAAAA,IAACC,EAAA,CAAe,QAAQ,0BAAA,CAA2B,EAGxDxB,EACKuB,EAAAA,IAACE,EAAA,CAAa,QAASzB,EAAO,QAASI,EAAW,EAIzDsB,EAAAA,KAAC,MAAA,CAAI,UAAU,YAEb,SAAA,CAAAH,MAAC,MAAA,CAAI,UAAU,oCACb,SAAAG,EAAAA,KAAC,MAAA,CACC,SAAA,CAAAH,EAAAA,IAAC,KAAA,CAAG,UAAU,mCAAmC,SAAA,gBAAa,EAC9DG,EAAAA,KAAC,IAAA,CAAE,UAAU,gBAAgB,SAAA,CAAA,uCAE1B9B,GAAc,KAAKA,EAAW,WAAW,iBAAA,CAAA,CAC5C,CAAA,CAAA,CACF,CAAA,CACF,QAGC,MAAA,CAAI,UAAU,iDACb,SAAA8B,EAAAA,KAAC,MAAA,CAAI,UAAU,wCACb,SAAA,CAAAA,OAAC,MAAA,CACC,SAAA,CAAAH,EAAAA,IAAC,QAAA,CAAM,UAAU,+CAA+C,SAAA,cAEhE,EACAG,EAAAA,KAAC,SAAA,CACC,MAAOxB,EAAQ,YACf,SAAWyB,GAAMhB,EAAmB,cAAegB,EAAE,OAAO,KAAK,EACjE,UAAU,yGAEV,SAAA,CAAAJ,EAAAA,IAAC,SAAA,CAAO,MAAM,GAAG,SAAA,YAAS,EAC1BA,EAAAA,IAAC,SAAA,CAAO,MAAM,SAAS,SAAA,UAAO,EAC9BA,EAAAA,IAAC,SAAA,CAAO,MAAM,QAAQ,SAAA,SAAM,EAC5BA,EAAAA,IAAC,SAAA,CAAO,MAAM,aAAa,SAAA,cAAW,EACtCA,EAAAA,IAAC,SAAA,CAAO,MAAM,OAAO,SAAA,OAAA,CAAK,CAAA,CAAA,CAAA,CAC5B,EACF,SAEC,MAAA,CACC,SAAA,CAAAA,EAAAA,IAAC,QAAA,CAAM,UAAU,+CAA+C,SAAA,SAEhE,EACAG,EAAAA,KAAC,SAAA,CACC,MAAOxB,EAAQ,OACf,SAAWyB,GAAMhB,EAAmB,SAAUgB,EAAE,OAAO,KAAK,EAC5D,UAAU,yGAEV,SAAA,CAAAJ,EAAAA,IAAC,SAAA,CAAO,MAAM,GAAG,SAAA,cAAW,EAC5BA,EAAAA,IAAC,SAAA,CAAO,MAAM,UAAU,SAAA,UAAO,EAC/BA,EAAAA,IAAC,SAAA,CAAO,MAAM,UAAU,SAAA,UAAO,EAC/BA,EAAAA,IAAC,SAAA,CAAO,MAAM,YAAY,SAAA,SAAA,CAAO,CAAA,CAAA,CAAA,CACnC,EACF,EAEAA,EAAAA,IAAC,MAAA,CAAI,UAAU,iBACb,SAAAA,EAAAA,IAAC,SAAA,CACC,QAAS,IAAMpB,EAAW,CAAE,YAAa,GAAI,OAAQ,GAAI,KAAM,EAAG,EAClE,UAAU,yGACX,SAAA,eAAA,CAAA,CAED,CACF,CAAA,CAAA,CACF,CAAA,CACF,EAGAoB,EAAAA,IAAC,MAAA,CAAI,UAAU,6CACZ,SAAA9B,EAAK,SAAW,EACfiC,EAAAA,KAAC,MAAA,CAAI,UAAU,oBACb,SAAA,CAAAH,EAAAA,IAAC,MAAA,CAAI,UAAU,8BAA8B,SAAA,KAAE,EAC/CA,EAAAA,IAAC,KAAA,CAAG,UAAU,yCAAyC,SAAA,yBAAsB,EAC7EA,EAAAA,IAAC,KAAE,UAAU,gBACV,WAAQ,aAAerB,EAAQ,OAC5B,kDACA,mEAAA,CAEN,CAAA,EACF,EAEAqB,MAAC,MAAA,CAAI,UAAU,2BACZ,WAAK,IAAKK,GACTL,EAAAA,IAAC,OAAiB,UAAU,uBAC1B,SAAAG,OAAC,MAAA,CAAI,UAAU,6BACb,SAAA,CAAAH,EAAAA,IAAC,MAAA,CAAI,UAAU,gBACb,SAAAA,EAAAA,IAAC,MAAA,CAAI,UAAU,4EACZ,SAAAF,EAAcO,EAAI,WAAW,CAAA,CAChC,EACF,EAEAF,EAAAA,KAAC,MAAA,CAAI,UAAU,iBACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,mCACb,SAAA,CAAAH,EAAAA,IAAC,OAAA,CAAK,UAAW,2EAA2EJ,EAAeS,EAAI,MAAM,CAAC,GACnH,SAAAA,EAAI,MAAA,CACP,EACAL,EAAAA,IAAC,OAAA,CAAK,UAAU,oCACb,WAAI,YACP,EACAG,EAAAA,KAAC,OAAA,CAAK,UAAU,wBAAwB,SAAA,CAAA,IACpCE,EAAI,SAAA,CAAA,CACR,CAAA,EACF,EAEAF,EAAAA,KAAC,MAAA,CAAI,UAAU,wBACb,SAAA,CAAAH,MAAC,OAAA,CAAK,UAAU,cAAe,SAAAK,EAAI,WAAW,MAAM,EACnD,IAAI,uBAAA,EACP,QAEC,MAAA,CAAI,UAAU,6BACZ,SAAAX,EAAWW,EAAI,UAAU,CAAA,CAC5B,CAAA,CAAA,CACF,CAAA,CAAA,CACF,CAAA,EA9BQA,EAAI,EA+Bd,CACD,EACH,CAAA,CAEJ,EAGChC,GAAcA,EAAW,YAAc,GACtC8B,EAAAA,KAAC,MAAA,CAAI,UAAU,yFACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,wCACb,SAAA,CAAAH,EAAAA,IAAC,SAAA,CACC,QAAS,IAAMR,EAAiBnB,EAAW,aAAe,CAAC,EAC3D,SAAU,CAACA,EAAW,cACtB,UAAU,4LACX,SAAA,UAAA,CAAA,EAGD2B,EAAAA,IAAC,SAAA,CACC,QAAS,IAAMR,EAAiBnB,EAAW,aAAe,CAAC,EAC3D,SAAU,CAACA,EAAW,cACtB,UAAU,iMACX,SAAA,MAAA,CAAA,CAED,EACF,EAEA8B,EAAAA,KAAC,MAAA,CAAI,UAAU,8DACb,SAAA,CAAAH,MAAC,MAAA,CACC,SAAAG,EAAAA,KAAC,IAAA,CAAE,UAAU,wBAAwB,SAAA,CAAA,UAC3B,IACRH,EAAAA,IAAC,QAAK,UAAU,cACX,YAAW,aAAe,GAAK3B,EAAW,SAAY,CAAA,CAC3D,EAAQ,IAAI,KACT,IACH2B,EAAAA,IAAC,OAAA,CAAK,UAAU,cACb,SAAA,KAAK,IAAI3B,EAAW,aAAeA,EAAW,SAAUA,EAAW,WAAW,CAAA,CACjF,EAAQ,IAAI,KACT,IACH2B,EAAAA,IAAC,OAAA,CAAK,UAAU,cAAe,WAAW,YAAY,EAAQ,IAAI,SAAA,CAAA,CAEpE,CAAA,CACF,EAEAA,MAAC,MAAA,CACC,SAAAG,EAAAA,KAAC,MAAA,CAAI,UAAU,4DACb,SAAA,CAAAH,EAAAA,IAAC,SAAA,CACC,QAAS,IAAMR,EAAiBnB,EAAW,aAAe,CAAC,EAC3D,SAAU,CAACA,EAAW,cACtB,UAAU,8LACX,SAAA,UAAA,CAAA,EAIA,MAAM,KAAK,CAAE,OAAQ,KAAK,IAAI,EAAGA,EAAW,WAAW,CAAA,EAAK,CAACiC,EAAGC,IAAM,CACrE,MAAMd,EAAOc,EAAI,EACjB,OACEP,EAAAA,IAAC,SAAA,CAEC,QAAS,IAAMR,EAAiBC,CAAI,EACpC,UAAW,0EACTA,IAASpB,EAAW,aAChB,gDACA,yDACN,GAEC,SAAAoB,CAAA,EARIA,CAAA,CAWX,CAAC,EAEDO,EAAAA,IAAC,SAAA,CACC,QAAS,IAAMR,EAAiBnB,EAAW,aAAe,CAAC,EAC3D,SAAU,CAACA,EAAW,cACtB,UAAU,8LACX,SAAA,MAAA,CAAA,CAED,CAAA,CACF,CAAA,CACF,CAAA,CAAA,CACF,CAAA,CAAA,CACF,CAAA,EAEJ,CAEJ"}