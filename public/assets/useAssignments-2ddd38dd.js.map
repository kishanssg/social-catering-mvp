{"version":3,"file":"useAssignments.js","sources":["../../../social-catering-ui/social-catering-ui/src/hooks/useAssignments.ts"],"sourcesContent":["import { useState, useEffect } from 'react';\nimport { getAssignments, updateAssignmentStatus as updateAssignmentStatusApi, deleteAssignment as deleteAssignmentApi } from '../services/assignmentsApi';\nimport type { Assignment } from '../services/assignmentsApi';\nimport type { AssignmentFilterParams } from '../types';\n\ninterface UseAssignmentsParams {\n  worker_id?: number;\n  shift_id?: number;\n  status?: string;\n  timeframe?: 'past' | 'today' | 'upcoming';\n  start_date?: string;\n  end_date?: string;\n}\n\ninterface UseAssignmentsReturn {\n  assignments: Assignment[];\n  loading: boolean;\n  error: string | null;\n  filters: AssignmentFilterParams;\n  setFilters: (filters: AssignmentFilterParams) => void;\n  refetch: () => void;\n  updateAssignmentStatus: (id: number, status: string) => Promise<void>;\n  deleteAssignment: (id: number) => Promise<void>;\n}\n\nexport function useAssignments(params?: UseAssignmentsParams): UseAssignmentsReturn {\n  const [assignments, setAssignments] = useState<Assignment[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [filters, setFilters] = useState<AssignmentFilterParams>({});\n\n  const fetchAssignments = async () => {\n    try {\n      setLoading(true);\n      setError(null);\n      \n      // Merge params with filters\n      const queryParams = { ...filters, ...params };\n      const response = await getAssignments(queryParams);\n      \n      if (response.status === 'success' && response.data?.assignments) {\n        setAssignments(response.data.assignments);\n      } else {\n        setError('Failed to fetch assignments');\n      }\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'An error occurred');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const updateAssignmentStatus = async (id: number, status: string) => {\n    try {\n      const response = await updateAssignmentStatusApi(id, status as any);\n      \n      if (response.status === 'success') {\n        // Update local state\n        setAssignments(prev => \n          prev.map(assignment => \n            assignment.id === id \n              ? { ...assignment, status: status as any }\n              : assignment\n          )\n        );\n      } else {\n        setError('Failed to update assignment status');\n      }\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to update assignment status');\n    }\n  };\n\n  const deleteAssignment = async (id: number) => {\n    try {\n      await deleteAssignmentApi(id);\n      \n      // Remove from local state\n      setAssignments(prev => prev.filter(assignment => assignment.id !== id));\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to delete assignment');\n    }\n  };\n\n  useEffect(() => {\n    fetchAssignments();\n  }, [filters, params]);\n\n  return {\n    assignments,\n    loading,\n    error,\n    filters,\n    setFilters,\n    refetch: fetchAssignments,\n    updateAssignmentStatus,\n    deleteAssignment,\n  };\n}\n"],"names":["useAssignments","params","assignments","setAssignments","useState","loading","setLoading","error","setError","filters","setFilters","fetchAssignments","queryParams","response","getAssignments","err","updateAssignmentStatus","id","status","updateAssignmentStatusApi","prev","assignment","deleteAssignment","deleteAssignmentApi","useEffect"],"mappings":"kGAyBO,SAASA,EAAeC,EAAqD,CAClF,KAAM,CAACC,EAAaC,CAAc,EAAIC,EAAAA,SAAuB,CAAA,CAAE,EACzD,CAACC,EAASC,CAAU,EAAIF,EAAAA,SAAS,EAAI,EACrC,CAACG,EAAOC,CAAQ,EAAIJ,EAAAA,SAAwB,IAAI,EAChD,CAACK,EAASC,CAAU,EAAIN,EAAAA,SAAiC,CAAA,CAAE,EAE3DO,EAAmB,SAAY,CACnC,GAAI,CACFL,EAAW,EAAI,EACfE,EAAS,IAAI,EAGb,MAAMI,EAAc,CAAE,GAAGH,EAAS,GAAGR,CAAA,EAC/BY,EAAW,MAAMC,EAAeF,CAAW,EAE7CC,EAAS,SAAW,WAAaA,EAAS,MAAM,YAClDV,EAAeU,EAAS,KAAK,WAAW,EAExCL,EAAS,6BAA6B,CAE1C,OAASO,EAAK,CACZP,EAASO,aAAe,MAAQA,EAAI,QAAU,mBAAmB,CACnE,QAAA,CACET,EAAW,EAAK,CAClB,CACF,EAEMU,EAAyB,MAAOC,EAAYC,IAAmB,CACnE,GAAI,EACe,MAAMC,EAA0BF,EAAIC,CAAa,GAErD,SAAW,UAEtBf,KACEiB,EAAK,IAAIC,GACPA,EAAW,KAAOJ,EACd,CAAE,GAAGI,EAAY,OAAAH,GACjBG,CAAA,CACN,EAGFb,EAAS,oCAAoC,CAEjD,OAASO,EAAK,CACZP,EAASO,aAAe,MAAQA,EAAI,QAAU,oCAAoC,CACpF,CACF,EAEMO,EAAmB,MAAOL,GAAe,CAC7C,GAAI,CACF,MAAMM,EAAoBN,CAAE,EAG5Bd,KAAuBiB,EAAK,UAAqBC,EAAW,KAAOJ,CAAE,CAAC,CACxE,OAASF,EAAK,CACZP,EAASO,aAAe,MAAQA,EAAI,QAAU,6BAA6B,CAC7E,CACF,EAEAS,OAAAA,EAAAA,UAAU,IAAM,CACdb,EAAA,CACF,EAAG,CAACF,EAASR,CAAM,CAAC,EAEb,CACL,YAAAC,EACA,QAAAG,EACA,MAAAE,EACA,QAAAE,EACA,WAAAC,EACA,QAASC,EAAA,uBACTK,EAAA,iBACAM,CAAA,CAEJ"}