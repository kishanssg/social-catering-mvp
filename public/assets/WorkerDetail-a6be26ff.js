import{d as F,e as z,r as a,j as e,L as n}from"./application.js";import{g as B,r as T,a as V}from"./workersApi.js";import{a as O}from"./api.js";import{L as R,C as H}from"./LoadingSpinner.js";import{E as U}from"./ErrorMessage.js";import{c}from"./createLucideIcon.js";import{C as v}from"./calendar.js";import{U as Q}from"./user.js";import{M as X,P as q}from"./phone.js";import{B as G}from"./briefcase.js";import{P as J}from"./plus.js";import{X as K}from"./x.js";import{f as w}from"./format.js";import{p as k}from"./parseISO.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Z=c("arrow-left",Y);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],se=c("award",ee);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],C=c("pen",te);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],re=c("trash-2",ae),ye=()=>{const{id:o}=F(),u=z(),[s,_]=a.useState(null),[S,p]=a.useState(!0),[j,i]=a.useState(""),[A,d]=a.useState(!1),[E,y]=a.useState(!1),[M,$]=a.useState([]),[D,m]=a.useState(!1),[l,x]=a.useState(null),[N,h]=a.useState(""),[g,b]=a.useState(!1);a.useEffect(()=>{o&&(f(parseInt(o)),I())},[o]);const f=async t=>{try{p(!0),i("");const r=await B(t);_(r.data)}catch(r){i("Failed to load worker details"),console.error("Error loading worker:",r)}finally{p(!1)}},I=async()=>{try{const t=await O.getCertifications();$(t.data.certifications||[])}catch(t){console.error("Error loading certifications:",t)}},W=async()=>{if(!(!s||!l)){b(!0);try{const t={certification_id:l,expires_at_utc:N||void 0};await V(s.id,t),await f(s.id),x(null),h(""),m(!1)}catch(t){i(t.response?.data?.error||"Failed to add certification"),console.error("Error adding certification:",t)}finally{b(!1)}}},L=async t=>{if(s)try{await T(s.id,t),await f(s.id)}catch(r){i(r.response?.data?.error||"Failed to remove certification"),console.error("Error removing certification:",r)}},P=async()=>{if(s){y(!0);try{console.log("Delete worker:",s.id),u("/workers")}catch(t){console.error("Error deleting worker:",t)}finally{y(!1),d(!1)}}};return S?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(R,{size:"lg"})}):j||!s?e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsx(U,{message:j||"Worker not found"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>u("/workers"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-4",children:[e.jsx(Z,{className:"h-5 w-5"}),"Back to Workers"]}),e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:[s.first_name," ",s.last_name]}),e.jsx("p",{className:"text-gray-500 mt-1",children:s.email})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(n,{to:`/workers/${s.id}/edit`,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-2",children:[e.jsx(C,{className:"h-4 w-4"}),"Edit"]}),e.jsxs(n,{to:`/workers/${s.id}/schedule`,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 flex items-center gap-2",children:[e.jsx(v,{className:"h-4 w-4"}),"View Schedule"]}),e.jsxs("button",{onClick:()=>d(!0),className:"px-4 py-2 border border-red-300 text-red-600 rounded-lg hover:bg-red-50",children:[e.jsx(re,{className:"h-4 w-4"}),"Delete"]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(Q,{className:"h-5 w-5"}),"Basic Information"]}),e.jsxs("dl",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Full Name"}),e.jsxs("dd",{className:"mt-1 text-sm text-gray-900",children:[s.first_name," ",s.last_name]})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Status"}),e.jsx("dd",{className:"mt-1",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${s.active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:s.active?"Active":"Inactive"})})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Email"}),e.jsxs("dd",{className:"mt-1 text-sm text-gray-900 flex items-center gap-2",children:[e.jsx(X,{className:"h-4 w-4 text-gray-400"}),e.jsx("a",{href:`mailto:${s.email}`,className:"hover:text-blue-600",children:s.email})]})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Phone"}),e.jsxs("dd",{className:"mt-1 text-sm text-gray-900 flex items-center gap-2",children:[e.jsx(q,{className:"h-4 w-4 text-gray-400"}),s.phone?e.jsx("a",{href:`tel:${s.phone}`,className:"hover:text-blue-600",children:s.phone}):e.jsx("span",{className:"text-gray-400",children:"No phone number"})]})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Added"}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:w(k(s.created_at),"MMM d, yyyy")})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(G,{className:"h-5 w-5"}),"Skills"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.skills_json&&s.skills_json.length>0?s.skills_json.map((t,r)=>e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-blue-100 text-blue-800",children:t},r)):e.jsx("p",{className:"text-sm text-gray-500 italic",children:"No skills added"})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(se,{className:"h-5 w-5"}),"Certifications"]}),e.jsxs("button",{onClick:()=>m(!0),className:"px-3 py-1 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700 flex items-center gap-1",children:[e.jsx(J,{className:"h-4 w-4"}),"Add Certification"]})]}),s.certifications&&s.certifications.length>0?e.jsx("div",{className:"space-y-3",children:s.certifications.map((t,r)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:t.name}),t.expires_at_utc&&e.jsxs("span",{className:"text-sm text-gray-500",children:["Expires: ",w(k(t.expires_at_utc),"MMM d, yyyy")]})]}),e.jsx("button",{onClick:()=>L(t.certification_id),className:"p-1 text-red-600 hover:text-red-800 hover:bg-red-50 rounded",title:"Remove certification",children:e.jsx(K,{className:"h-4 w-4"})})]},t.certification_id||r))}):e.jsx("p",{className:"text-sm text-gray-500 italic",children:"No certifications"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Quick Actions"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(n,{to:`/workers/${s.id}/schedule`,className:"w-full flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[e.jsx(v,{className:"h-4 w-4"}),"View Schedule"]}),e.jsxs(n,{to:`/workers/${s.id}/edit`,className:"w-full flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:[e.jsx(C,{className:"h-4 w-4"}),"Edit Worker"]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Worker Stats"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Status"}),e.jsx("div",{className:`text-lg font-semibold ${s.active?"text-green-600":"text-gray-600"}`,children:s.active?"Active":"Inactive"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Skills Count"}),e.jsx("div",{className:"text-lg font-semibold text-gray-900",children:s.skills_json?.length||0})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Certifications"}),e.jsx("div",{className:"text-lg font-semibold text-gray-900",children:s.certifications?.length||0})]})]})]})]})]}),e.jsx(H,{isOpen:A,onClose:()=>d(!1),onConfirm:P,title:"Delete Worker",message:`Are you sure you want to delete ${s.first_name} ${s.last_name}? This action cannot be undone.`,confirmText:"Delete",isLoading:E}),D&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Add Certification"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Certification"}),e.jsxs("select",{value:l||"",onChange:t=>x(parseInt(t.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Select a certification"}),M.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Expiration Date (Optional)"}),e.jsx("input",{type:"date",value:N,onChange:t=>h(t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx("button",{onClick:()=>{m(!1),x(null),h("")},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",disabled:g,children:"Cancel"}),e.jsx("button",{onClick:W,disabled:!l||g,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:g?"Adding...":"Add Certification"})]})]})})]})};export{ye as default};
//# sourceMappingURL=/assets/WorkerDetail-c4f2629c.js.map
