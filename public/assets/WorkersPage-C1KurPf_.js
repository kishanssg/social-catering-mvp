import{j as e,u as Q,L as V,E as X,U as Y,M as S,W as z,b as Z,C as ee,a as N}from"./index-yz7Odp8O.js";import{L as B,b as r}from"./vendor-7daYTdBd.js";import{E as se}from"./EmptyState-D_QhUCf6.js";import{B as te}from"./BulkAssignModal-4btsSbCj.js";import"./ErrorMessage-1iSwYPZX.js";function re({search:o,status:d,onSearchChange:n,onStatusChange:s,onAddClick:x}){return e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between",children:[e.jsx("div",{className:"flex-1 max-w-md",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("svg",{className:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),e.jsx("input",{type:"text",value:o,onChange:a=>n(a.target.value),placeholder:"Search workers by name, skill, or certification...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("select",{value:d,onChange:a=>s(a.target.value),className:"block px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",children:[e.jsx("option",{value:"all",children:"All Workers"}),e.jsx("option",{value:"active",children:"Active Only"}),e.jsx("option",{value:"inactive",children:"Inactive Only"})]}),e.jsxs("button",{onClick:x,className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[e.jsx("svg",{className:"h-5 w-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),e.jsx("span",{children:"Add Worker"})]})]})]})}function ae({workers:o,onEdit:d,onDelete:n}){return e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Skills"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:o.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[s.first_name," ",s.last_name]}),e.jsx("div",{className:"text-sm text-gray-500",children:s.email})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900",children:s.phone})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"flex flex-wrap gap-1",children:s.skills_json&&s.skills_json.length>0?e.jsxs(e.Fragment,{children:[s.skills_json.slice(0,3).map((x,a)=>e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800",children:x},a)),s.skills_json.length>3&&e.jsxs("span",{className:"text-xs text-gray-500",children:["+",s.skills_json.length-3," more"]})]}):e.jsx("span",{className:"text-sm text-gray-400",children:"No skills"})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${s.active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:s.active?"Active":"Inactive"})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[e.jsx(B,{to:`/workers/${s.id}/schedule`,className:"text-green-600 hover:text-green-700 text-sm mr-3",children:"Schedule"}),e.jsx(B,{to:`/workers/${s.id}`,className:"text-blue-600 hover:text-blue-900 mr-3",children:"View"}),e.jsx("button",{onClick:()=>d(s),className:"text-indigo-600 hover:text-indigo-900 mr-3",children:"Edit"}),e.jsx("button",{onClick:()=>n(s),className:"text-red-600 hover:text-red-900",children:"Delete"})]})]},s.id))})]})})})}function ne({message:o,type:d,isVisible:n,onClose:s}){if(r.useEffect(()=>{if(n){const w=setTimeout(()=>{s()},3e3);return()=>clearTimeout(w)}},[n,s]),!n)return null;const x={success:"bg-green-500",error:"bg-red-500",info:"bg-blue-500"},a={success:e.jsx("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),error:e.jsx("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})}),info:e.jsx("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})};return e.jsx("div",{className:"fixed bottom-4 right-4 z-50 animate-slide-up",children:e.jsxs("div",{className:`${x[d]} text-white px-6 py-4 rounded-lg shadow-lg flex items-center space-x-3 min-w-[300px]`,children:[a[d],e.jsx("span",{className:"flex-1",children:o}),e.jsx("button",{onClick:s,className:"text-white hover:text-gray-200",children:e.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})})}function xe(){const[o,d]=r.useState(""),[n,s]=r.useState("all"),[x,a]=r.useState(!1),[w,g]=r.useState(!1),[D,O]=r.useState(!1),[T,M]=r.useState(!1),[I,C]=r.useState(!1),[t,f]=r.useState(null),[L,j]=r.useState(!1),[$,A]=r.useState(!1),[v,u]=r.useState(null),[y,m]=r.useState(null),{workers:h,filteredWorkers:k,isLoading:F,error:_,refetch:p}=Q({search:o,status:n}),W=r.useMemo(()=>{const l=h.length,i=h.filter(b=>b.active).length,c=h.filter(b=>!b.active).length;return{total:l,active:i,inactive:c}},[h]),H=()=>{f(null),u(null),a(!0)},R=l=>{f(l),u(null),g(!0)},U=l=>{f(l),M(!0)},G=async l=>{try{j(!0),u(null);const{certifications:i,...c}=l,J=(await N.createWorker(c)).data.worker.id;if(i&&i.length>0)for(const E of i)try{await N.addCertificationToWorker(J,{certification_id:E.certification_id,expires_at_utc:E.expires_at_utc})}catch(K){console.error("Error adding certification:",K)}a(!1),p(),m({message:"Worker added successfully!",type:"success"})}catch(i){const c=i.response?.data?.error||"Failed to create worker";u(c),m({message:c,type:"error"})}finally{j(!1)}},P=async l=>{if(t)try{j(!0),u(null),await N.updateWorker(t.id,l),g(!1),p(),m({message:"Worker updated successfully!",type:"success"})}catch(i){const c=i.response?.data?.error||"Failed to update worker";u(c),m({message:c,type:"error"})}finally{j(!1)}},q=async()=>{if(t)try{A(!0),await N.updateWorker(t.id,{active:!1}),M(!1),f(null),p(),m({message:`${t.first_name} ${t.last_name} has been deactivated successfully!`,type:"success"})}catch(l){const i=l.response?.data?.error||"Failed to delete worker";m({message:i,type:"error"})}finally{A(!1)}};return F?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx(V,{size:"lg"})}):_?e.jsx(X,{message:_,onRetry:p}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Workers"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your workforce directory"})]}),e.jsxs("button",{onClick:()=>C(!0),className:"btn-green flex items-center gap-2",children:[e.jsx(Y,{className:"h-4 w-4"}),"Bulk Assign"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Workers"}),e.jsx("p",{className:"mt-2 text-3xl font-bold text-gray-900",children:W.total})]}),e.jsx("div",{className:"p-3 rounded-lg bg-blue-50 text-blue-600",children:e.jsx("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Active"}),e.jsx("p",{className:"mt-2 text-3xl font-bold text-green-600",children:W.active})]}),e.jsx("div",{className:"p-3 rounded-lg bg-green-50 text-green-600",children:e.jsx("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Inactive"}),e.jsx("p",{className:"mt-2 text-3xl font-bold text-gray-600",children:W.inactive})]}),e.jsx("div",{className:"p-3 rounded-lg bg-gray-50 text-gray-600",children:e.jsx("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"})})})]})})]}),e.jsx(re,{search:o,status:n,onSearchChange:d,onStatusChange:s,onAddClick:H}),k.length>0?e.jsxs(e.Fragment,{children:[e.jsx(ae,{workers:k,onEdit:R,onDelete:U}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Showing ",k.length," worker",k.length!==1?"s":"",o&&e.jsxs("span",{className:"text-blue-600 ml-1",children:["(filtered from ",h.length," total)"]})]})]}):e.jsx(se,{title:"No Workers Found",description:o||n!=="all"?"Try adjusting your search or filters":"Get started by adding your first worker",icon:e.jsx("svg",{className:"h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),e.jsxs(S,{isOpen:x,onClose:()=>a(!1),title:"Add New Worker",size:"lg",children:[v&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsx("p",{className:"text-sm text-red-700",children:v})}),e.jsx(z,{onSubmit:G,onCancel:()=>a(!1),isSubmitting:L})]}),e.jsxs(S,{isOpen:w,onClose:()=>g(!1),title:"Edit Worker",size:"lg",children:[v&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsx("p",{className:"text-sm text-red-700",children:v})}),e.jsx(z,{worker:t,onSubmit:P,onCancel:()=>g(!1),isSubmitting:L})]}),e.jsx(S,{isOpen:D,onClose:()=>O(!1),title:t?`${t.first_name} ${t.last_name}`:"Worker Details",size:"lg",children:t&&e.jsx(Z,{worker:t})}),e.jsx(ee,{isOpen:T,onClose:()=>M(!1),onConfirm:q,title:"Delete Worker",message:t?`Are you sure you want to delete ${t.first_name} ${t.last_name}? This action cannot be undone.`:"Are you sure you want to delete this worker?",confirmText:"Delete",cancelText:"Cancel",isLoading:$}),y&&e.jsx(ne,{message:y.message,type:y.type,isVisible:!!y,onClose:()=>m(null)}),I&&e.jsx(te,{onClose:()=>C(!1),onSuccess:()=>{p(),C(!1)}})]})}export{xe as WorkersPage};
