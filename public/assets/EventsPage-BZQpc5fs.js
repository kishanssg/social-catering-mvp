import{c as Ie,j as e,X as Ce,a as se,A as fe,b as Ss,C as As}from"./index-CbuUkb5y.js";import{r as j,b as ds,f as Ms}from"./vendor-79DyBOV9.js";import{f as $s,a as as}from"./dateUtils-CHmZs4Ub.js";import{C as we}from"./clock-C_sUxSuV.js";import{M as We}from"./map-pin-Bjv73Xb0.js";import{U as Ue}from"./users-CN2b3EDL.js";import{S as ss,T as De,L as Ke,C as Be}from"./ConfirmationModal-DzzT-vxC.js";import{D as ms}from"./dollar-sign-BddIBZhH.js";import{T as ts}from"./Toast-vM9MyL4u.js";import{C as Fs}from"./x-circle-Dyh2Oeft.js";import{b as zs,a as Es,c as Ls,e as Ps,p as Ts}from"./Prep Cook-CE8OFMb5.js";import{P as us}from"./pen-square-CY39eBjB.js";import{P as qe}from"./plus-DhIeZ-MH.js";import{f as ye}from"./index-C_slYh2M.js";import{p as he}from"./index-BK_MyBzW.js";import{C as He}from"./calendar-D1l9wB1A.js";import{C as Rs}from"./chevron-down-CcF9pRZ4.js";import{C as Ds}from"./chevron-right-BG8jyoFu.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ns=Ie("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _e=Ie("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Is=Ie("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=Ie("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vs=Ie("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);function xs(s,r=0){const a=typeof s=="string"?Number(s):s;return Number.isFinite(a)?a:r}function re(s,r=2,a="0"){const t=xs(s,NaN);if(!Number.isFinite(t))return a;try{return t.toFixed(r)}catch{return a}}function hs(s){var r,a,t="";if(typeof s=="string"||typeof s=="number")t+=s;else if(typeof s=="object")if(Array.isArray(s)){var h=s.length;for(r=0;r<h;r++)s[r]&&(a=hs(s[r]))&&(t&&(t+=" "),t+=a)}else for(a in s)s[a]&&(t&&(t+=" "),t+=a);return t}function Os(){for(var s,r,a=0,t="",h=arguments.length;a<h;a++)(s=arguments[a])&&(r=hs(s))&&(t&&(t+=" "),t+=r);return t}const rs="-",Us=s=>{const r=qs(s),{conflictingClassGroups:a,conflictingClassGroupModifiers:t}=s;return{getClassGroupId:p=>{const i=p.split(rs);return i[0]===""&&i.length!==1&&i.shift(),gs(i,r)||Ws(p)},getConflictingClassGroupIds:(p,i)=>{const x=a[p]||[];return i&&t[p]?[...x,...t[p]]:x}}},gs=(s,r)=>{var p;if(s.length===0)return r.classGroupId;const a=s[0],t=r.nextPart.get(a),h=t?gs(s.slice(1),t):void 0;if(h)return h;if(r.validators.length===0)return;const n=s.join(rs);return(p=r.validators.find(({validator:i})=>i(n)))==null?void 0:p.classGroupId},ls=/^\[(.+)\]$/,Ws=s=>{if(ls.test(s)){const r=ls.exec(s)[1],a=r==null?void 0:r.substring(0,r.indexOf(":"));if(a)return"arbitrary.."+a}},qs=s=>{const{theme:r,classGroups:a}=s,t={nextPart:new Map,validators:[]};for(const h in a)Xe(a[h],t,h,r);return t},Xe=(s,r,a,t)=>{s.forEach(h=>{if(typeof h=="string"){const n=h===""?r:os(r,h);n.classGroupId=a;return}if(typeof h=="function"){if(Hs(h)){Xe(h(t),r,a,t);return}r.validators.push({validator:h,classGroupId:a});return}Object.entries(h).forEach(([n,p])=>{Xe(p,os(r,n),a,t)})})},os=(s,r)=>{let a=s;return r.split(rs).forEach(t=>{a.nextPart.has(t)||a.nextPart.set(t,{nextPart:new Map,validators:[]}),a=a.nextPart.get(t)}),a},Hs=s=>s.isThemeGetter,Bs=s=>{if(s<1)return{get:()=>{},set:()=>{}};let r=0,a=new Map,t=new Map;const h=(n,p)=>{a.set(n,p),r++,r>s&&(r=0,t=a,a=new Map)};return{get(n){let p=a.get(n);if(p!==void 0)return p;if((p=t.get(n))!==void 0)return h(n,p),p},set(n,p){a.has(n)?a.set(n,p):h(n,p)}}},Ze="!",Ye=":",Qs=Ye.length,Gs=s=>{const{prefix:r,experimentalParseClassName:a}=s;let t=h=>{const n=[];let p=0,i=0,x=0,_;for(let Z=0;Z<h.length;Z++){let b=h[Z];if(p===0&&i===0){if(b===Ye){n.push(h.slice(x,Z)),x=Z+Qs;continue}if(b==="/"){_=Z;continue}}b==="["?p++:b==="]"?p--:b==="("?i++:b===")"&&i--}const W=n.length===0?h:h.substring(x),B=Js(W),K=B!==W,G=_&&_>x?_-x:void 0;return{modifiers:n,hasImportantModifier:K,baseClassName:B,maybePostfixModifierPosition:G}};if(r){const h=r+Ye,n=t;t=p=>p.startsWith(h)?n(p.substring(h.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:p,maybePostfixModifierPosition:void 0}}if(a){const h=t;t=n=>a({className:n,parseClassName:h})}return t},Js=s=>s.endsWith(Ze)?s.substring(0,s.length-1):s.startsWith(Ze)?s.substring(1):s,Ks=s=>{const r=Object.fromEntries(s.orderSensitiveModifiers.map(t=>[t,!0]));return t=>{if(t.length<=1)return t;const h=[];let n=[];return t.forEach(p=>{p[0]==="["||r[p]?(h.push(...n.sort(),p),n=[]):n.push(p)}),h.push(...n.sort()),h}},Xs=s=>({cache:Bs(s.cacheSize),parseClassName:Gs(s),sortModifiers:Ks(s),...Us(s)}),Zs=/\s+/,Ys=(s,r)=>{const{parseClassName:a,getClassGroupId:t,getConflictingClassGroupIds:h,sortModifiers:n}=r,p=[],i=s.trim().split(Zs);let x="";for(let _=i.length-1;_>=0;_-=1){const W=i[_],{isExternal:B,modifiers:K,hasImportantModifier:G,baseClassName:Z,maybePostfixModifierPosition:b}=a(W);if(B){x=W+(x.length>0?" "+x:x);continue}let H=!!b,C=t(H?Z.substring(0,b):Z);if(!C){if(!H){x=W+(x.length>0?" "+x:x);continue}if(C=t(Z),!C){x=W+(x.length>0?" "+x:x);continue}H=!1}const R=n(K).join(":"),v=G?R+Ze:R,P=v+C;if(p.includes(P))continue;p.push(P);const T=h(C,H);for(let F=0;F<T.length;++F){const A=T[F];p.push(v+A)}x=W+(x.length>0?" "+x:x)}return x};function et(){let s=0,r,a,t="";for(;s<arguments.length;)(r=arguments[s++])&&(a=fs(r))&&(t&&(t+=" "),t+=a);return t}const fs=s=>{if(typeof s=="string")return s;let r,a="";for(let t=0;t<s.length;t++)s[t]&&(r=fs(s[t]))&&(a&&(a+=" "),a+=r);return a};function st(s,...r){let a,t,h,n=p;function p(x){const _=r.reduce((W,B)=>B(W),s());return a=Xs(_),t=a.cache.get,h=a.cache.set,n=i,i(x)}function i(x){const _=t(x);if(_)return _;const W=Ys(x,a);return h(x,W),W}return function(){return n(et.apply(null,arguments))}}const le=s=>{const r=a=>a[s]||[];return r.isThemeGetter=!0,r},ps=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,bs=/^\((?:(\w[\w-]*):)?(.+)\)$/i,tt=/^\d+\/\d+$/,rt=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,at=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,nt=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,lt=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,ot=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Ee=s=>tt.test(s),O=s=>!!s&&!Number.isNaN(Number(s)),ke=s=>!!s&&Number.isInteger(Number(s)),Qe=s=>s.endsWith("%")&&O(s.slice(0,-1)),ve=s=>rt.test(s),it=()=>!0,ct=s=>at.test(s)&&!nt.test(s),ys=()=>!1,dt=s=>lt.test(s),mt=s=>ot.test(s),ut=s=>!w(s)&&!N(s),xt=s=>Le(s,ws,ys),w=s=>ps.test(s),Ae=s=>Le(s,Ns,ct),Ge=s=>Le(s,bt,O),is=s=>Le(s,js,ys),ht=s=>Le(s,vs,mt),Ve=s=>Le(s,ks,dt),N=s=>bs.test(s),Re=s=>Pe(s,Ns),gt=s=>Pe(s,yt),cs=s=>Pe(s,js),ft=s=>Pe(s,ws),pt=s=>Pe(s,vs),Oe=s=>Pe(s,ks,!0),Le=(s,r,a)=>{const t=ps.exec(s);return t?t[1]?r(t[1]):a(t[2]):!1},Pe=(s,r,a=!1)=>{const t=bs.exec(s);return t?t[1]?r(t[1]):a:!1},js=s=>s==="position"||s==="percentage",vs=s=>s==="image"||s==="url",ws=s=>s==="length"||s==="size"||s==="bg-size",Ns=s=>s==="length",bt=s=>s==="number",yt=s=>s==="family-name",ks=s=>s==="shadow",jt=()=>{const s=le("color"),r=le("font"),a=le("text"),t=le("font-weight"),h=le("tracking"),n=le("leading"),p=le("breakpoint"),i=le("container"),x=le("spacing"),_=le("radius"),W=le("shadow"),B=le("inset-shadow"),K=le("text-shadow"),G=le("drop-shadow"),Z=le("blur"),b=le("perspective"),H=le("aspect"),C=le("ease"),R=le("animate"),v=()=>["auto","avoid","all","avoid-page","page","left","right","column"],P=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],T=()=>[...P(),N,w],F=()=>["auto","hidden","clip","visible","scroll"],A=()=>["auto","contain","none"],k=()=>[N,w,x],Y=()=>[Ee,"full","auto",...k()],J=()=>[ke,"none","subgrid",N,w],g=()=>["auto",{span:["full",ke,N,w]},ke,N,w],l=()=>[ke,"auto",N,w],m=()=>["auto","min","max","fr",N,w],z=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],V=()=>["start","end","center","stretch","center-safe","end-safe"],L=()=>["auto",...k()],D=()=>[Ee,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...k()],d=()=>[s,N,w],S=()=>[...P(),cs,is,{position:[N,w]}],u=()=>["no-repeat",{repeat:["","x","y","space","round"]}],f=()=>["auto","cover","contain",ft,xt,{size:[N,w]}],$=()=>[Qe,Re,Ae],y=()=>["","none","full",_,N,w],E=()=>["",O,Re,Ae],q=()=>["solid","dashed","dotted","double"],ee=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],c=()=>[O,Qe,cs,is],U=()=>["","none",Z,N,w],Q=()=>["none",O,N,w],te=()=>["none",O,N,w],oe=()=>[O,N,w],je=()=>[Ee,"full",...k()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[ve],breakpoint:[ve],color:[it],container:[ve],"drop-shadow":[ve],ease:["in","out","in-out"],font:[ut],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[ve],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[ve],shadow:[ve],spacing:["px",O],text:[ve],"text-shadow":[ve],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",Ee,w,N,H]}],container:["container"],columns:[{columns:[O,w,N,i]}],"break-after":[{"break-after":v()}],"break-before":[{"break-before":v()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:T()}],overflow:[{overflow:F()}],"overflow-x":[{"overflow-x":F()}],"overflow-y":[{"overflow-y":F()}],overscroll:[{overscroll:A()}],"overscroll-x":[{"overscroll-x":A()}],"overscroll-y":[{"overscroll-y":A()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:Y()}],"inset-x":[{"inset-x":Y()}],"inset-y":[{"inset-y":Y()}],start:[{start:Y()}],end:[{end:Y()}],top:[{top:Y()}],right:[{right:Y()}],bottom:[{bottom:Y()}],left:[{left:Y()}],visibility:["visible","invisible","collapse"],z:[{z:[ke,"auto",N,w]}],basis:[{basis:[Ee,"full","auto",i,...k()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[O,Ee,"auto","initial","none",w]}],grow:[{grow:["",O,N,w]}],shrink:[{shrink:["",O,N,w]}],order:[{order:[ke,"first","last","none",N,w]}],"grid-cols":[{"grid-cols":J()}],"col-start-end":[{col:g()}],"col-start":[{"col-start":l()}],"col-end":[{"col-end":l()}],"grid-rows":[{"grid-rows":J()}],"row-start-end":[{row:g()}],"row-start":[{"row-start":l()}],"row-end":[{"row-end":l()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":m()}],"auto-rows":[{"auto-rows":m()}],gap:[{gap:k()}],"gap-x":[{"gap-x":k()}],"gap-y":[{"gap-y":k()}],"justify-content":[{justify:[...z(),"normal"]}],"justify-items":[{"justify-items":[...V(),"normal"]}],"justify-self":[{"justify-self":["auto",...V()]}],"align-content":[{content:["normal",...z()]}],"align-items":[{items:[...V(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...V(),{baseline:["","last"]}]}],"place-content":[{"place-content":z()}],"place-items":[{"place-items":[...V(),"baseline"]}],"place-self":[{"place-self":["auto",...V()]}],p:[{p:k()}],px:[{px:k()}],py:[{py:k()}],ps:[{ps:k()}],pe:[{pe:k()}],pt:[{pt:k()}],pr:[{pr:k()}],pb:[{pb:k()}],pl:[{pl:k()}],m:[{m:L()}],mx:[{mx:L()}],my:[{my:L()}],ms:[{ms:L()}],me:[{me:L()}],mt:[{mt:L()}],mr:[{mr:L()}],mb:[{mb:L()}],ml:[{ml:L()}],"space-x":[{"space-x":k()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":k()}],"space-y-reverse":["space-y-reverse"],size:[{size:D()}],w:[{w:[i,"screen",...D()]}],"min-w":[{"min-w":[i,"screen","none",...D()]}],"max-w":[{"max-w":[i,"screen","none","prose",{screen:[p]},...D()]}],h:[{h:["screen","lh",...D()]}],"min-h":[{"min-h":["screen","lh","none",...D()]}],"max-h":[{"max-h":["screen","lh",...D()]}],"font-size":[{text:["base",a,Re,Ae]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[t,N,Ge]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",Qe,w]}],"font-family":[{font:[gt,w,r]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[h,N,w]}],"line-clamp":[{"line-clamp":[O,"none",N,Ge]}],leading:[{leading:[n,...k()]}],"list-image":[{"list-image":["none",N,w]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",N,w]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:d()}],"text-color":[{text:d()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...q(),"wavy"]}],"text-decoration-thickness":[{decoration:[O,"from-font","auto",N,Ae]}],"text-decoration-color":[{decoration:d()}],"underline-offset":[{"underline-offset":[O,"auto",N,w]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:k()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",N,w]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",N,w]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:S()}],"bg-repeat":[{bg:u()}],"bg-size":[{bg:f()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},ke,N,w],radial:["",N,w],conic:[ke,N,w]},pt,ht]}],"bg-color":[{bg:d()}],"gradient-from-pos":[{from:$()}],"gradient-via-pos":[{via:$()}],"gradient-to-pos":[{to:$()}],"gradient-from":[{from:d()}],"gradient-via":[{via:d()}],"gradient-to":[{to:d()}],rounded:[{rounded:y()}],"rounded-s":[{"rounded-s":y()}],"rounded-e":[{"rounded-e":y()}],"rounded-t":[{"rounded-t":y()}],"rounded-r":[{"rounded-r":y()}],"rounded-b":[{"rounded-b":y()}],"rounded-l":[{"rounded-l":y()}],"rounded-ss":[{"rounded-ss":y()}],"rounded-se":[{"rounded-se":y()}],"rounded-ee":[{"rounded-ee":y()}],"rounded-es":[{"rounded-es":y()}],"rounded-tl":[{"rounded-tl":y()}],"rounded-tr":[{"rounded-tr":y()}],"rounded-br":[{"rounded-br":y()}],"rounded-bl":[{"rounded-bl":y()}],"border-w":[{border:E()}],"border-w-x":[{"border-x":E()}],"border-w-y":[{"border-y":E()}],"border-w-s":[{"border-s":E()}],"border-w-e":[{"border-e":E()}],"border-w-t":[{"border-t":E()}],"border-w-r":[{"border-r":E()}],"border-w-b":[{"border-b":E()}],"border-w-l":[{"border-l":E()}],"divide-x":[{"divide-x":E()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":E()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...q(),"hidden","none"]}],"divide-style":[{divide:[...q(),"hidden","none"]}],"border-color":[{border:d()}],"border-color-x":[{"border-x":d()}],"border-color-y":[{"border-y":d()}],"border-color-s":[{"border-s":d()}],"border-color-e":[{"border-e":d()}],"border-color-t":[{"border-t":d()}],"border-color-r":[{"border-r":d()}],"border-color-b":[{"border-b":d()}],"border-color-l":[{"border-l":d()}],"divide-color":[{divide:d()}],"outline-style":[{outline:[...q(),"none","hidden"]}],"outline-offset":[{"outline-offset":[O,N,w]}],"outline-w":[{outline:["",O,Re,Ae]}],"outline-color":[{outline:d()}],shadow:[{shadow:["","none",W,Oe,Ve]}],"shadow-color":[{shadow:d()}],"inset-shadow":[{"inset-shadow":["none",B,Oe,Ve]}],"inset-shadow-color":[{"inset-shadow":d()}],"ring-w":[{ring:E()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:d()}],"ring-offset-w":[{"ring-offset":[O,Ae]}],"ring-offset-color":[{"ring-offset":d()}],"inset-ring-w":[{"inset-ring":E()}],"inset-ring-color":[{"inset-ring":d()}],"text-shadow":[{"text-shadow":["none",K,Oe,Ve]}],"text-shadow-color":[{"text-shadow":d()}],opacity:[{opacity:[O,N,w]}],"mix-blend":[{"mix-blend":[...ee(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":ee()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[O]}],"mask-image-linear-from-pos":[{"mask-linear-from":c()}],"mask-image-linear-to-pos":[{"mask-linear-to":c()}],"mask-image-linear-from-color":[{"mask-linear-from":d()}],"mask-image-linear-to-color":[{"mask-linear-to":d()}],"mask-image-t-from-pos":[{"mask-t-from":c()}],"mask-image-t-to-pos":[{"mask-t-to":c()}],"mask-image-t-from-color":[{"mask-t-from":d()}],"mask-image-t-to-color":[{"mask-t-to":d()}],"mask-image-r-from-pos":[{"mask-r-from":c()}],"mask-image-r-to-pos":[{"mask-r-to":c()}],"mask-image-r-from-color":[{"mask-r-from":d()}],"mask-image-r-to-color":[{"mask-r-to":d()}],"mask-image-b-from-pos":[{"mask-b-from":c()}],"mask-image-b-to-pos":[{"mask-b-to":c()}],"mask-image-b-from-color":[{"mask-b-from":d()}],"mask-image-b-to-color":[{"mask-b-to":d()}],"mask-image-l-from-pos":[{"mask-l-from":c()}],"mask-image-l-to-pos":[{"mask-l-to":c()}],"mask-image-l-from-color":[{"mask-l-from":d()}],"mask-image-l-to-color":[{"mask-l-to":d()}],"mask-image-x-from-pos":[{"mask-x-from":c()}],"mask-image-x-to-pos":[{"mask-x-to":c()}],"mask-image-x-from-color":[{"mask-x-from":d()}],"mask-image-x-to-color":[{"mask-x-to":d()}],"mask-image-y-from-pos":[{"mask-y-from":c()}],"mask-image-y-to-pos":[{"mask-y-to":c()}],"mask-image-y-from-color":[{"mask-y-from":d()}],"mask-image-y-to-color":[{"mask-y-to":d()}],"mask-image-radial":[{"mask-radial":[N,w]}],"mask-image-radial-from-pos":[{"mask-radial-from":c()}],"mask-image-radial-to-pos":[{"mask-radial-to":c()}],"mask-image-radial-from-color":[{"mask-radial-from":d()}],"mask-image-radial-to-color":[{"mask-radial-to":d()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":P()}],"mask-image-conic-pos":[{"mask-conic":[O]}],"mask-image-conic-from-pos":[{"mask-conic-from":c()}],"mask-image-conic-to-pos":[{"mask-conic-to":c()}],"mask-image-conic-from-color":[{"mask-conic-from":d()}],"mask-image-conic-to-color":[{"mask-conic-to":d()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:S()}],"mask-repeat":[{mask:u()}],"mask-size":[{mask:f()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",N,w]}],filter:[{filter:["","none",N,w]}],blur:[{blur:U()}],brightness:[{brightness:[O,N,w]}],contrast:[{contrast:[O,N,w]}],"drop-shadow":[{"drop-shadow":["","none",G,Oe,Ve]}],"drop-shadow-color":[{"drop-shadow":d()}],grayscale:[{grayscale:["",O,N,w]}],"hue-rotate":[{"hue-rotate":[O,N,w]}],invert:[{invert:["",O,N,w]}],saturate:[{saturate:[O,N,w]}],sepia:[{sepia:["",O,N,w]}],"backdrop-filter":[{"backdrop-filter":["","none",N,w]}],"backdrop-blur":[{"backdrop-blur":U()}],"backdrop-brightness":[{"backdrop-brightness":[O,N,w]}],"backdrop-contrast":[{"backdrop-contrast":[O,N,w]}],"backdrop-grayscale":[{"backdrop-grayscale":["",O,N,w]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[O,N,w]}],"backdrop-invert":[{"backdrop-invert":["",O,N,w]}],"backdrop-opacity":[{"backdrop-opacity":[O,N,w]}],"backdrop-saturate":[{"backdrop-saturate":[O,N,w]}],"backdrop-sepia":[{"backdrop-sepia":["",O,N,w]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":k()}],"border-spacing-x":[{"border-spacing-x":k()}],"border-spacing-y":[{"border-spacing-y":k()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",N,w]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[O,"initial",N,w]}],ease:[{ease:["linear","initial",C,N,w]}],delay:[{delay:[O,N,w]}],animate:[{animate:["none",R,N,w]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[b,N,w]}],"perspective-origin":[{"perspective-origin":T()}],rotate:[{rotate:Q()}],"rotate-x":[{"rotate-x":Q()}],"rotate-y":[{"rotate-y":Q()}],"rotate-z":[{"rotate-z":Q()}],scale:[{scale:te()}],"scale-x":[{"scale-x":te()}],"scale-y":[{"scale-y":te()}],"scale-z":[{"scale-z":te()}],"scale-3d":["scale-3d"],skew:[{skew:oe()}],"skew-x":[{"skew-x":oe()}],"skew-y":[{"skew-y":oe()}],transform:[{transform:[N,w,"","none","gpu","cpu"]}],"transform-origin":[{origin:T()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:je()}],"translate-x":[{"translate-x":je()}],"translate-y":[{"translate-y":je()}],"translate-z":[{"translate-z":je()}],"translate-none":["translate-none"],accent:[{accent:d()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:d()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",N,w]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":k()}],"scroll-mx":[{"scroll-mx":k()}],"scroll-my":[{"scroll-my":k()}],"scroll-ms":[{"scroll-ms":k()}],"scroll-me":[{"scroll-me":k()}],"scroll-mt":[{"scroll-mt":k()}],"scroll-mr":[{"scroll-mr":k()}],"scroll-mb":[{"scroll-mb":k()}],"scroll-ml":[{"scroll-ml":k()}],"scroll-p":[{"scroll-p":k()}],"scroll-px":[{"scroll-px":k()}],"scroll-py":[{"scroll-py":k()}],"scroll-ps":[{"scroll-ps":k()}],"scroll-pe":[{"scroll-pe":k()}],"scroll-pt":[{"scroll-pt":k()}],"scroll-pr":[{"scroll-pr":k()}],"scroll-pb":[{"scroll-pb":k()}],"scroll-pl":[{"scroll-pl":k()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",N,w]}],fill:[{fill:["none",...d()]}],"stroke-w":[{stroke:[O,Re,Ae,Ge]}],stroke:[{stroke:["none",...d()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},vt=st(jt);function Me(...s){return vt(Os(s))}const wt={sm:"max-w-md",md:"max-w-2xl",lg:"max-w-4xl",xl:"max-w-6xl"},es=({isOpen:s,onClose:r,title:a,subtitle:t,children:h,footer:n,size:p="md",closeOnOverlayClick:i=!0})=>{if(j.useEffect(()=>(s?document.body.classList.add("modal-open"):document.body.classList.remove("modal-open"),()=>{document.body.classList.remove("modal-open")}),[s]),j.useEffect(()=>{const _=W=>{W.key==="Escape"&&s&&r()};return document.addEventListener("keydown",_),()=>document.removeEventListener("keydown",_)},[s,r]),!s)return null;const x=_=>{_.target===_.currentTarget&&i&&r()};return e.jsx("div",{className:"modal-overlay",onClick:x,role:"dialog","aria-modal":"true","aria-labelledby":"modal-title",children:e.jsxs("div",{className:`modal-container ${wt[p]}`,children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{id:"modal-title",className:"text-xl font-semibold text-gray-900 font-manrope",children:a}),t&&e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:t})]}),e.jsx("button",{onClick:r,className:"p-1.5 rounded-lg bg-gray-100 hover:bg-gray-200 transition-colors","aria-label":"Close modal",children:e.jsx(Ce,{size:20,className:"text-gray-600"})})]}),e.jsx("div",{className:"modal-body",children:h}),n&&e.jsx("div",{className:"modal-footer",children:n})]})})};function Nt({shiftId:s,onClose:r,onSuccess:a}){var J,g;const[t,h]=j.useState(null),[n,p]=j.useState([]),[i,x]=j.useState([]),[_,W]=j.useState(""),[B,K]=j.useState(null),[G,Z]=j.useState({}),[b,H]=j.useState(!0),[C,R]=j.useState(!1),[v,P]=j.useState(null),T=(l,m)=>{Z(z=>({...z,[l]:m}))};j.useEffect(()=>{F()},[s]),j.useEffect(()=>{t&&A()},[t]),j.useEffect(()=>{if(!_)x(n);else{const l=_.toLowerCase();x(n.filter(m=>{var z;return m.first_name.toLowerCase().includes(l)||m.last_name.toLowerCase().includes(l)||m.email.toLowerCase().includes(l)||((z=m.skills_json)==null?void 0:z.some(V=>V.toLowerCase().includes(l)))}))}},[_,n]);async function F(){try{const l=await se.get(`/shifts/${s}`);l.data.status==="success"?h(l.data.data):P("Failed to load shift details")}catch(l){console.error("Failed to load shift details:",l),P("Failed to load shift details")}}async function A(){var l;try{const m=new Set;if(t!=null&&t.event_id)try{const L=((l=(await se.get(`/events/${t.event_id}`)).data)==null?void 0:l.data)||{};if(L.shifts_by_role){const D=L.shifts_by_role.find(d=>d.skill_name===t.role_needed||d.role_name===t.role_needed);D!=null&&D.shifts&&D.shifts.forEach(d=>{d.assignments&&d.assignments.forEach(S=>{var $;const u=S.worker_id||(($=S.worker)==null?void 0:$.id),f=S.status;u&&f!=="cancelled"&&f!=="no_show"&&m.add(u)})})}}catch(V){console.log("Could not fetch event to filter assigned workers:",V)}console.log(`AssignmentModal: Found ${m.size} already assigned workers for "${t==null?void 0:t.role_needed}"`);const z=await se.get("/workers?active=true");if(z.data.status==="success"){const V=z.data.data.workers||z.data.data;if(t!=null&&t.role_needed){const L=V.filter(D=>{var d;return((d=D.skills_json)==null?void 0:d.includes(t.role_needed))&&!m.has(D.id)});console.log(`AssignmentModal: Showing ${L.length} eligible workers`),p(L)}else{const L=V.filter(D=>!m.has(D.id));p(L)}}else P("Failed to load workers")}catch(m){console.error("Failed to load workers:",m),P("Failed to load workers")}finally{H(!1)}}async function k(){var l,m,z,V,L,D;if(!(!B||!t)){R(!0),P(null);try{const S=(await se.post("/staffing",{assignment:{shift_id:t.id,worker_id:B.id,status:"assigned",assigned_at_utc:new Date().toISOString(),hourly_rate:G[B.id]||Number(t.pay_rate)||0}})).data;if(S.status==="success")a();else{let u=S.message||"Failed to assign worker";S.details&&S.details.length>0?u+=`

Details:
â€¢ `+S.details.join(`
â€¢ `):S.errors&&(u+=`

Details:
â€¢ `+S.errors.join(`
â€¢ `)),P(u)}}catch(d){console.error("Failed to assign worker:",d);let S="Failed to assign worker";if((m=(l=d.response)==null?void 0:l.data)!=null&&m.details&&d.response.data.details.length>0){const u=d.response.data.details.map(f=>(f.includes("conflicting shift"),f));S+=`

`+u.join(`
`)}else(V=(z=d.response)==null?void 0:z.data)!=null&&V.errors?S+=`

`+d.response.data.errors.join(`
`):(D=(L=d.response)==null?void 0:L.data)!=null&&D.message?S=d.response.data.message:d.message&&(S=d.message);P(S)}finally{R(!1)}}}if(b)return e.jsx(es,{isOpen:!0,onClose:r,title:"Assign Worker",size:"lg",children:e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-teal-600"})})});const Y=e.jsxs(e.Fragment,{children:[v&&e.jsxs("div",{className:"mb-4 p-3 bg-gradient-to-r from-red-50 to-amber-50 border-l-4 border-red-500 rounded-r-lg shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-6 h-6 bg-red-500 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-white text-xs font-bold",children:"!"})}),e.jsx("h4",{className:"text-sm font-semibold text-red-900",children:"âš ï¸ Scheduling Conflict Detected"})]}),e.jsx("p",{className:"text-xs text-gray-600 ml-8",children:"Please resolve the conflict before attempting to assign this worker"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:r,disabled:C,className:"btn-secondary",children:"Cancel"}),e.jsx("button",{onClick:k,disabled:!B||C||!!v,className:`btn-primary ${v?"opacity-50 cursor-not-allowed":""}`,title:v?"Cannot assign due to scheduling conflict":"",children:C?"Assigning Worker...":"Assign Worker"})]})]});return e.jsx(es,{isOpen:!0,onClose:r,title:t?`${t.client_name} â€¢ ${t.role_needed}`:"Assign Worker",size:"xl",footer:Y,children:e.jsxs("div",{className:"flex h-[600px]",children:[e.jsx("div",{className:"w-1/3 border-r border-gray-200 p-6 bg-gray-50",children:t?e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Shift Details"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(we,{size:16,className:"text-gray-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:$s(t.start_time_utc)}),e.jsxs("div",{className:"text-sm text-gray-600",children:[as(t.start_time_utc)," - ",as(t.end_time_utc)]})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(We,{size:16,className:"text-gray-400 mt-0.5 flex-shrink-0"}),e.jsx("div",{className:"text-sm text-gray-900",children:t.location||((g=(J=t.event)==null?void 0:J.venue)==null?void 0:g.formatted_address)||"Location not specified"})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Ue,{size:16,className:"text-gray-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-900",children:t.role_needed}),t.required_skill&&e.jsxs("div",{className:"text-sm text-gray-600",children:["Requires: ",t.required_skill]})]})]}),e.jsxs("div",{className:"pt-2 border-t border-gray-200",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Pay Rate:"})," $",(Number(t.pay_rate)||0).toFixed(2),"/hour"]}),t.uniform_name&&e.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[e.jsx("span",{className:"font-medium",children:"Uniform:"})," ",t.uniform_name]})]}),t.notes&&e.jsx("div",{className:"pt-2 border-t border-gray-200",children:e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Notes:"}),e.jsx("div",{className:"mt-1 whitespace-pre-line",children:t.notes.split("Uniform:").map((l,m)=>m===0?l.trim():e.jsxs("div",{children:[e.jsx("br",{}),e.jsx("span",{className:"font-medium",children:"Uniform:"})," ",l.trim()]},m))})]})})]})]})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(fe,{size:32,className:"text-gray-400 mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Failed to load shift details"})]})}),e.jsxs("div",{className:"flex-1 flex flex-col",children:[e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsxs("div",{className:"relative",children:[e.jsx(ss,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:16}),e.jsx("input",{type:"text",placeholder:"Search workers...",value:_,onChange:l=>W(l.target.value),className:"w-full pl-9 pr-4 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-1 focus:ring-teal-500 focus:border-teal-500"})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:v?e.jsx("div",{className:"p-6 flex items-center justify-center h-full",children:e.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 rounded-lg p-5 shadow-sm w-full max-w-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx(fe,{size:20,className:"text-red-600"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-lg font-semibold text-red-900 mb-1",children:"âš ï¸ Scheduling Conflict"}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"This worker cannot be assigned due to a scheduling conflict"}),e.jsx("div",{className:"bg-white border border-red-200 rounded p-3 mt-3",children:e.jsx("div",{className:"text-sm text-red-800 font-mono",children:v.split(`
`).map((l,m)=>l.trim()===""?null:l.startsWith("â€¢")?e.jsxs("div",{className:"mt-1 flex items-start gap-2",children:[e.jsx("span",{className:"text-red-500",children:"â—"}),e.jsx("span",{className:"flex-1",children:l.replace("â€¢","").trim()})]},m):l.startsWith("Details:")?null:l.includes("conflicting shift")?e.jsx("div",{className:"mt-1 text-red-700 font-medium",children:l},m):e.jsx("div",{className:"text-gray-700",children:l},m))})})]})]})})}):i.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ue,{size:32,className:"text-gray-400 mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-gray-600",children:_?"No workers found matching your search":t!=null&&t.role_needed?`No workers found with "${t.role_needed}" skill`:"No available workers"}),(t==null?void 0:t.role_needed)&&!_&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:['Try adding "',t.role_needed,'" skill to workers or select a different shift.']})]}):e.jsx("ul",{children:i.map(l=>{const m=(B==null?void 0:B.id)===l.id,z=G[l.id]||Number(t.pay_rate)||0,V=G[l.id]&&G[l.id]!==(Number(t.pay_rate)||0);return e.jsxs("li",{className:`flex items-center justify-between px-4 py-3 border-b last:border-b-0 ${m?"bg-teal-50":"bg-white"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"w-8 h-8 rounded-full bg-teal-100 flex items-center justify-center text-teal-700 text-xs font-semibold",children:[l.first_name[0],l.last_name[0]]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[l.first_name," ",l.last_name]}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:(l.skills_json||[]).map((L,D)=>{const d=L===(t==null?void 0:t.role_needed);return e.jsx("span",{className:`px-2 py-0.5 text-xs rounded ${d?"bg-teal-100 text-teal-700 font-medium":"bg-gray-100 text-gray-600"}`,children:L},D)})})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[V&&e.jsx("span",{className:"text-xs text-amber-600 font-medium",children:"Custom"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ms,{className:"h-4 w-4 text-gray-400"}),e.jsx("input",{type:"number",step:"1",min:"0",placeholder:(Number(t.pay_rate)||0).toString(),value:z||"",onChange:L=>{const D=L.target.value;(D===""||/^\d*\.?\d*$/.test(D))&&T(l.id,parseFloat(D)||0)},className:"w-20 px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent",onMouseDown:L=>L.stopPropagation(),onFocus:L=>L.stopPropagation()}),e.jsx("span",{className:"text-xs text-gray-600",children:"/hr"})]}),e.jsx("button",{onClick:()=>K(l),className:`px-3 py-1.5 rounded-lg text-sm font-medium border ${m?"bg-teal-600 text-white border-teal-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:m?"Selected":"Select"})]})]},l.id)})})})]})]})})}function kt({isOpen:s,eventId:r,roleName:a,unfilledShiftIds:t,defaultPayRate:h,onClose:n,onDone:p}){const[i,x]=j.useState([]),[_,W]=j.useState([]),[B,K]=j.useState(""),[G,Z]=j.useState(!1),[b,H]=j.useState(!1),[C,R]=j.useState({}),[v,P]=j.useState(0),T=(g,l)=>{R(m=>({...m,[g]:l}))};j.useEffect(()=>{s&&(x([]),W([]),K(""),R({}),Z(!0),(async()=>{var g,l;try{const z=((g=(await se.get(`/events/${r}`)).data)==null?void 0:g.data)||{};console.log("QuickFill: Full event data:",JSON.stringify(z,null,2)),console.log("QuickFill: Looking for role:",a),console.log("QuickFill: shifts_by_role:",z.shifts_by_role);const V=new Set;if(z.shifts_by_role){const S=z.shifts_by_role.find(u=>(console.log("QuickFill: Checking role:",u.skill_name,u.role_name,"vs",a),u.skill_name===a||u.role_name===a));S?(console.log("QuickFill: Found role shifts:",S),S.shifts&&S.shifts.forEach(u=>{u.assignments&&(console.log("QuickFill: Shift has assignments:",u.assignments),u.assignments.forEach(f=>{var E;const $=f.worker_id||((E=f.worker)==null?void 0:E.id),y=f.status;$&&y!=="cancelled"&&(V.add($),console.log("QuickFill: Adding worker_id to exclude:",$,"status:",y))}))})):console.log("QuickFill: No role shifts found for:",a)}console.log(`QuickFill: Found ${V.size} already assigned worker IDs:`,Array.from(V));const L=await se.get("/workers?active=true"),d=(((l=L.data)==null?void 0:l.data)||L.data||[]).filter(S=>{const u=(S.skills_json||[]).includes(a),f=V.has(S.id);return f&&console.log(`QuickFill: Excluding ${S.first_name} ${S.last_name} (ID: ${S.id}) - already assigned`),u&&!f});if(console.log(`QuickFill: Found ${d.length} eligible workers for "${a}"`),console.log("QuickFill: Eligible workers:",d.map(S=>`${S.first_name} ${S.last_name}`)),x(d),h){const S=Number(h)||0;P(S),console.log(`QuickFill: Default pay rate for ${a}: $${S}/hr`)}else console.log(`QuickFill: No default pay rate provided for ${a}`)}catch(m){console.error("Error loading workers:",m)}finally{Z(!1)}})())},[s,r,a,h]);const F=j.useMemo(()=>{const g=B.trim().toLowerCase(),l=i;return g?l.filter(m=>`${m.first_name} ${m.last_name}`.toLowerCase().includes(g)||(m.email||"").toLowerCase().includes(g)):l},[i,B]),A=t.length,k=g=>{W(l=>l.includes(g)?l.filter(m=>m!==g):l.length>=A?l:[...l,g])},Y=async()=>{var z,V,L,D,d,S,u,f,$,y,E,q,ee,c,U;if(_.length===0||A===0)return;H(!0);let g=0,l=0;const m=[];try{const Q=_.map(pe=>i.find(Te=>Te.id===pe)).filter(Boolean),te=[...t];let oe=0;for(;te.length>0&&Q.length>0;){const pe=Q[oe%Q.length],Te=te.shift();try{const ge=C[pe.id]||Number(v)||0||0,Ne=await se.post("/staffing",{assignment:{shift_id:Te,worker_id:pe.id,status:"assigned",assigned_at_utc:new Date().toISOString(),hourly_rate:ge}});if(((z=Ne.data)==null?void 0:z.status)==="success")g+=1;else{l+=1;const me=`${pe.first_name} ${pe.last_name}`,$e=((V=Ne.data)==null?void 0:V.message)||((D=(L=Ne.data)==null?void 0:L.error)==null?void 0:D.message)||((S=(d=Ne.data)==null?void 0:d.errors)==null?void 0:S.join(", "))||"Unknown error";let ae="Unable to assign";const o=String($e).toLowerCase();o.includes("overlapping")||o.includes("conflict")?ae="Has overlapping shift":o.includes("capacity")||o.includes("full")?ae="Shift is full":o.includes("skill")||o.includes("certification")||o.includes("requirement")?ae="Missing required skill":o.includes("status")?ae="Cannot be assigned":ae="Unable to assign",m.push(`${me}: ${ae}`)}}catch(ge){l+=1;const Ne=`${pe.first_name} ${pe.last_name}`;let me="Unable to assign";const $e=((f=(u=ge.response)==null?void 0:u.data)==null?void 0:f.message)||((E=(y=($=ge.response)==null?void 0:$.data)==null?void 0:y.error)==null?void 0:E.message)||((c=(ee=(q=ge.response)==null?void 0:q.data)==null?void 0:ee.errors)==null?void 0:c.join(", "))||null;if($e){const ae=String($e).toLowerCase();ae.includes("overlapping")||ae.includes("conflict")?me="Has overlapping shift":ae.includes("capacity")||ae.includes("full")?me="Shift is full":ae.includes("skill")||ae.includes("certification")||ae.includes("requirement")?me="Missing required skill":ae.includes("status")?me="Cannot be assigned":me="Unable to assign"}else((U=ge.response)==null?void 0:U.status)===422?me="Unable to assign":ge.message&&!ge.message.includes("status code")&&(me=ge.message);m.push(`${Ne}: ${me}`)}oe+=1}let je="";l>0&&m.length>0&&(je=m.join(", ")),p({assigned:g,conflicts:l,details:je})}finally{H(!1)}};if(!s)return null;const J=e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:n,disabled:b,className:"btn-secondary",children:"Cancel"}),e.jsx("button",{onClick:Y,disabled:b||_.length===0||A===0,className:"btn-primary",children:b?"Filling Shifts...":_.length===1?`Assign worker to ${A} shift${A!==1?"s":""}`:`Assign ${_.length} workers to ${A} shifts`})]});return e.jsxs(es,{isOpen:s,onClose:n,title:`Quick Fill â€” ${a}`,subtitle:`Unfilled shifts: ${A}`,size:"lg",footer:J,children:[e.jsxs("div",{className:"relative",children:[e.jsx(ss,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx("input",{value:B,onChange:g=>K(g.target.value),placeholder:"Search eligible workersâ€¦",className:"w-full pl-9 pr-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500"})]}),e.jsx("div",{className:"max-h-[340px] overflow-y-auto border border-gray-200 rounded-lg",children:G?e.jsx("div",{className:"p-6 text-center text-gray-500",children:"Loadingâ€¦"}):F.length===0?e.jsx("div",{className:"p-6 text-center text-gray-500",children:"No eligible workers"}):e.jsx("ul",{children:F.map(g=>{const l=_.includes(g.id);return e.jsxs("li",{className:`flex items-center justify-between px-4 py-3 border-b last:border-b-0 ${l?"bg-teal-50":"bg-white"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"w-8 h-8 rounded-full bg-teal-100 flex items-center justify-center text-teal-700 text-xs font-semibold",children:[g.first_name[0],g.last_name[0]]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[g.first_name," ",g.last_name]}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:(g.skills_json||[]).map((m,z)=>{const V=m===a;return e.jsx("span",{className:`px-2 py-0.5 text-xs rounded ${V?"bg-teal-100 text-teal-700 font-medium":"bg-gray-100 text-gray-600"}`,children:m},z)})})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[C[g.id]&&C[g.id]!==(Number(v)||0)&&e.jsx("span",{className:"text-xs text-amber-600 font-medium",children:"Custom"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ms,{className:"h-4 w-4 text-gray-400"}),e.jsx("input",{type:"number",step:"1",min:"0",placeholder:Number(v)?(Number(v)||0).toString():"Rate",value:C[g.id]||Number(v)||0||"",onChange:m=>{const z=m.target.value;(z===""||/^\d*\.?\d*$/.test(z))&&T(g.id,parseFloat(z)||0)},className:"w-20 px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent",onMouseDown:m=>m.stopPropagation(),onFocus:m=>m.stopPropagation()}),e.jsx("span",{className:"text-xs text-gray-600",children:"/hr"})]}),e.jsx("button",{onClick:()=>k(g.id),disabled:!l&&_.length>=A,className:`px-3 py-1.5 rounded-lg text-sm font-medium border ${l?"bg-teal-600 text-white border-teal-600":_.length>=A?"bg-gray-100 text-gray-400 border-gray-200 cursor-not-allowed":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:l?"Selected":"Select"})]})]},g.id)})})}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[e.jsx(Fs,{size:16,className:"text-teal-600"}),e.jsxs("span",{children:["Will assign ",e.jsx("strong",{children:_.length})," worker",_.length!==1?"s":""," to ",e.jsx("strong",{children:A})," shift",A!==1?"s":"","."]})]}),(Number(v)||0)>0&&e.jsxs("div",{className:"border-t pt-4 mt-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-gray-600",children:["Default rate for ",a,":"]}),e.jsxs("span",{className:"font-medium",children:["$",(Number(v)||0).toFixed(2),"/hr"]})]}),Object.keys(C).length>0&&e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["ðŸ’¡ Empty fields will use default rate ($",(Number(v)||0).toFixed(2),"/hr)"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[e.jsx(Ss,{size:14,className:"text-yellow-600"}),"Conflicts and already-filled shifts will be skipped automatically."]})]})}function _t({event:s,isOpen:r,onClose:a,onSuccess:t}){var d,S;const h=ds(),[n,p]=j.useState(!1),[i,x]=j.useState([]),[_,W]=j.useState(!1),[B,K]=j.useState(!1),[G,Z]=j.useState(null),[b,H]=j.useState(null),[C,R]=j.useState({isVisible:!1,message:"",type:"error"}),[v,P]=j.useState(null),[T,F]=j.useState(!1);j.useEffect(()=>{r&&s.id&&A()},[r,s.id]);const A=async()=>{K(!0);try{const u=await se.get(`/events/${s.id}`);u.data.status==="success"&&Z(u.data.data)}catch(u){console.error("Failed to load full event details:",u),Z(s)}finally{K(!1)}},k=()=>{a(),h(`/events/${s.id}/edit`)},Y=[{name:"Bartender",icon:zs},{name:"Banquet Server/Runner",icon:Es},{name:"Captain",icon:Ls},{name:"Event Helper",icon:Ps},{name:"Prep Cook",icon:Ts}],J=G||s,g=G||s;j.useEffect(()=>{if(J){if(J.skill_requirements&&Array.isArray(J.skill_requirements)){const u=J.skill_requirements.map(f=>{var E,q;const $=(E=J.shifts_by_role)==null?void 0:E.find(ee=>(ee.skill_name||ee.role_name)===f.skill_name),y=((q=$==null?void 0:$.shifts)==null?void 0:q.length)||($==null?void 0:$.total_shifts)||f.needed_workers||1;return{skill_name:f.skill_name,needed_workers:y,pay_rate:f.pay_rate||15,description:f.description||"",uniform_id:void 0,cert_id:void 0}});x(u)}else if(J.shifts_by_role&&Array.isArray(J.shifts_by_role)){const u=J.shifts_by_role.map(f=>{const $=f.shifts?f.shifts.length:f.total_shifts||1;return{skill_name:f.skill_name||f.role_name||"",needed_workers:$,pay_rate:f.pay_rate||15,description:"",uniform_id:void 0,cert_id:void 0}});x(u)}}},[J]),j.useEffect(()=>{const u=G||s;u!=null&&u.schedule&&P({start_time_utc:u.schedule.start_time_utc,end_time_utc:u.schedule.end_time_utc,break_minutes:u.schedule.break_minutes||0})},[G,s]);const l=(u,f,$)=>{if(u<0||u>=i.length)return;const y=[...i];y[u]={...y[u],[f]:$},x(y)},m=()=>{x([...i,{skill_name:"",needed_workers:1,pay_rate:15,description:"",uniform_id:void 0,cert_id:void 0}])},z=u=>{var $;if(u<0||u>=i.length)return;const f=i[u];if((f==null?void 0:f.needed_workers)>0){const y=($=g==null?void 0:g.shifts_by_role)==null?void 0:$[u];if(((y==null?void 0:y.assigned_workers)||(y==null?void 0:y.filled_shifts)||0)>0){R({isVisible:!0,message:"Cannot remove role with assigned workers. Please unassign workers first.",type:"error"});return}}x(i.filter((y,E)=>E!==u))},V=(u,f)=>{if(u<0||u>=i.length)return;Y.find(y=>y.name===f);const $=[...i];$[u]={...$[u],skill_name:f},x($),H(null)},L=async()=>{var f,$,y;const u=G||s;if(u.schedule&&new Date(u.schedule.start_time_utc)<=new Date){R({isVisible:!0,message:"Cannot edit event that has already started",type:"error"});return}W(!0);try{const E=G||s,q=await se.patch(`/events/${E.id}`,{event:{roles:i.map(ee=>({skill_name:ee.skill_name,needed:ee.needed_workers,pay_rate:ee.pay_rate,description:ee.description,uniform_id:ee.uniform_id,cert_id:ee.cert_id})),schedule:v?{start_time_utc:v.start_time_utc,end_time_utc:v.end_time_utc,break_minutes:v.break_minutes}:E.schedule?{start_time_utc:E.schedule.start_time_utc,end_time_utc:E.schedule.end_time_utc,break_minutes:E.schedule.break_minutes||0}:void 0}});q.data.status==="success"?(R({isVisible:!0,message:q.data.message||"Event updated successfully",type:"success"}),t(),a()):R({isVisible:!0,message:q.data.message||"Failed to update event",type:"error"})}catch(E){console.error("Failed to update event:",E);const q=(f=E==null?void 0:E.response)==null?void 0:f.data;if((q==null?void 0:q.status)==="validation_error"&&((y=($=q==null?void 0:q.data)==null?void 0:$.conflicts)!=null&&y.length)){const ee=q.data.conflicts.map(c=>{const U=new Date(c.conflicting_shift_start_time_utc).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"}),Q=new Date(c.conflicting_shift_end_time_utc).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"});return`${c.worker_name} conflicts with ${c.conflicting_event_title} (${U} â€“ ${Q})`});R({isVisible:!0,message:`Can't save changes: ${ee.length} worker${ee.length!==1?"s":""} would be double-booked
â€¢ `+ee.join(`
â€¢ `),type:"error"})}else R({isVisible:!0,message:(q==null?void 0:q.message)||"Failed to update event",type:"error"})}finally{W(!1)}},D=e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:a,disabled:_,className:"btn-secondary",children:"Cancel"}),e.jsx("button",{onClick:L,disabled:_,className:"btn-primary",children:_?"Saving...":"Save Changes"})]});return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-0 sm:p-4 overflow-y-auto",children:e.jsxs("div",{className:"bg-white w-full h-full sm:h-auto sm:max-w-4xl sm:rounded-lg shadow-xl overflow-hidden flex flex-col sm:max-h-[90vh]",children:[e.jsxs("div",{className:"sticky top-0 bg-white px-4 sm:px-6 py-4 border-b border-gray-200 flex items-center justify-between z-10",children:[e.jsxs("h2",{className:"text-lg sm:text-xl md:text-2xl font-bold text-gray-900 truncate",children:["Edit Event: ",g.title]}),e.jsx("button",{onClick:a,className:"p-2 text-gray-400 hover:text-gray-600 min-h-touch min-w-touch","aria-label":"Close",children:e.jsx(Ce,{className:"h-5 w-5 sm:h-6 sm:w-6"})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto px-4 sm:px-6 py-4 space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 p-6 rounded-xl border border-gray-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-5",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"Event Details"}),e.jsxs("button",{onClick:k,className:"inline-flex items-center gap-1.5 px-3 py-1.5 bg-white border border-gray-300 text-sm font-medium text-gray-700 rounded-lg hover:bg-gray-50 hover:border-gray-400 transition-all shadow-sm",children:[e.jsx(us,{size:14}),"Edit"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:"Venue"}),e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:(d=g.venue)==null?void 0:d.name})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:"Date"}),e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:g.schedule&&new Date(g.schedule.start_time_utc).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric"})})]}),e.jsxs("div",{className:"space-y-1 md:col-span-2",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:"Location"}),e.jsx("p",{className:"text-sm font-semibold text-gray-900 leading-relaxed",children:(S=g.venue)==null?void 0:S.formatted_address})]}),e.jsxs("div",{className:"space-y-1 md:col-start-2",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:"Time"}),e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:g.schedule&&e.jsxs(e.Fragment,{children:[new Date(g.schedule.start_time_utc).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})," - ",new Date(g.schedule.end_time_utc).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})]})})]}),e.jsx("div",{})]})]}),e.jsxs("div",{className:"col-span-2 bg-gray-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 uppercase tracking-wide",children:"Event Schedule"}),e.jsx("button",{type:"button",onClick:()=>F(!T),className:"text-sm text-blue-600 hover:text-blue-800 font-medium",children:T?"Cancel":"Edit Schedule"})]}),T?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Start Time"}),e.jsx("input",{type:"datetime-local",value:v!=null&&v.start_time_utc?new Date(v.start_time_utc).toISOString().slice(0,16):"",onChange:u=>P(f=>f?{...f,start_time_utc:new Date(u.target.value).toISOString()}:null),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"End Time"}),e.jsx("input",{type:"datetime-local",value:v!=null&&v.end_time_utc?new Date(v.end_time_utc).toISOString().slice(0,16):"",onChange:u=>P(f=>f?{...f,end_time_utc:new Date(u.target.value).toISOString()}:null),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Break Minutes"}),e.jsx("input",{type:"number",min:"0",value:(v==null?void 0:v.break_minutes)||0,onChange:u=>P(f=>f?{...f,break_minutes:parseInt(u.target.value)||0}:null),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm"})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-3",children:e.jsx("p",{className:"text-xs text-blue-800",children:"âš ï¸ Changing schedule times will update ALL shifts and worker schedules for this event."})})]}):e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Date"}),e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:g.schedule&&new Date(g.schedule.start_time_utc).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric"})})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Time"}),e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:v&&e.jsxs(e.Fragment,{children:[new Date(v.start_time_utc).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})," -",new Date(v.end_time_utc).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})]})})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Break"}),e.jsxs("p",{className:"text-sm font-semibold text-gray-900",children:[(v==null?void 0:v.break_minutes)||0," minutes"]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-base font-semibold text-gray-900",children:"Roles"}),e.jsxs("button",{onClick:m,className:"inline-flex items-center gap-2 px-4 py-2 bg-teal-600 text-white text-sm font-semibold rounded-lg hover:bg-teal-700 transition-colors shadow-sm",children:[e.jsx(qe,{size:16}),"Add Role"]})]}),i.map((u,f)=>{var $;return e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start gap-4 mb-3",children:[e.jsxs("div",{className:"flex-1 relative overflow-visible",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Role Name *"}),e.jsxs("div",{className:"relative",style:{zIndex:b===f?1e3:1},children:[e.jsxs("button",{type:"button",onClick:()=>H(b===f?null:f),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500 bg-white text-left flex items-center justify-between",children:[u.skill_name?e.jsxs("div",{className:"flex items-center gap-2",children:[(($=Y.find(y=>y.name===u.skill_name))==null?void 0:$.icon)&&e.jsx("img",{src:Y.find(y=>y.name===u.skill_name).icon,alt:u.skill_name,className:"w-5 h-5"}),e.jsx("span",{className:"text-gray-900",children:u.skill_name})]}):e.jsx("span",{className:"text-gray-400",children:"Pick the Skills the Worker Has"}),e.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{d:"M19 9l-7 7-7-7"})})]}),b===f&&e.jsx("div",{className:"absolute top-full left-0 right-0 mt-2 bg-white border-2 border-gray-200 rounded-xl shadow-2xl z-[9999] max-h-[300px] overflow-y-auto w-full min-w-max",children:Y.filter(y=>!i.some((E,q)=>q!==f&&E.skill_name===y.name)).map(y=>e.jsxs("div",{onClick:()=>V(f,y.name),className:"flex items-center gap-3 px-4 py-3 cursor-pointer hover:bg-teal-50 border-b border-gray-100 last:border-0",children:[e.jsx("img",{src:y.icon,width:"24",height:"24",alt:y.name,className:"flex-shrink-0"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:y.name})]},y.name))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Needed Workers *"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>l(f,"needed_workers",Math.max(1,u.needed_workers-1)),className:"w-8 h-8 flex items-center justify-center border border-gray-300 bg-white hover:bg-gray-50 rounded-lg transition-colors font-semibold text-gray-700",children:"-"}),e.jsx("input",{type:"number",value:u.needed_workers,onChange:y=>l(f,"needed_workers",parseInt(y.target.value)||1),min:"1",className:"w-16 px-2 py-2 border border-gray-300 rounded-lg text-center focus:outline-none focus:ring-2 focus:ring-teal-500 font-medium"}),e.jsx("button",{onClick:()=>l(f,"needed_workers",u.needed_workers+1),className:"w-8 h-8 flex items-center justify-center border border-gray-300 bg-white hover:bg-gray-50 rounded-lg transition-colors font-semibold text-gray-700",children:"+"}),e.jsx("button",{onClick:()=>z(f),className:"ml-2 w-8 h-8 flex items-center justify-center text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Remove role",children:e.jsx(De,{size:18})})]})]})]}),(()=>{var q;const y=(q=g==null?void 0:g.shifts_by_role)==null?void 0:q[f],E=(y==null?void 0:y.assigned_workers)||(y==null?void 0:y.filled_shifts)||0;return E>0?e.jsxs("div",{className:"text-sm text-amber-600 font-semibold bg-amber-50 px-3 py-2 rounded-lg",children:[E," worker(s) assigned"]}):null})()]},f)})]})]}),e.jsx("div",{className:"sticky bottom-0 bg-white px-4 sm:px-6 py-4 border-t border-gray-200 flex flex-col sm:flex-row gap-3 sm:justify-end z-10",children:D})]})}),e.jsx(ts,{isVisible:C.isVisible,message:C.message,type:C.type,onClose:()=>R({...C,isVisible:!1})})]})}function Ct({assignment:s,isEditing:r,editHours:a,isSavingEdit:t,wasApprovedBeforeEdit:h,onStartEdit:n,onSaveEdit:p,onCancelEdit:i,onEditHoursChange:x,onEditKeyDown:_,calculateLiveTotal:W,onNoShow:B,onRemove:K,onReEdit:G}){const[Z,b]=j.useState(!1),H=l=>{if(!l)return"N/A";try{const m=he(l);return ye(m,"MMM d, yyyy h:mm a")}catch{try{return new Date(l).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"})}catch{return"N/A"}}},C=l=>{const m=["bg-blue-500","bg-green-500","bg-purple-500","bg-pink-500","bg-orange-500","bg-teal-500","bg-indigo-500","bg-cyan-500"];if(!l)return m[0];const z=l.charCodeAt(0)||0;return m[z%m.length]},R=l=>{if(!l)return"??";const m=l.trim().split(" ");return m.length===1?m[0].substring(0,2).toUpperCase():(m[0][0]+m[m.length-1][0]).toUpperCase()},v=l=>{if(!l)return"";try{const m=he(l);return ye(m,"h:mm a")}catch{return new Date(l).toLocaleString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}},P=()=>{const l=s.actual_start||s.scheduled_start,m=s.actual_end||s.scheduled_end;return!l||!m?"Not set":`${v(l)} - ${v(m)}`},T=()=>{const l=s.actual_start||s.scheduled_start,m=s.actual_end||s.scheduled_end;if(!l||!m)return 0;try{const z=he(l),D=(he(m).getTime()-z.getTime())/(1e3*60*60);return Math.round(D*10)/10}catch{return 0}},F=l=>{const m=parseFloat(a)||0,z=Math.max(0,Math.min(24,m+l));x(z.toFixed(2))},A=s.approved,k=R(s.worker_name),Y=C(s.worker_name),J=P(),g=T();return e.jsxs(e.Fragment,{children:[e.jsxs("tr",{className:Me("hidden sm:table-row group transition-all duration-150 ease-in-out border-b",A&&!r&&"bg-green-50/30 hover:bg-green-50/50",!A&&!r&&s.status==="no_show"&&"bg-red-50/30",!A&&!r&&s.status==="cancelled"&&"bg-gray-50/30",!A&&!r&&"bg-white hover:bg-gray-50",r&&"bg-blue-50"),onMouseEnter:()=>b(!0),onMouseLeave:()=>b(!1),children:[e.jsx("td",{className:"py-4 px-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:Me("h-9 w-9 rounded-full flex items-center justify-center text-white font-semibold text-sm flex-shrink-0",Y),children:k}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"font-medium text-gray-900 truncate",children:s.worker_name}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Scheduled: ",re(s.scheduled_hours,2,"0.00"),"h"]}),A&&!r&&s.approved_by_name&&e.jsxs("div",{className:"mt-1 text-xs text-green-700 font-medium",children:["Approved by ",s.approved_by_name.split("@")[0]," on"," ",s.approved_at?H(s.approved_at):"N/A"]})]})]})}),e.jsx("td",{className:"py-4 px-3 text-sm text-gray-700",children:s.shift_role||"N/A"}),e.jsx("td",{className:"py-4 px-3",children:e.jsxs("div",{className:"flex items-center gap-1.5 text-sm text-gray-700",children:[e.jsx(we,{className:"h-3.5 w-3.5 text-gray-400 flex-shrink-0"}),e.jsx("span",{className:"whitespace-nowrap",children:J})]})}),e.jsxs("td",{className:"py-4 px-3 text-sm font-medium text-gray-900 text-right",children:[re(s.effective_hours,2,"0.00"),"h",s.edited_at&&e.jsx("span",{className:"ml-1 text-xs text-orange-600",title:"Edited",children:e.jsx(Se,{className:"h-3 w-3 inline"})})]}),e.jsxs("td",{className:"py-4 px-3 text-sm text-gray-700 text-right",children:["$",re(s.effective_hourly_rate,2,"0.00"),"/h"]}),e.jsxs("td",{className:"py-4 px-3 text-sm font-semibold text-gray-900 text-right",children:["$",re(s.effective_pay,2,"0.00")]}),e.jsx("td",{className:"py-4 text-right",children:r?e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium text-blue-700 bg-blue-100 rounded",children:[e.jsx(Se,{className:"h-3.5 w-3.5"}),"Editing"]}):e.jsx("div",{className:"flex items-center justify-end gap-2",children:s.status==="no_show"?e.jsx(e.Fragment,{children:e.jsxs("span",{className:"inline-flex items-center gap-1 text-xs font-medium text-red-700",children:[e.jsx(ns,{className:"h-3.5 w-3.5"}),"No-Show"]})}):s.status==="cancelled"?e.jsx(e.Fragment,{children:e.jsxs("span",{className:"inline-flex items-center gap-1 text-xs font-medium text-gray-700",children:[e.jsx(Ce,{className:"h-3.5 w-3.5"}),"Cancelled"]})}):e.jsxs("div",{className:"flex items-center justify-end gap-3",children:[A?e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium text-green-700 bg-green-100 rounded flex-shrink-0",children:[e.jsx(_e,{className:"h-3.5 w-3.5"}),"Approved"]}):e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium text-amber-700 bg-amber-100 rounded flex-shrink-0",children:[e.jsx(we,{className:"h-3.5 w-3.5"}),"Pending"]}),s.can_edit_hours&&e.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>A?G(s):n(s),className:"p-1.5 text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors",title:A?"Re-edit":"Edit",children:e.jsx(Se,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>B(s),className:"p-1.5 text-gray-600 hover:text-orange-600 hover:bg-orange-50 rounded transition-colors",title:"No-Show",children:e.jsx(fe,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>K(s),className:"p-1.5 text-gray-600 hover:text-red-600 hover:bg-red-50 rounded transition-colors",title:"Remove",children:e.jsx(De,{className:"h-4 w-4"})})]})]})})})]}),r&&e.jsx("tr",{className:"bg-blue-50",children:e.jsx("td",{colSpan:7,className:"px-3 py-0",children:e.jsx("div",{className:"overflow-hidden transition-all duration-300 ease-in-out",children:e.jsx("div",{className:"py-4",children:e.jsxs("div",{className:"bg-white border-2 border-blue-400 rounded-lg p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Se,{className:"h-4 w-4 text-blue-600"}),e.jsx("h4",{className:"text-sm font-semibold text-gray-900",children:"Edit Hours Worked"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg flex items-center gap-2 text-sm",children:[e.jsx(we,{className:"h-4 w-4 text-gray-500 flex-shrink-0"}),e.jsxs("span",{className:"text-gray-700",children:[e.jsx("strong",{children:"Shift:"})," ",J]}),g>0&&e.jsxs("span",{className:"text-gray-500",children:["(",g," hour shift)"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:"Hours Worked"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>F(-1),disabled:t,className:"p-2 border border-gray-300 rounded hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",type:"button",title:"Decrease by 1 hour",children:e.jsx(Is,{className:"h-4 w-4"})}),e.jsx("input",{type:"number",step:"0.25",min:"0",max:"24",value:a,onChange:l=>x(l.target.value),onKeyDown:_,disabled:t,className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg text-center text-lg font-semibold focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100",placeholder:"0.0",autoFocus:!0}),e.jsx("button",{onClick:()=>F(1),disabled:t,className:"p-2 border border-gray-300 rounded hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",type:"button",title:"Increase by 1 hour",children:e.jsx(qe,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-gray-600",children:"Quick adjust:"}),e.jsx("button",{onClick:()=>F(-1),disabled:t,className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-50 disabled:opacity-50 transition-colors",children:"-1h"}),e.jsx("button",{onClick:()=>F(-.5),disabled:t,className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-50 disabled:opacity-50 transition-colors",children:"-0.5h"}),e.jsx("button",{onClick:()=>F(.5),disabled:t,className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-50 disabled:opacity-50 transition-colors",children:"+0.5h"}),e.jsx("button",{onClick:()=>F(1),disabled:t,className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-50 disabled:opacity-50 transition-colors",children:"+1h"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Updated Total"}),e.jsxs("div",{className:"text-lg font-bold text-blue-600",children:["$",W(a,s.effective_hourly_rate||0)]})]}),h&&e.jsxs("div",{className:"flex items-start gap-2 p-3 bg-amber-50 border border-amber-200 rounded-lg",children:[e.jsx(fe,{className:"h-4 w-4 text-amber-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-xs text-amber-800",children:[e.jsx("strong",{children:"Note:"})," Re-editing will un-approve these hours."]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>{B(s),i()},disabled:t,className:"px-3 py-2 text-sm text-orange-700 bg-orange-50 border border-orange-200 rounded hover:bg-orange-100 flex items-center gap-1.5 disabled:opacity-50 transition-colors",children:[e.jsx(fe,{className:"h-4 w-4"}),"No-Show"]}),e.jsxs("button",{onClick:()=>{K(s),i()},disabled:t,className:"px-3 py-2 text-sm text-red-700 bg-red-50 border border-red-200 rounded hover:bg-red-100 flex items-center gap-1.5 disabled:opacity-50 transition-colors",children:[e.jsx(De,{className:"h-4 w-4"}),"Remove"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:i,disabled:t,className:"px-4 py-2 text-sm font-medium text-gray-700 hover:text-gray-900 disabled:opacity-50",children:"Cancel"}),e.jsx("button",{onClick:p,disabled:t,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium rounded-lg flex items-center gap-2 disabled:bg-blue-400 transition-colors",children:t?e.jsxs(e.Fragment,{children:[e.jsx(Ke,{className:"h-4 w-4 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(_e,{className:"h-4 w-4"}),"Save Changes"]})})]})]})]})]})})})})}),e.jsx("tr",{className:"sm:hidden",children:e.jsx("td",{colSpan:7,className:"py-3 px-3",children:e.jsxs("div",{className:Me("p-3 rounded-lg space-y-2 transition-all duration-150",r&&"bg-blue-50 border-2 border-blue-500",!r&&A&&"bg-green-50 border border-green-200",!r&&s.status==="no_show"&&"bg-red-50 border border-red-200",!r&&s.status==="cancelled"&&"bg-gray-50 border border-gray-200",!r&&"bg-white border border-gray-200"),children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:Me("h-8 w-8 rounded-full flex items-center justify-center text-white font-semibold text-xs flex-shrink-0",Y),children:k}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium text-gray-900 truncate",children:s.worker_name}),e.jsx("div",{className:"text-xs text-gray-500",children:s.shift_role||"N/A"})]})]}),e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-gray-600 mt-1 ml-10",children:[e.jsx(we,{className:"h-3 w-3 text-gray-400 flex-shrink-0"}),e.jsx("span",{children:J})]}),A&&!r&&s.approved_by_name&&e.jsxs("div",{className:"text-xs text-green-700 mt-1 ml-10 font-medium",children:["Approved by ",s.approved_by_name.split("@")[0]," on"," ",s.approved_at?H(s.approved_at):"N/A"]})]}),s.approved?e.jsxs("span",{className:"inline-flex items-center gap-1 text-xs font-medium text-green-700",children:[e.jsx(_e,{className:"h-3.5 w-3.5"}),"Approved"]}):s.status==="no_show"?e.jsxs("span",{className:"inline-flex items-center gap-1 text-xs font-medium text-red-700",children:[e.jsx(ns,{className:"h-3.5 w-3.5"}),"No-Show"]}):s.status==="cancelled"?e.jsxs("span",{className:"inline-flex items-center gap-1 text-xs font-medium text-gray-700",children:[e.jsx(Ce,{className:"h-3.5 w-3.5"}),"Cancelled"]}):e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium text-amber-700 bg-amber-50 rounded",children:[e.jsx(we,{className:"h-3.5 w-3.5"}),"Pending"]})]}),r&&e.jsx("div",{className:"pt-2 border-t border-gray-200",children:e.jsxs("div",{className:"bg-white border-2 border-blue-400 rounded-lg p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Se,{className:"h-4 w-4 text-blue-600"}),e.jsx("h4",{className:"text-sm font-semibold text-gray-900",children:"Edit Hours Worked"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Hours Worked"}),e.jsx("input",{type:"number",step:"0.25",min:"0",max:"24",value:a,onChange:l=>x(l.target.value),onKeyDown:_,disabled:t,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100",autoFocus:!0})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Updated Total"}),e.jsxs("div",{className:"text-lg font-bold text-blue-600",children:["$",W(a,s.effective_hourly_rate||0)]})]}),h&&e.jsxs("div",{className:"flex items-start gap-2 p-3 bg-amber-50 border border-amber-200 rounded-lg",children:[e.jsx(fe,{className:"h-4 w-4 text-amber-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-xs text-amber-800",children:[e.jsx("strong",{children:"Note:"})," Re-editing will un-approve these hours."]})]}),e.jsxs("div",{className:"flex gap-2 pt-2 border-t",children:[e.jsx("button",{onClick:i,disabled:t,className:"flex-1 px-3 py-2 text-sm font-medium text-gray-700 hover:text-gray-900 disabled:opacity-50",children:"Cancel"}),e.jsx("button",{onClick:p,disabled:t,className:"flex-1 px-3 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium rounded-lg flex items-center justify-center gap-2 disabled:bg-blue-400",children:t?e.jsxs(e.Fragment,{children:[e.jsx(Ke,{className:"h-4 w-4 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(_e,{className:"h-4 w-4"}),"Save Changes"]})})]})]})]})}),!r&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-sm pt-2 border-t border-gray-200",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Hours"}),e.jsxs("div",{className:"font-medium",children:[re(s.effective_hours,2,"0.00"),"h",s.edited_at&&e.jsx("span",{className:"ml-1 text-xs text-orange-600",title:"Edited",children:e.jsx(Se,{className:"h-3 w-3 inline"})})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Rate"}),e.jsxs("div",{className:"font-medium",children:["$",re(s.effective_hourly_rate,2,"0.00"),"/h"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Total"}),e.jsxs("div",{className:"font-semibold",children:["$",re(s.effective_pay,2,"0.00")]})]})]}),s.can_edit_hours&&s.status!=="no_show"&&s.status!=="cancelled"&&e.jsx("div",{className:"flex items-center gap-2 pt-2 border-t border-gray-200",children:s.approved?e.jsx("button",{onClick:()=>G(s),className:"w-full px-3 py-1.5 text-xs font-medium text-gray-700 bg-gray-100 rounded hover:bg-gray-200 transition-colors",children:"Re-edit"}):e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>n(s),className:"flex-1 px-3 py-1.5 text-xs font-medium text-blue-700 bg-blue-50 rounded hover:bg-blue-100 transition-colors flex items-center justify-center gap-1",children:[e.jsx(Se,{className:"h-3.5 w-3.5"}),"Edit"]}),e.jsxs("button",{onClick:()=>B(s),className:"flex-1 px-3 py-1.5 text-xs font-medium text-orange-700 bg-orange-50 rounded hover:bg-orange-100 transition-colors flex items-center justify-center gap-1",children:[e.jsx(fe,{className:"h-3.5 w-3.5"}),"No-Show"]}),e.jsx("button",{onClick:()=>K(s),className:"px-3 py-1.5 text-xs font-medium text-red-700 bg-red-50 rounded hover:bg-red-100 transition-colors",children:e.jsx(De,{className:"h-3.5 w-3.5"})})]})})]})]})})})]})}function St({event:s,isOpen:r,onClose:a,onSuccess:t}){const[h,n]=j.useState([]),[p,i]=j.useState(null),[x,_]=j.useState(!1),[W,B]=j.useState(null),[K,G]=j.useState(""),[Z,b]=j.useState(!1),[H,C]=j.useState(!1),[R,v]=j.useState(!1),[P,T]=j.useState({isVisible:!1,message:"",type:"success"}),[F,A]=j.useState({open:!1,title:"",variant:"default"});j.useEffect(()=>{r&&s&&k()},[r,s]);const k=async()=>{var c,U;if(s!=null&&s.id){_(!0);try{const Q=await se.get(`/events/${s.id}/approvals`);n(Q.data.data.assignments||[]),i(Q.data.data.cost_summary||null)}catch(Q){console.error("Error loading assignments:",Q),T({isVisible:!0,type:"error",message:((U=(c=Q.response)==null?void 0:c.data)==null?void 0:U.error)||Q.message||"Unable to load assignments for approval"}),n([]),i(null)}finally{_(!1)}}},Y=c=>{B(c.id),G(String(c.effective_hours||c.hours_worked||c.scheduled_hours||"0")),C(!1)},J=()=>{B(null),G(""),C(!1)},g=async()=>{var U,Q,te;if(!W)return;const c=parseFloat(K);if(isNaN(c)||c<0){T({isVisible:!0,type:"error",message:"Please enter a valid number of hours"});return}if(c>24){T({isVisible:!0,type:"error",message:"Hours cannot exceed 24 per shift"});return}b(!0);try{const oe=await se.patch(`/approvals/${W}/update_hours`,{hours_worked:c});await k(),J(),(U=oe.data)!=null&&U.message?T({isVisible:!0,type:"success",message:oe.data.message}):T({isVisible:!0,type:"success",message:"Hours updated successfully"})}catch(oe){console.error("Error updating hours:",oe),T({isVisible:!0,type:"error",message:((te=(Q=oe.response)==null?void 0:Q.data)==null?void 0:te.message)||"Failed to update hours. Please try again."})}finally{b(!1)}},l=c=>{c.key==="Enter"?(c.preventDefault(),g()):c.key==="Escape"&&(c.preventDefault(),J())},m=(c,U)=>{const Q=parseFloat(c);return isNaN(Q)?"0.00":(Q*U).toFixed(2)},z=c=>{A({open:!0,title:"Re-Edit Approved Hours",message:`Re-editing will un-approve ${c.worker_name}'s hours. The assignment will need to be re-approved after you make changes. Continue?`,variant:"warning",onConfirm:async()=>{A({open:!1,title:""}),B(c.id),G(String(c.effective_hours||c.hours_worked||c.scheduled_hours||"0")),C(!0),T({isVisible:!0,type:"success",message:"Hours un-approved. Make your changes and save."})}})},V=async c=>{A({open:!0,title:"Mark No-Show",message:`Mark ${c.worker_name} as no-show? This will set hours to 0.`,requireNote:!0,note:"",variant:"warning",onConfirm:async()=>{var U,Q;try{await se.post(`/approvals/${c.id}/mark_no_show`,{notes:F.note}),await k(),T({isVisible:!0,type:"success",message:"Marked as no-show"})}catch(te){console.error("Error marking no-show:",te),T({isVisible:!0,type:"error",message:((Q=(U=te.response)==null?void 0:U.data)==null?void 0:Q.message)||"Failed to mark no-show"})}finally{A({open:!1,title:""})}}})},L=async c=>{A({open:!0,title:"Remove from Job",message:`Remove ${c.worker_name} from this job? This cannot be undone.`,requireNote:!0,note:"",variant:"danger",onConfirm:async()=>{var U,Q;try{await se.delete(`/approvals/${c.id}/remove`,{data:{notes:F.note}}),await k(),T({isVisible:!0,type:"success",message:"Assignment removed"})}catch(te){console.error("Error removing assignment:",te),T({isVisible:!0,type:"error",message:((Q=(U=te.response)==null?void 0:U.data)==null?void 0:Q.message)||"Failed to remove assignment"})}finally{A({open:!1,title:""})}}})},D=async()=>{const c=h.filter(U=>!U.approved&&U.can_approve&&U.status!=="no_show").length;A({open:!0,title:"Approve All Hours",message:`Approve hours for all ${c} eligible workers?`,onConfirm:async()=>{var U,Q;v(!0);try{await se.post(`/events/${s.id}/approve_all`),await k(),t(),T({isVisible:!0,type:"success",message:`Approved ${c} assignments`})}catch(te){console.error("Error approving all:",te),T({isVisible:!0,type:"error",message:((Q=(U=te.response)==null?void 0:U.data)==null?void 0:Q.message)||"Failed to approve all hours"})}finally{v(!1),A({open:!1,title:""})}}})};if(!r)return null;const d=h.filter(c=>c.status!=="no_show"&&c.status!=="cancelled"),S=d.filter(c=>!c.approved).length,u=d.filter(c=>c.approved).length,f=d.length,$=d.filter(c=>!c.approved).reduce((c,U)=>c+Number(U.effective_pay||0),0),y=d.filter(c=>c.approved).reduce((c,U)=>c+Number(U.effective_pay||0),0),E=$+y,q=d.reduce((c,U)=>c+Number(U.effective_hours||0),0),ee=c=>{if(!c)return"";try{return ye(he(c),"MMM d, yyyy")}catch{return new Date(c).toLocaleDateString()}};return e.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-0 sm:p-4 overflow-y-auto",children:[e.jsx(ts,{isVisible:P.isVisible,message:P.message,type:P.type,onClose:()=>T({...P,isVisible:!1})}),e.jsxs("div",{className:"bg-white w-full h-full sm:h-auto sm:max-w-5xl sm:rounded-lg shadow-xl overflow-hidden flex flex-col sm:max-h-[90vh] my-0 sm:my-4",children:[e.jsx("header",{className:"border-b px-6 py-4 bg-white flex-shrink-0",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Approve Hours"}),e.jsxs("p",{className:"text-sm text-gray-500 mt-0.5",children:[s==null?void 0:s.title," Â· ",s!=null&&s.event_date?ee(s.event_date):""]})]}),e.jsx("button",{onClick:a,className:"text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Close modal",children:e.jsx(Ce,{className:"h-5 w-5"})})]})}),S>0&&e.jsx("div",{className:"bg-amber-50 border-l-4 border-amber-400 px-6 py-3 flex-shrink-0",children:e.jsxs("p",{className:"text-sm text-amber-800 flex items-center gap-2",children:[e.jsx(fe,{className:"h-4 w-4"}),e.jsx("strong",{children:S})," ",S===1?"assignment":"assignments"," pending approval"]})}),e.jsx("div",{className:"flex-1 overflow-auto px-3 sm:px-6 py-4",children:x?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading assignments..."})]}):h.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(fe,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"No assignments found for this event."})]}):e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"border-b border-gray-200 hidden sm:table-header-group",children:e.jsxs("tr",{className:"text-left",children:[e.jsx("th",{className:"pb-3 text-xs font-medium text-gray-500 uppercase tracking-wider w-[25%]",children:"Worker"}),e.jsx("th",{className:"pb-3 text-xs font-medium text-gray-500 uppercase tracking-wider w-[15%]",children:"Role"}),e.jsx("th",{className:"pb-3 text-xs font-medium text-gray-500 uppercase tracking-wider w-[18%]",children:"Time Worked"}),e.jsx("th",{className:"pb-3 text-xs font-medium text-gray-500 uppercase tracking-wider text-right w-[10%]",children:"Hours"}),e.jsx("th",{className:"pb-3 text-xs font-medium text-gray-500 uppercase tracking-wider text-right w-[10%]",children:"Rate"}),e.jsx("th",{className:"pb-3 text-xs font-medium text-gray-500 uppercase tracking-wider text-right w-[12%]",children:"Total"}),e.jsx("th",{className:"pb-3 text-xs font-medium text-gray-500 uppercase tracking-wider text-right w-[10%]",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:h.map(c=>e.jsx(Ct,{assignment:c,isEditing:W===c.id,editHours:K,isSavingEdit:Z,wasApprovedBeforeEdit:H,onStartEdit:Y,onSaveEdit:g,onCancelEdit:J,onEditHoursChange:G,onEditKeyDown:l,calculateLiveTotal:m,onNoShow:V,onRemove:L,onReEdit:z},c.id))})]})}),e.jsxs("footer",{className:"border-t bg-gray-50 px-3 sm:px-6 py-4 flex-shrink-0",children:[S>0&&u>0?e.jsxs("div",{className:"mb-4 space-y-1.5 text-sm",children:[e.jsxs("div",{className:"flex justify-between text-gray-600",children:[e.jsx("span",{children:"Pending approval:"}),e.jsxs("span",{className:"font-medium",children:["$",re($,2,"0.00")," (",S," ",S===1?"worker":"workers",")"]})]}),e.jsxs("div",{className:"flex justify-between text-gray-600",children:[e.jsx("span",{children:"Approved:"}),e.jsxs("span",{className:"font-medium",children:["$",re(y,2,"0.00")," (",u," ",u===1?"worker":"workers",")"]})]}),e.jsxs("div",{className:"pt-2 border-t border-gray-200 flex justify-between text-gray-900",children:[e.jsx("span",{className:"font-semibold",children:"Total:"}),e.jsxs("span",{className:"font-semibold",children:["$",re(E,2,"0.00")," (",f," workers, ",re(q,2,"0.00"),"h)"]})]})]}):S===0&&u>0?e.jsxs("div",{className:"mb-4 flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Final approved cost:"}),e.jsxs("span",{className:"text-lg font-bold text-green-600",children:["$",re(y,2,"0.00")]})]}):e.jsxs("div",{className:"mb-4 flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Total cost:"}),e.jsxs("span",{className:"text-lg font-bold text-gray-900",children:["$",re(E,2,"0.00")," (",f," workers, ",re(q,2,"0.00"),"h)"]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center justify-end gap-3",children:[e.jsx("button",{onClick:a,className:"px-4 py-2 text-sm font-medium text-gray-700 hover:text-gray-900 transition-all duration-200 ease-in-out",children:"Close"}),S>0&&e.jsx("button",{onClick:D,disabled:R,className:"px-4 py-2 bg-green-600 hover:bg-green-700 disabled:bg-green-400 text-white text-sm font-medium rounded-lg shadow-sm flex items-center justify-center gap-2 transition-all duration-200 ease-in-out",children:R?e.jsxs(e.Fragment,{children:[e.jsx(Ke,{className:"h-4 w-4 animate-spin"}),"Approving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(_e,{className:"h-4 w-4"}),"Approve All (",S,")"]})})]})]})]}),F.open&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>A({open:!1,title:""})}),e.jsxs("div",{className:"relative bg-white w-full max-w-md rounded-lg shadow-xl p-5",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:F.title}),F.message&&e.jsx("p",{className:"mt-2 text-sm text-gray-700",children:F.message}),F.requireNote&&e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Notes (optional)"}),e.jsx("textarea",{value:F.note||"",onChange:c=>A(U=>({...U,note:c.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:3})]}),e.jsxs("div",{className:"mt-5 flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>A({open:!1,title:""}),className:"px-4 py-2 bg-gray-100 text-gray-700 text-sm font-medium rounded-md hover:bg-gray-200",children:"Cancel"}),e.jsx("button",{onClick:async()=>{var c;await((c=F.onConfirm)==null?void 0:c.call(F))},className:"px-4 py-2 text-white text-sm font-medium rounded-md "+(F.variant==="danger"?"bg-red-600 hover:bg-red-700":F.variant==="warning"?"bg-yellow-600 hover:bg-yellow-700":"bg-blue-600 hover:bg-blue-700"),children:"Confirm"})]})]})]})]})}function xe({className:s="",count:r=1}){return e.jsx(e.Fragment,{children:Array.from({length:r}).map((a,t)=>e.jsx("div",{className:`animate-pulse bg-gray-200 rounded-lg ${s}`},t))})}function Je(){return e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(xe,{className:"h-6 w-48 mb-2"}),e.jsx(xe,{className:"h-4 w-32"})]}),e.jsx(xe,{className:"h-8 w-8 rounded-full"})]}),e.jsxs("div",{className:"space-y-3 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(xe,{className:"h-4 w-4 rounded"}),e.jsx(xe,{className:"h-4 w-40"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(xe,{className:"h-4 w-4 rounded"}),e.jsx(xe,{className:"h-4 w-36"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(xe,{className:"h-4 w-4 rounded"}),e.jsx(xe,{className:"h-4 w-32"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(xe,{className:"h-2 w-full rounded-full mb-2"}),e.jsx(xe,{className:"h-3 w-24"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(xe,{className:"h-9 w-24 rounded-md"}),e.jsx(xe,{className:"h-9 w-24 rounded-md"})]})]})})}function At(s,r=500){const[a,t]=j.useState(s);return j.useEffect(()=>{const h=setTimeout(()=>{t(s)},r);return()=>{clearTimeout(h)}},[s,r]),a}function Kt(){const s=ds(),[r,a]=Ms(),t=(r.get("tab")==="completed"?"completed":r.get("tab"))||"active",h=r.get("filter")||"needs_workers",[n,p]=j.useState(t),[i,x]=j.useState(h),[_,W]=j.useState(""),B=At(_,500),[K,G]=j.useState("date"),[Z,b]=j.useState(!0),[H,C]=j.useState([]),[R,v]=j.useState(new Set),[P,T]=j.useState(new Set),[F,A]=j.useState({isOpen:!1}),[k,Y]=j.useState({isOpen:!1}),[J,g]=j.useState({isVisible:!1,message:"",type:"success"}),[l,m]=j.useState({isOpen:!1,isLoading:!1}),[z,V]=j.useState({isOpen:!1,isLoading:!1}),[L,D]=j.useState({isOpen:!1,isLoading:!1}),[d,S]=j.useState({isOpen:!1,unfilledShiftIds:[]}),[u,f]=j.useState({isOpen:!1});j.useEffect(()=>{$()},[n,i,r]),j.useEffect(()=>{const o=(r.get("tab")==="completed"?"completed":r.get("tab"))||"active",M=r.get("filter")||"all";o!==n&&p(o),M!==i&&x(M)},[r,n,i]),j.useEffect(()=>{const o=r.get("event_id"),M=r.get("shift_id");if(o){const I=parseInt(o);isNaN(I)||(v(new Set([I])),M&&console.log(`Auto-expanding event ${I} with shift ${M}`))}},[r]),j.useEffect(()=>{const o=r.get("event_id");if(!o)return;const M=parseInt(o);if(isNaN(M))return;const I=H.find(X=>X.id===M);I&&(!I.shifts_by_role||I.shifts_by_role.length===0)&&(q(M),v(new Set([M])))},[r,H]);async function $(){b(!0);try{const o=n==="completed"?"completed":n,M=r.get("date");let I=`/events?tab=${o}`;i!=="all"&&(I+=`&filter=${i}`),M&&(I+=`&date=${M}`),console.log("Loading events with URL:",I,"filterStatus:",i,"date:",M);const X=await se.get(I);if(X.data.status==="success"){console.log("Received events:",X.data.data.length);const ie=X.data.data;if(n==="completed"){const ce=await Promise.all(ie.map(async de=>{var be;try{const ne=await se.get(`/events/${de.id}/approvals`);if(((be=ne.data)==null?void 0:be.status)==="success"){const ue=ne.data.data.assignments||[],Fe=ue.length,ze=ue.filter(Cs=>Cs.approved).length,_s=ne.data.data.cost_summary||null;return{...de,approval_status:{total:Fe,approved:ze,pending:Fe-ze},cost_summary:_s}}}catch(ne){console.warn(`Failed to load approval status for event ${de.id}:`,ne)}return de}));C(ce)}else{const ce=Array.from(R);C(de=>{const be=new Map(de.map(ne=>[ne.id,ne]));return ie.map(ne=>{const ue=be.get(ne.id);return ce.includes(ne.id)&&(ue!=null&&ue.shifts_by_role)&&ue.shifts_by_role.length>0?{...ne,shifts_by_role:ue.shifts_by_role,full_details:ue.full_details||ue}:ne})}),ce.length>0&&Promise.all(ce.map(de=>q(de))).catch(de=>{console.error("Failed to refresh expanded event details:",de)})}}}catch(o){console.error("Failed to load events:",o)}finally{b(!1)}}const y=o=>{p(o),a({tab:o}),x(o==="active"?"needs_workers":"all")},E=o=>{x(o);const M=new URLSearchParams;M.set("tab",n),o!=="all"&&M.set("filter",o),a(M)},q=async o=>{var M,I;T(X=>new Set(X).add(o));try{const[X,ie]=await Promise.all([se.get(`/events/${o}`),se.get(`/events/${o}/approvals`).catch(()=>null)]);if(((M=X.data)==null?void 0:M.status)==="success"){const ce=X.data.data;if(((I=ie==null?void 0:ie.data)==null?void 0:I.status)==="success"){const de=ie.data.data.assignments||[],be=new Map(de.map(ne=>[ne.id,ne]));ce.shifts_by_role&&(ce.shifts_by_role=ce.shifts_by_role.map(ne=>({...ne,shifts:ne.shifts.map(ue=>({...ue,assignments:ue.assignments.map(Fe=>{const ze=be.get(Fe.id);return ze&&typeof ze=="object"?{...Fe,...ze}:Fe})}))})))}C(de=>de.map(be=>be.id===o?{...be,...ce}:be))}}catch(X){console.error("Failed to load event details",X)}finally{T(X=>{const ie=new Set(X);return ie.delete(o),ie})}},ee=o=>{const M=new Set(R);if(M.has(o))M.delete(o),T(I=>{const X=new Set(I);return X.delete(o),X});else{M.add(o);const I=H.find(ce=>ce.id===o),X=P.has(o),ie=(I==null?void 0:I.shifts_by_role)&&I.shifts_by_role.length>0;!X&&!ie&&q(o)}v(M)};async function c(o){const M=H==null?void 0:H.find(I=>I.id===o);D({isOpen:!0,isLoading:!1,eventId:o,eventTitle:M==null?void 0:M.title})}async function U(){if(L.eventId){D(o=>({...o,isLoading:!0}));try{const o=await se.delete(`/events/${L.eventId}`);o.data.status==="success"?(D({isOpen:!1,isLoading:!1}),g({isVisible:!0,message:`"${o.data.event_title}" moved to trash`,type:"success",action:{label:"Undo",onClick:()=>Q(o.data.event_id),variant:"primary"}}),$()):g({isVisible:!0,message:o.data.message||"Unable to delete event",type:"error"})}catch(o){console.error("Failed to delete event:",o),g({isVisible:!0,message:"Unable to delete event",type:"error"})}finally{D(o=>({...o,isLoading:!1}))}}}async function Q(o){try{const M=await se.post(`/events/${o}/restore`);M.data.status==="success"?(g({isVisible:!0,message:"Event restored to draft",type:"success"}),$()):g({isVisible:!0,message:M.data.message||"Unable to restore event",type:"error"})}catch(M){console.error("Failed to restore event:",M),g({isVisible:!0,message:"Unable to restore event",type:"error"})}}function te(){D({isOpen:!1,isLoading:!1})}function oe(o){m({isOpen:!0,eventId:o,isLoading:!1})}async function je(){if(l.eventId){m(o=>({...o,isLoading:!0}));try{const o=await se.post(`/events/${l.eventId}/publish`);o.data.status==="success"?(g({isVisible:!0,message:"Event published successfully",type:"success"}),m({isOpen:!1,isLoading:!1}),$()):(g({isVisible:!0,message:o.data.message||"Unable to publish event",type:"error"}),m({isOpen:!1,isLoading:!1}))}catch(o){console.error("Failed to publish event:",o),g({isVisible:!0,message:"Unable to publish event",type:"error"}),m({isOpen:!1,isLoading:!1})}}}function pe(){m({isOpen:!1,isLoading:!1})}function Te(o,M){V({isOpen:!0,assignmentId:o,isLoading:!1,workerName:M})}async function ge(){var o,M;if(z.assignmentId){V(I=>({...I,isLoading:!0}));try{const I=await se.delete(`/staffing/${z.assignmentId}`);((o=I.data)==null?void 0:o.status)==="success"?(g({isVisible:!0,message:"Worker unassigned successfully",type:"success"}),V({isOpen:!1,isLoading:!1}),$()):(g({isVisible:!0,message:((M=I.data)==null?void 0:M.message)||"Unable to unassign worker",type:"error"}),V({isOpen:!1,isLoading:!1}))}catch(I){console.error("Failed to unassign worker:",I),g({isVisible:!0,message:"Unable to unassign worker",type:"error"}),V({isOpen:!1,isLoading:!1})}}}const Ne=o=>{Y({isOpen:!0,shiftId:o})},me=()=>{Y({isOpen:!1})},$e=()=>{me(),g({isVisible:!0,message:"Worker assigned",type:"success"}),$()},ae=H.filter(o=>{var M;if(B){const I=B.toLowerCase();if(!(o.title.toLowerCase().includes(I)||((M=o.venue)==null?void 0:M.name.toLowerCase().includes(I))))return!1}if(n==="active")switch(i){case"needs_workers":return o.unfilled_roles_count>0;case"partially_filled":return o.unfilled_roles_count>0&&o.assigned_workers_count>0;case"fully_staffed":return o.unfilled_roles_count===0&&o.assigned_workers_count>0;case"all":default:return!0}return!0}).sort((o,M)=>{var I,X;switch(K){case"name":return o.title.localeCompare(M.title);case"staffing":return o.staffing_percentage-M.staffing_percentage;case"date":default:const ie=((I=o.schedule)==null?void 0:I.start_time_utc)||o.created_at,ce=((X=M.schedule)==null?void 0:X.start_time_utc)||M.created_at;return new Date(ie).getTime()-new Date(ce).getTime()}});return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-2",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-900",children:"Events"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Manage events and assign workers"})]}),e.jsxs("button",{onClick:()=>s("/events/create"),className:"w-full sm:w-auto inline-flex items-center justify-center gap-2 px-4 py-2 bg-teal-600 text-white font-medium rounded-lg hover:bg-teal-700 transition-colors shadow-sm min-h-touch",children:[e.jsx(qe,{size:20}),"Create New Event"]})]}),r.get("date")&&e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-teal-50 border border-teal-200 rounded-lg",children:[e.jsx(He,{size:16,className:"text-teal-600"}),e.jsxs("span",{className:"text-sm font-medium text-teal-900",children:["Showing events for ",ye(he(r.get("date")),"EEEE, MMMM d, yyyy")]}),e.jsx("button",{onClick:()=>{const o=new URLSearchParams(r);o.delete("date"),a(o)},className:"ml-auto text-teal-600 hover:text-teal-700",title:"Clear date filter",children:e.jsx(Ce,{size:16})})]})]}),e.jsxs("div",{className:"flex gap-6 border-b border-gray-200 mb-6",children:[e.jsx("button",{onClick:()=>y("draft"),className:`pb-3 px-1 font-medium transition-colors border-b-2 ${n==="draft"?"border-teal-600 text-teal-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Draft Events"}),e.jsx("button",{onClick:()=>y("active"),className:`pb-3 px-1 font-medium transition-colors border-b-2 ${n==="active"?"border-teal-600 text-teal-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Active Events"}),e.jsx("button",{onClick:()=>y("completed"),className:`pb-3 px-1 font-medium transition-colors border-b-2 ${n==="completed"?"border-teal-600 text-teal-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Completed Events"})]}),e.jsxs("div",{className:"flex flex-col md:flex-row items-stretch md:items-center gap-3 sm:gap-4 mb-6",children:[e.jsxs("div",{className:"w-full md:flex-1 md:max-w-md relative",children:[e.jsx(ss,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),e.jsx("input",{type:"text",placeholder:"Search events or venues...",value:_,onChange:o=>W(o.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent"})]}),e.jsxs("select",{value:K,onChange:o=>G(o.target.value),className:"w-full sm:w-auto px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500 bg-white",children:[e.jsx("option",{value:"date",children:"Sort by Date"}),e.jsx("option",{value:"name",children:"Sort by Name"}),n!=="draft"&&e.jsx("option",{value:"staffing",children:"Sort by Staffing"})]}),n==="active"&&e.jsxs("div",{className:"w-full sm:w-auto flex flex-wrap gap-2",children:[e.jsx("button",{onClick:()=>E("all"),className:`w-full sm:w-auto px-3 py-2 text-sm font-medium rounded-lg transition ${i==="all"?"bg-gray-100 text-gray-700":"bg-white text-gray-600 hover:bg-gray-50 border border-gray-300"}`,children:"All"}),e.jsx("button",{onClick:()=>E("needs_workers"),className:`w-full sm:w-auto px-3 py-2 text-sm font-medium rounded-lg transition ${i==="needs_workers"?"bg-red-100 text-red-700":"bg-white text-gray-600 hover:bg-gray-50 border border-gray-300"}`,children:"Needs Workers"}),e.jsx("button",{onClick:()=>E("fully_staffed"),className:`w-full sm:w-auto px-3 py-2 text-sm font-medium rounded-lg transition ${i==="fully_staffed"?"bg-green-100 text-green-700":"bg-white text-gray-600 hover:bg-gray-50 border border-gray-300"}`,children:"Ready"})]})]}),Z?e.jsxs("div",{className:"space-y-4",children:[e.jsx(Je,{}),e.jsx(Je,{}),e.jsx(Je,{})]}):e.jsxs(e.Fragment,{children:[n==="draft"&&e.jsx(Mt,{events:ae,onDelete:c,onPublish:oe,onNavigate:o=>s(o),searchQuery:_}),n==="active"&&e.jsx($t,{events:ae,expandedEvents:R,loadingEventDetails:P,onToggleEvent:ee,onAssignWorker:Ne,onUnassign:Te,onQuickFill:(o,M,I,X)=>S({isOpen:!0,eventId:o,roleName:M,unfilledShiftIds:I,payRate:X}),onPublish:oe,onDelete:c,onEdit:o=>f({isOpen:!0,event:o}),searchQuery:_}),n==="completed"&&e.jsx(Ft,{events:ae,searchQuery:_,onApproveHours:o=>A({isOpen:!0,event:o})})]})]}),k.isOpen&&k.shiftId&&e.jsx(Nt,{shiftId:k.shiftId,onClose:me,onSuccess:$e}),e.jsx(ts,{isVisible:J.isVisible,message:J.message,type:J.type,action:J.action,onClose:()=>g({...J,isVisible:!1})}),e.jsx(Be,{isOpen:l.isOpen,onClose:pe,onConfirm:je,title:"Publish Event",message:"Ready to publish? This will create shifts and make them available for worker assignment.",confirmText:l.isLoading?"Publishingâ€¦":"Publish",cancelText:"Cancel",isLoading:l.isLoading,isDestructive:!1}),e.jsx(Be,{isOpen:z.isOpen,onClose:()=>V({isOpen:!1,isLoading:!1}),onConfirm:ge,title:"Unassign Worker",message:`Remove ${z.workerName||"this worker"} from this shift?`,confirmText:z.isLoading?"Removingâ€¦":"Unassign",cancelText:"Cancel",isLoading:z.isLoading,isDestructive:!0}),e.jsx(Be,{isOpen:L.isOpen,onClose:te,onConfirm:U,title:"Delete Event",message:`Delete "${L.eventTitle}"? This action cannot be undone.`,confirmText:L.isLoading?"Deletingâ€¦":"Delete",cancelText:"Cancel",isLoading:L.isLoading,isDestructive:!0}),e.jsx(kt,{isOpen:d.isOpen,eventId:d.eventId||0,roleName:d.roleName||"",unfilledShiftIds:d.unfilledShiftIds,defaultPayRate:d.payRate,onClose:()=>S({isOpen:!1,unfilledShiftIds:[]}),onDone:({assigned:o,conflicts:M,details:I})=>{S({isOpen:!1,unfilledShiftIds:[]});let X=`Assigned ${o} workers â€¢ ${M} skipped`;M>0&&I&&(X+=`: ${I}`),g({isVisible:!0,message:X,type:M>0?"error":"success"}),$()}}),u.event&&e.jsx(_t,{event:u.event,isOpen:u.isOpen,onClose:()=>f({isOpen:!1,event:void 0}),onSuccess:()=>{$(),f({isOpen:!1,event:void 0})}}),F.isOpen&&F.event&&e.jsx(St,{event:F.event,isOpen:F.isOpen,onClose:()=>{A({isOpen:!1}),$()},onSuccess:()=>{$(),A({isOpen:!1})}})]})}function Mt({events:s,onDelete:r,onPublish:a,onNavigate:t,searchQuery:h}){const n=i=>{if(!i)return"No date set";const x=he(i);return ye(x,"MMM d, yyyy")},p=i=>{if(!i)return"";const x=he(i);return ye(x,"h:mm a")};return s.length===0?e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ“…"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:h?"No draft events found":"No draft events yet"}),e.jsx("p",{className:"text-gray-600 mb-6",children:h?"Try adjusting your search query":"Create your first event to get started"}),!h&&e.jsxs("button",{onClick:()=>t("/events/create"),className:"inline-flex items-center gap-2 px-4 py-2 bg-teal-600 text-white font-medium rounded-lg hover:bg-teal-700 transition-colors",children:[e.jsx(qe,{size:20}),"Create Event"]})]}):e.jsxs("div",{className:"space-y-4",children:[s.length>0&&e.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4 mb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ue,{className:"h-5 w-5 text-gray-600"}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[s.length," Event",s.length!==1?"s":""," Today"]}),e.jsxs("p",{className:"text-xs text-gray-700",children:[s.reduce((i,x)=>i+(x.assigned_workers_count||0),0),"/",s.reduce((i,x)=>i+(x.total_workers_needed||0),0)," workers hired"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:s.reduce((i,x)=>i+(x.assigned_workers_count||0),0)}),e.jsx("p",{className:"text-xs text-gray-700",children:"hired"})]})]})}),s.map(i=>{var x;return e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 hover:shadow-md transition-shadow",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:[i.title,i.schedule&&e.jsxs("span",{className:"ml-2 text-sm font-normal text-gray-600",children:["â€¢ ",p(i.schedule.start_time_utc),"â€“",p(i.schedule.end_time_utc)]})]})}),e.jsx("span",{className:"px-2.5 py-1 bg-gray-100 text-gray-700 text-xs font-medium rounded-full",children:"Draft"})]}),i.venue&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 mb-2",children:[e.jsx(We,{size:16,className:"text-gray-400 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:((x=i.venue)==null?void 0:x.name)||"No venue"})]}),i.schedule&&e.jsx("div",{className:"flex items-center gap-4 text-sm text-gray-600 mb-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(He,{size:16,className:"text-gray-400 flex-shrink-0"}),e.jsx("span",{children:n(i.schedule.start_time_utc)})]})}),i.total_workers_needed>0&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(Ue,{size:16,className:"text-gray-400"}),e.jsxs("span",{children:[i.total_workers_needed," workers needed"]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{onClick:()=>t(`/events/${i.id}/edit`),className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition",title:"Edit",children:e.jsx(us,{size:18})})})]})})},i.id)})]})}function $t({events:s,expandedEvents:r,loadingEventDetails:a,onToggleEvent:t,onAssignWorker:h,onUnassign:n,onQuickFill:p,onPublish:i,onDelete:x,onEdit:_,searchQuery:W}){const B=b=>{const H=he(b);return ye(H,"EEE, MMM d, yyyy")},K=b=>{const H=he(b);return ye(H,"h:mm a")},G=b=>{if(!b.schedule)return!1;const C=(he(b.schedule.start_time_utc).getTime()-new Date().getTime())/(1e3*60*60);return C>0&&C<=48},Z=b=>{switch(b){case"fully_staffed":return e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 bg-green-100 text-green-700 text-xs font-medium rounded-full",children:[e.jsx(_e,{size:14}),"Ready"]});case"partially_staffed":return e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 bg-yellow-100 text-yellow-700 text-xs font-medium rounded-full",children:[e.jsx(fe,{size:14}),"Partial"]});case"needs_workers":return e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 bg-red-100 text-red-700 text-xs font-medium rounded-full",children:[e.jsx(Ce,{size:14}),"Needs Workers"]});default:return null}};return s.length===0?e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ“…"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:W?"No active events found":"No active events"}),e.jsx("p",{className:"text-gray-600",children:W?"Try adjusting your search query or filters":"Publish draft events to see them here"})]}):e.jsx("div",{className:"space-y-4",children:s.map(b=>{const H=r.has(b.id);return e.jsxs("div",{className:"border border-gray-200 rounded-lg p-5 hover:border-gray-300 hover:shadow-sm transition-all",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-1 truncate",children:b.title}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600 flex-wrap",children:[b.schedule&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(He,{className:"h-4 w-4 flex-shrink-0"}),B(b.schedule.start_time_utc)]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(we,{className:"h-4 w-4 flex-shrink-0"}),K(b.schedule.start_time_utc)," - ",K(b.schedule.end_time_utc),G(b)&&e.jsx("span",{className:"bg-red-600 text-white text-xs font-semibold px-2 py-0.5 rounded-full ml-2","aria-label":"Urgent: starts within 48 hours",children:"Urgent"})]})]}),b.venue&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(We,{className:"h-4 w-4 flex-shrink-0"}),b.venue.name]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0 ml-4",children:[Z(b.staffing_status),_&&b.status==="published"&&e.jsx("button",{onClick:C=>{C.stopPropagation(),_(b)},title:"Edit Event",className:"p-1.5 text-teal-600 hover:text-teal-700 hover:bg-teal-50 rounded transition-colors",children:e.jsx(Vs,{size:14})}),x&&e.jsx("button",{onClick:C=>{C.stopPropagation(),x(b.id)},title:"Delete",className:"p-1.5 text-red-600 hover:text-red-700 hover:bg-red-50 rounded transition-colors",children:e.jsx(De,{size:14})}),e.jsx("button",{onClick:()=>t(b.id),className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:H?e.jsx(As,{size:20,className:"text-gray-600"}):e.jsx(Rs,{size:20,className:"text-gray-600"})})]})]}),e.jsx("div",{className:"py-3 border-y border-gray-100 space-y-2",children:(()=>{const C=b.assigned_workers_count||0,R=b.total_workers_needed||0,v=R>0?Math.round(C/R*100):0,P=b.unfilled_roles_count||0,T=(()=>{const k=b.estimated_cost??b.total_cost??b.total_pay_amount??0;return re(k,2,"0.00")})(),F=()=>v>=100?"bg-green-500":v>=75?"bg-amber-500":v>=50?"bg-orange-500":"bg-red-500",A=()=>v>=100?"text-green-600":v>=75?"text-amber-600":"text-red-600";return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700 whitespace-nowrap",children:[C," of ",R," roles filled"]}),e.jsx("div",{className:"flex-1 h-2 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:Me("h-full rounded-full transition-all duration-300",F()),style:{width:`${v}%`}})}),e.jsxs("span",{className:"text-sm font-semibold text-gray-900 whitespace-nowrap",children:[v,"%"]})]}),P>0&&e.jsxs("div",{className:Me("flex items-center gap-2 text-sm font-medium",A()),children:[e.jsx(fe,{className:"h-4 w-4"}),P," ",P===1?"role":"roles"," still need workers"]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("span",{children:"Est. Cost: "}),e.jsxs("span",{className:"font-semibold text-gray-900",children:["$",T]})]})]})})()}),H&&e.jsx("div",{className:"border-t border-gray-200 bg-gray-50 px-6 py-4",children:a.has(b.id)?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 border-4 border-teal-600 border-t-transparent rounded-full animate-spin"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Loading assignments..."})]})}):b.shifts_by_role&&b.shifts_by_role.length>0?e.jsx("div",{className:"space-y-4",children:b.shifts_by_role.map(C=>e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:C.role_name}),e.jsxs("span",{className:"text-sm text-gray-600",children:[C.filled_shifts,"/",C.total_shifts," hired"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[C.filled_shifts<C.total_shifts&&e.jsxs("span",{className:"px-2.5 py-1 bg-red-100 text-red-700 text-xs font-medium rounded-full",children:[C.total_shifts-C.filled_shifts," needed"]}),C.filled_shifts<C.total_shifts&&e.jsx("button",{onClick:R=>{var T;R.stopPropagation();const v=C.shifts.filter(F=>F.staffing_progress.percentage<100).sort((F,A)=>new Date(F.start_time_utc).getTime()-new Date(A.start_time_utc).getTime()).map(F=>F.id),P=(T=C.shifts[0])==null?void 0:T.pay_rate;p(b.id,C.role_name,v,P)},className:"px-2.5 py-1 text-xs font-semibold bg-teal-600 text-white rounded hover:bg-teal-700",title:"Quick Fill by Skill",children:"Quick Fill by Skill"})]})]}),e.jsx("div",{className:"space-y-2",children:C.shifts.map((R,v)=>e.jsxs("div",{className:"flex items-center justify-between py-2 px-3 bg-gray-50 rounded border border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-6 h-6 bg-gray-200 text-gray-700 rounded-md flex items-center justify-center text-xs font-medium",children:v+1}),e.jsxs("span",{className:"text-sm text-gray-700",children:[K(R.start_time_utc)," - ",K(R.end_time_utc)]}),R.assignments.length>0&&e.jsx("div",{className:"flex items-center gap-1 flex-wrap",children:R.assignments.map(P=>{const T=`${P.worker.first_name} ${P.worker.last_name}`,F=Number(P.hourly_rate||R.pay_rate||0);return e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"bg-white text-black border border-gray-200 rounded-full px-2.5 py-1 text-sm font-medium shadow-sm max-w-[140px] truncate",title:`${T} â€¢ $${re(F,0,"0")}/hr`,children:T}),e.jsx("button",{onClick:A=>{A.stopPropagation(),n(P.id,T)},className:"w-5 h-5 flex items-center justify-center text-red-600 hover:text-red-700 hover:bg-red-50 rounded",title:"Unassign worker",children:e.jsx(Ce,{size:12})})]},P.id)})})]}),R.staffing_progress.percentage===100?e.jsxs("span",{className:"flex items-center gap-1.5 text-sm font-medium text-green-600",children:[e.jsx(_e,{size:16}),"Assigned"]}):e.jsx("button",{onClick:P=>{P.stopPropagation(),h(R.id)},className:"px-3 py-1.5 bg-teal-600 text-white text-sm font-medium rounded-lg hover:bg-teal-700 transition-colors",children:"Assign Worker"})]},R.id))})]},C.role_name))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-gray-500 mb-4",children:b.status==="draft"?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"font-medium",children:"This event is still in draft status"}),e.jsx("p",{className:"text-sm",children:"Publish the event to generate shifts and assign workers"})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"font-medium",children:"No shifts available"}),e.jsx("p",{className:"text-sm",children:"This event may not have any shifts generated yet"})]})}),e.jsx("div",{className:"flex items-center justify-center gap-3",children:b.status==="draft"&&e.jsx("button",{onClick:()=>i(b.id),className:"px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-colors",children:"Publish Event"})})]})})]},b.id)})})}function Ft({events:s,searchQuery:r,onApproveHours:a}){const t=n=>{const p=he(n);return ye(p,"MMM d, yyyy")},h=n=>{const p=he(n);return ye(p,"h:mm a")};return s.length===0?e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ“‹"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:r?"No past events found":"No past events yet"}),e.jsx("p",{className:"text-gray-600",children:r?"Try adjusting your search query":"Completed events will appear here"})]}):e.jsx("div",{className:"space-y-4",children:s.map(n=>{var i;const p=xs(n.total_hours??n.total_hours_worked??0);return e.jsxs("div",{className:"border border-gray-200 rounded-lg p-5 hover:border-gray-300 hover:shadow-sm transition-all",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-1 truncate",children:n.title}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600 flex-wrap",children:[n.schedule&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(He,{className:"h-4 w-4 flex-shrink-0"}),t(n.schedule.start_time_utc)]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(we,{className:"h-4 w-4 flex-shrink-0"}),h(n.schedule.start_time_utc)," - ",h(n.schedule.end_time_utc)]})]}),n.venue&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(We,{className:"h-4 w-4 flex-shrink-0"}),n.venue.name]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0 ml-4",children:[e.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-gray-100 text-gray-700 rounded",children:"Completed"}),n.approval_status&&n.approval_status.pending>0&&e.jsxs("span",{className:"px-2 py-1 text-xs font-medium bg-amber-100 text-amber-700 rounded",children:[n.approval_status.pending," Pending"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4 py-3 border-y border-gray-100",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Workers"}),e.jsx("div",{className:"text-lg font-semibold text-gray-900",children:n.assigned_workers_count||0})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Hours"}),e.jsx("div",{className:"text-lg font-semibold text-gray-900",children:re(p,2,"0.00")})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Cost"}),e.jsxs("div",{className:"text-lg font-semibold text-gray-900",children:["$",(i=n.cost_summary)!=null&&i.total_estimated_cost?re(n.cost_summary.total_estimated_cost,2,"0.00"):n.total_pay_amount?re(n.total_pay_amount,2,"0.00"):"0.00"]}),n.approval_status&&n.approval_status.pending>0&&n.cost_summary&&e.jsxs("div",{className:"text-xs text-amber-600 font-medium mt-0.5",children:["$",re(n.cost_summary.pending_cost,2,"0.00")," pending"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Staffing"}),e.jsxs("div",{className:"text-lg font-semibold text-green-600",children:[n.staffing_percentage||100,"%"]})]})]}),e.jsx("div",{className:"mt-4 flex justify-end",children:a&&e.jsxs("button",{onClick:()=>a(n),className:Me("px-4 py-2 text-sm font-medium rounded-lg flex items-center gap-2 transition-colors shadow-sm",n.approval_status&&n.approval_status.pending>0?"bg-amber-600 hover:bg-amber-700 text-white":(n.approval_status&&n.approval_status.approved===n.approval_status.total,"bg-green-600 hover:bg-green-700 text-white")),children:[n.approval_status&&n.approval_status.pending>0?e.jsxs(e.Fragment,{children:[e.jsx(we,{className:"h-4 w-4"}),"Approve Hours (",n.approval_status.pending,")"]}):e.jsxs(e.Fragment,{children:[e.jsx(_e,{className:"h-4 w-4"}),"Approved"]}),e.jsx(Ds,{className:"h-4 w-4"})]})})]},n.id)})})}export{Kt as EventsPage};
