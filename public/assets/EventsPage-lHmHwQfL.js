import{c as Ne,j as e,a as R,C as le}from"./index-DgErDhqo.js";import{r as d,b as ve,f as _e}from"./vendor-D4VeuP1H.js";import{f as we,a as ae}from"./dateUtils-KEwN1iG-.js";import{X as B,T as ke}from"./Toast-WPW9kZUc.js";import{C as H,f as U}from"./index-CFmw6J46.js";import{M as X}from"./map-pin-DyNQfCS1.js";import{U as Y}from"./users-Dkn0hT7y.js";import{A as Z}from"./alert-circle-DQFe1qSO.js";import{S as G,A as Ce,C as K,T as ne}from"./ConfirmationModal-dxSAdtFm.js";import{D as oe}from"./dollar-sign-ZyC-i0-j.js";import{C as Se}from"./x-circle-CTv-0eIC.js";import{P as de}from"./plus-DB9hVmFh.js";import{C as ee}from"./calendar-DVWuI2mB.js";import{P as Fe}from"./pen-square-B_vHuxJ_.js";import{C as ce}from"./chevron-down-DnY7ECuD.js";import{p as V}from"./index-DTuWgi9J.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=Ne("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),Ee={sm:"max-w-md",md:"max-w-2xl",lg:"max-w-4xl",xl:"max-w-6xl"},ie=({isOpen:b,onClose:f,title:C,children:r,footer:$,size:x="md",closeOnOverlayClick:c=!0})=>{if(d.useEffect(()=>(b?document.body.classList.add("modal-open"):document.body.classList.remove("modal-open"),()=>{document.body.classList.remove("modal-open")}),[b]),d.useEffect(()=>{const v=g=>{g.key==="Escape"&&b&&f()};return document.addEventListener("keydown",v),()=>document.removeEventListener("keydown",v)},[b,f]),!b)return null;const i=v=>{v.target===v.currentTarget&&c&&f()};return e.jsx("div",{className:"modal-overlay",onClick:i,role:"dialog","aria-modal":"true","aria-labelledby":"modal-title",children:e.jsxs("div",{className:`modal-container ${Ee[x]}`,children:[e.jsx("div",{className:"modal-header",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{id:"modal-title",className:"text-xl font-semibold text-gray-900 font-manrope",children:C}),e.jsx("button",{onClick:f,className:"p-1 rounded-lg hover:bg-gray-100 transition-colors","aria-label":"Close modal",children:e.jsx(B,{size:20,className:"text-gray-500"})})]})}),e.jsx("div",{className:"modal-body",children:r}),$&&e.jsx("div",{className:"modal-footer",children:$})]})})};function $e({shiftId:b,onClose:f,onSuccess:C}){var l,m;const[r,$]=d.useState(null),[x,c]=d.useState([]),[i,v]=d.useState([]),[g,S]=d.useState(""),[h,a]=d.useState(null),[D,u]=d.useState({}),[j,P]=d.useState(!0),[p,z]=d.useState(!1),[y,O]=d.useState(null),I=(t,n)=>{u(_=>({..._,[t]:n}))};d.useEffect(()=>{w()},[b]),d.useEffect(()=>{r&&F()},[r]),d.useEffect(()=>{if(!g)v(x);else{const t=g.toLowerCase();v(x.filter(n=>{var _;return n.first_name.toLowerCase().includes(t)||n.last_name.toLowerCase().includes(t)||n.email.toLowerCase().includes(t)||((_=n.skills_json)==null?void 0:_.some(E=>E.toLowerCase().includes(t)))}))}},[g,x]);async function w(){try{const t=await R.get(`/shifts/${b}`);t.data.status==="success"?$(t.data.data):O("Failed to load shift details")}catch(t){console.error("Failed to load shift details:",t),O("Failed to load shift details")}}async function F(){try{const t=await R.get("/workers?active=true");if(t.data.status==="success"){const n=t.data.data.workers||t.data.data;if(r!=null&&r.role_needed){const _=n.filter(E=>{var k;return(k=E.skills_json)==null?void 0:k.includes(r.role_needed)});c(_)}else c(n)}else O("Failed to load workers")}catch(t){console.error("Failed to load workers:",t),O("Failed to load workers")}finally{P(!1)}}async function A(){var t,n,_,E,k,M;if(!(!h||!r)){z(!0),O(null);try{const T=(await R.post("/staffing",{assignment:{shift_id:r.id,worker_id:h.id,status:"assigned",assigned_at_utc:new Date().toISOString(),hourly_rate:D[h.id]||Number(r.pay_rate)||0}})).data;if(T.status==="success")C();else{let q=T.message||"Failed to assign worker";T.details&&T.details.length>0?q+=`

Details:
â€¢ `+T.details.join(`
â€¢ `):T.errors&&(q+=`

Details:
â€¢ `+T.errors.join(`
â€¢ `)),O(q)}}catch(L){console.error("Failed to assign worker:",L);let T="Failed to assign worker";(n=(t=L.response)==null?void 0:t.data)!=null&&n.details&&L.response.data.details.length>0?T+=`

Details:
â€¢ `+L.response.data.details.join(`
â€¢ `):(E=(_=L.response)==null?void 0:_.data)!=null&&E.errors?T+=`

Details:
â€¢ `+L.response.data.errors.join(`
â€¢ `):(M=(k=L.response)==null?void 0:k.data)!=null&&M.message?T=L.response.data.message:L.message&&(T=L.message),O(T)}finally{z(!1)}}}if(j)return e.jsx(ie,{isOpen:!0,onClose:f,title:"Assign Worker",size:"lg",children:e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-teal-600"})})});const W=e.jsxs(e.Fragment,{children:[y&&e.jsx("div",{className:"mb-3 p-2 bg-red-50 border border-red-200 rounded text-xs text-red-600",children:y.split(`
`).map((t,n)=>e.jsx("p",{className:t.startsWith("â€¢")?"ml-2":"",children:t},n))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:f,className:"flex-1 px-3 py-2 text-sm bg-gray-100 text-gray-700 font-medium rounded hover:bg-gray-200 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:A,disabled:!h||p,className:"flex-1 px-3 py-2 text-sm bg-teal-600 text-white font-medium rounded hover:bg-teal-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:p?"Assigning...":"Assign Worker"})]})]});return e.jsx(ie,{isOpen:!0,onClose:f,title:r?`${r.client_name} â€¢ ${r.role_needed}`:"Assign Worker",size:"xl",footer:W,children:e.jsxs("div",{className:"flex h-[600px]",children:[e.jsx("div",{className:"w-1/3 border-r border-gray-200 p-6 bg-gray-50",children:r?e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Shift Details"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(H,{size:16,className:"text-gray-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:we(r.start_time_utc)}),e.jsxs("div",{className:"text-sm text-gray-600",children:[ae(r.start_time_utc)," - ",ae(r.end_time_utc)]})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(X,{size:16,className:"text-gray-400 mt-0.5 flex-shrink-0"}),e.jsx("div",{className:"text-sm text-gray-900",children:r.location||((m=(l=r.event)==null?void 0:l.venue)==null?void 0:m.formatted_address)||"Location not specified"})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Y,{size:16,className:"text-gray-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-900",children:r.role_needed}),r.required_skill&&e.jsxs("div",{className:"text-sm text-gray-600",children:["Requires: ",r.required_skill]})]})]}),e.jsxs("div",{className:"pt-2 border-t border-gray-200",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Pay Rate:"})," $",(Number(r.pay_rate)||0).toFixed(2),"/hour"]}),r.uniform_name&&e.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[e.jsx("span",{className:"font-medium",children:"Uniform:"})," ",r.uniform_name]})]}),r.notes&&e.jsx("div",{className:"pt-2 border-t border-gray-200",children:e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Notes:"}),e.jsx("div",{className:"mt-1 whitespace-pre-line",children:r.notes.split("Uniform:").map((t,n)=>n===0?t.trim():e.jsxs("div",{children:[e.jsx("br",{}),e.jsx("span",{className:"font-medium",children:"Uniform:"})," ",t.trim()]},n))})]})})]})]})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Z,{size:32,className:"text-gray-400 mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Failed to load shift details"})]})}),e.jsxs("div",{className:"flex-1 flex flex-col",children:[e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsxs("div",{className:"relative",children:[e.jsx(G,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:16}),e.jsx("input",{type:"text",placeholder:"Search workers...",value:g,onChange:t=>S(t.target.value),className:"w-full pl-9 pr-4 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-1 focus:ring-teal-500 focus:border-teal-500"})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:y?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Z,{size:32,className:"text-red-400 mx-auto mb-2"}),e.jsx("div",{className:"text-sm text-red-600",children:y.split(`
`).map((t,n)=>e.jsx("p",{className:t.startsWith("â€¢")?"ml-2":"",children:t},n))})]}):i.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Y,{size:32,className:"text-gray-400 mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-gray-600",children:g?"No workers found matching your search":r!=null&&r.role_needed?`No workers found with "${r.role_needed}" skill`:"No available workers"}),(r==null?void 0:r.role_needed)&&!g&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:['Try adding "',r.role_needed,'" skill to workers or select a different shift.']})]}):e.jsx("ul",{children:i.map(t=>{const n=(h==null?void 0:h.id)===t.id,_=D[t.id]||Number(r.pay_rate)||0,E=D[t.id]&&D[t.id]!==(Number(r.pay_rate)||0);return e.jsxs("li",{className:`flex items-center justify-between px-4 py-3 border-b last:border-b-0 ${n?"bg-teal-50":"bg-white"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"w-8 h-8 rounded-full bg-teal-100 flex items-center justify-center text-teal-700 text-xs font-semibold",children:[t.first_name[0],t.last_name[0]]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[t.first_name," ",t.last_name]}),e.jsx("div",{className:"text-xs text-gray-600",children:(t.skills_json||[]).slice(0,3).join(", ")})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[E&&e.jsx("span",{className:"text-xs text-amber-600 font-medium",children:"Custom"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(oe,{className:"h-4 w-4 text-gray-400"}),e.jsx("input",{type:"number",step:"1",min:"0",placeholder:(Number(r.pay_rate)||0).toString(),value:_||"",onChange:k=>{const M=k.target.value;(M===""||/^\d*\.?\d*$/.test(M))&&I(t.id,parseFloat(M)||0)},className:"w-20 px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent",onMouseDown:k=>k.stopPropagation(),onFocus:k=>k.stopPropagation()}),e.jsx("span",{className:"text-xs text-gray-600",children:"/hr"})]}),e.jsx("button",{onClick:()=>a(t),className:`px-3 py-1.5 rounded-lg text-sm font-medium border ${n?"bg-teal-600 text-white border-teal-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:n?"Selected":"Select"})]})]},t.id)})})})]})]})})}function Le({isOpen:b,eventId:f,roleName:C,unfilledShiftIds:r,defaultPayRate:$,onClose:x,onDone:c}){const[i,v]=d.useState([]),[g,S]=d.useState([]),[h,a]=d.useState(""),[D,u]=d.useState(!1),[j,P]=d.useState(!1),[p,z]=d.useState({}),[y,O]=d.useState(0),I=(l,m)=>{z(t=>({...t,[l]:m}))};d.useEffect(()=>{b&&(v([]),S([]),a(""),z({}),u(!0),(async()=>{var l;try{const m=await R.get("/workers?active=true"),n=(((l=m.data)==null?void 0:l.data)||m.data||[]).filter(_=>(_.skills_json||[]).includes(C));if(console.log(`QuickFill: Found ${n.length} workers with skill "${C}"`),v(n),$){const _=Number($)||0;O(_),console.log(`QuickFill: Default pay rate for ${C}: $${_}/hr`)}else console.log(`QuickFill: No default pay rate provided for ${C}`)}catch(m){console.error("Error loading workers:",m)}finally{u(!1)}})())},[b,C,$]);const w=d.useMemo(()=>{const l=h.trim().toLowerCase(),m=i;return l?m.filter(t=>`${t.first_name} ${t.last_name}`.toLowerCase().includes(l)||(t.email||"").toLowerCase().includes(l)):m},[i,h]),F=r.length,A=l=>{S(m=>m.includes(l)?m.filter(t=>t!==l):m.length>=F?m:[...m,l])},W=async()=>{var t;if(g.length===0||F===0)return;P(!0);let l=0,m=0;try{const n=g.map(k=>i.find(M=>M.id===k)).filter(Boolean),_=[...r];let E=0;for(;_.length>0&&n.length>0;){const k=n[E%n.length],M=_.shift();try{const L=p[k.id]||Number(y)||0||0;((t=(await R.post("/staffing",{assignment:{shift_id:M,worker_id:k.id,status:"assigned",assigned_at_utc:new Date().toISOString(),hourly_rate:L}})).data)==null?void 0:t.status)==="success"?l+=1:m+=1}catch{m+=1}E+=1}c({assigned:l,conflicts:m})}finally{P(!1)}};return b?e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[10000] flex items-center justify-center p-4",onClick:l=>{l.target===l.currentTarget&&x()},children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-3xl w-full overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-5 border-b border-gray-100",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-bold text-gray-900",children:["Quick Fill â€” ",C]}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Unfilled shifts: ",F]})]}),e.jsx("button",{onClick:x,className:"w-8 h-8 rounded-lg hover:bg-gray-100 flex items-center justify-center text-gray-500",children:e.jsx(B,{size:18})})]}),e.jsxs("div",{className:"px-6 py-5 space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(G,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx("input",{value:h,onChange:l=>a(l.target.value),placeholder:"Search eligible workersâ€¦",className:"w-full pl-9 pr-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500"})]}),e.jsx("div",{className:"max-h-[340px] overflow-y-auto border border-gray-200 rounded-lg",children:D?e.jsx("div",{className:"p-6 text-center text-gray-500",children:"Loadingâ€¦"}):w.length===0?e.jsx("div",{className:"p-6 text-center text-gray-500",children:"No eligible workers"}):e.jsx("ul",{children:w.map(l=>{const m=g.includes(l.id);return e.jsxs("li",{className:`flex items-center justify-between px-4 py-3 border-b last:border-b-0 ${m?"bg-teal-50":"bg-white"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"w-8 h-8 rounded-full bg-teal-100 flex items-center justify-center text-teal-700 text-xs font-semibold",children:[l.first_name[0],l.last_name[0]]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[l.first_name," ",l.last_name]}),e.jsx("div",{className:"text-xs text-gray-600",children:(l.skills_json||[]).slice(0,3).join(", ")})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[p[l.id]&&p[l.id]!==(Number(y)||0)&&e.jsx("span",{className:"text-xs text-amber-600 font-medium",children:"Custom"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(oe,{className:"h-4 w-4 text-gray-400"}),e.jsx("input",{type:"number",step:"1",min:"0",placeholder:Number(y)?(Number(y)||0).toString():"Rate",value:p[l.id]||Number(y)||0||"",onChange:t=>{const n=t.target.value;(n===""||/^\d*\.?\d*$/.test(n))&&I(l.id,parseFloat(n)||0)},className:"w-20 px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent",onMouseDown:t=>t.stopPropagation(),onFocus:t=>t.stopPropagation()}),e.jsx("span",{className:"text-xs text-gray-600",children:"/hr"})]}),e.jsx("button",{onClick:()=>A(l.id),disabled:!m&&g.length>=F,className:`px-3 py-1.5 rounded-lg text-sm font-medium border ${m?"bg-teal-600 text-white border-teal-600":g.length>=F?"bg-gray-100 text-gray-400 border-gray-200 cursor-not-allowed":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:m?"Selected":"Select"})]})]},l.id)})})}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[e.jsx(Se,{size:16,className:"text-teal-600"}),e.jsxs("span",{children:["Will assign ",e.jsx("strong",{children:Math.min(g.length,F)})," worker",Math.min(g.length,F)!==1?"s":""," to ",F," shift",F!==1?"s":"","."]})]}),(Number(y)||0)>0&&e.jsxs("div",{className:"border-t pt-4 mt-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-gray-600",children:["Default rate for ",C,":"]}),e.jsxs("span",{className:"font-medium",children:["$",(Number(y)||0).toFixed(2),"/hr"]})]}),Object.keys(p).length>0&&e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["ðŸ’¡ Empty fields will use default rate ($",(Number(y)||0).toFixed(2),"/hr)"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[e.jsx(Ce,{size:14,className:"text-yellow-600"}),"Conflicts and already-filled shifts will be skipped automatically."]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3 px-6 py-5 bg-gray-50",children:[e.jsx("button",{onClick:x,className:"px-4 py-2 rounded-lg border border-gray-300 text-gray-700 hover:bg-gray-100",children:"Cancel"}),e.jsx("button",{onClick:W,disabled:j||g.length===0||F===0,className:"px-5 py-2 rounded-lg bg-teal-600 text-white font-semibold hover:bg-teal-700 disabled:opacity-50",children:j?"Assigningâ€¦":`Assign to ${F} shifts`})]})]})}):null}function Ye(){const b=ve(),[f,C]=_e(),r=(f.get("tab")==="completed"?"completed":f.get("tab"))||"active",$=f.get("filter")||"all",[x,c]=d.useState(r),[i,v]=d.useState($),[g,S]=d.useState(""),[h,a]=d.useState("date"),[D,u]=d.useState(!0),[j,P]=d.useState([]),[p,z]=d.useState(new Set),[y,O]=d.useState({isOpen:!1}),[I,w]=d.useState({isVisible:!1,message:"",type:"success"}),[F,A]=d.useState({isOpen:!1,isLoading:!1}),[W,l]=d.useState({isOpen:!1,isLoading:!1}),[m,t]=d.useState({isOpen:!1,isLoading:!1}),[n,_]=d.useState({isOpen:!1,unfilledShiftIds:[]});d.useEffect(()=>{E()},[x,i]),d.useEffect(()=>{const s=(f.get("tab")==="completed"?"completed":f.get("tab"))||"active",o=f.get("filter")||"all";s!==x&&c(s),o!==i&&v(o)},[f,x,i]),d.useEffect(()=>{const s=f.get("event_id"),o=f.get("shift_id");if(s){const N=parseInt(s);isNaN(N)||(z(new Set([N])),o&&console.log(`Auto-expanding event ${N} with shift ${o}`))}},[f]);async function E(){u(!0);try{const o=`/events?tab=${x==="completed"?"completed":x}${i!=="all"?`&filter=${i}`:""}`;console.log("Loading events with URL:",o,"filterStatus:",i);const N=await R.get(o);N.data.status==="success"&&(console.log("Received events:",N.data.data.length),P(N.data.data))}catch(s){console.error("Failed to load events:",s)}finally{u(!1)}}const k=s=>{c(s),C({tab:s}),v("all")},M=s=>{v(s)},L=s=>{const o=new Set(p);o.has(s)?o.delete(s):o.add(s),z(o)};async function T(s){const o=j==null?void 0:j.find(N=>N.id===s);t({isOpen:!0,isLoading:!1,eventId:s,eventTitle:o==null?void 0:o.title})}async function q(){if(m.eventId){t(s=>({...s,isLoading:!0}));try{const s=await R.delete(`/events/${m.eventId}`);s.data.status==="success"?(t({isOpen:!1,isLoading:!1}),w({isVisible:!0,message:`"${s.data.event_title}" moved to trash`,type:"success",action:{label:"Undo",onClick:()=>me(s.data.event_id),variant:"primary"}}),E()):w({isVisible:!0,message:s.data.message||"Failed to delete event",type:"error"})}catch(s){console.error("Failed to delete event:",s),w({isVisible:!0,message:"Failed to delete event",type:"error"})}finally{t(s=>({...s,isLoading:!1}))}}}async function me(s){try{const o=await R.post(`/events/${s}/restore`);o.data.status==="success"?(w({isVisible:!0,message:"Event restored to draft",type:"success"}),E()):w({isVisible:!0,message:o.data.message||"Failed to restore event",type:"error"})}catch(o){console.error("Failed to restore event:",o),w({isVisible:!0,message:"Failed to restore event",type:"error"})}}function xe(){t({isOpen:!1,isLoading:!1})}function se(s){A({isOpen:!0,eventId:s,isLoading:!1})}async function ue(){if(F.eventId){A(s=>({...s,isLoading:!0}));try{const s=await R.post(`/events/${F.eventId}/publish`);s.data.status==="success"?(w({isVisible:!0,message:s.data.message||"Event published",type:"success"}),A({isOpen:!1,isLoading:!1}),E()):(w({isVisible:!0,message:s.data.message||"Failed to publish event",type:"error"}),A({isOpen:!1,isLoading:!1}))}catch(s){console.error("Failed to publish event:",s),w({isVisible:!0,message:"Failed to publish event",type:"error"}),A({isOpen:!1,isLoading:!1})}}}function ge(){A({isOpen:!1,isLoading:!1})}function fe(s,o){l({isOpen:!0,assignmentId:s,isLoading:!1,workerName:o})}async function he(){var s,o;if(W.assignmentId){l(N=>({...N,isLoading:!0}));try{const N=await R.delete(`/staffing/${W.assignmentId}`);((s=N.data)==null?void 0:s.status)==="success"?(w({isVisible:!0,message:"Worker unassigned",type:"success"}),l({isOpen:!1,isLoading:!1}),E()):(w({isVisible:!0,message:((o=N.data)==null?void 0:o.message)||"Failed to unassign worker",type:"error"}),l({isOpen:!1,isLoading:!1}))}catch(N){console.error("Failed to unassign worker:",N),w({isVisible:!0,message:"Failed to unassign worker",type:"error"}),l({isOpen:!1,isLoading:!1})}}}const pe=s=>{O({isOpen:!0,shiftId:s})},te=()=>{O({isOpen:!1})},ye=()=>{te(),w({isVisible:!0,message:"Worker assigned successfully",type:"success"}),E()},J=j.filter(s=>{var o;if(g){const N=g.toLowerCase();if(!(s.title.toLowerCase().includes(N)||((o=s.venue)==null?void 0:o.name.toLowerCase().includes(N))))return!1}if(x==="active")switch(i){case"needs_workers":return s.unfilled_roles_count>0;case"partially_filled":return s.unfilled_roles_count>0&&s.assigned_workers_count>0;case"fully_staffed":return s.unfilled_roles_count===0&&s.assigned_workers_count>0;case"all":default:return!0}return!0}).sort((s,o)=>{var N,Q;switch(h){case"name":return s.title.localeCompare(o.title);case"staffing":return s.staffing_percentage-o.staffing_percentage;case"date":default:const be=((N=s.schedule)==null?void 0:N.start_time_utc)||s.created_at,je=((Q=o.schedule)==null?void 0:Q.start_time_utc)||o.created_at;return new Date(be).getTime()-new Date(je).getTime()}});return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsxs("div",{className:"max-w-7xl mx-auto p-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Events"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage events and assign workers"})]}),e.jsxs("button",{onClick:()=>b("/events/create"),className:"flex items-center gap-2 px-4 py-2 bg-teal-600 text-white font-medium rounded-lg hover:bg-teal-700 transition-colors shadow-sm",children:[e.jsx(de,{size:20}),"Create New Event"]})]}),e.jsxs("div",{className:"flex gap-6 border-b border-gray-200 mb-6",children:[e.jsx("button",{onClick:()=>k("draft"),className:`pb-3 px-1 font-medium transition-colors border-b-2 ${x==="draft"?"border-teal-600 text-teal-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Draft Events"}),e.jsx("button",{onClick:()=>k("active"),className:`pb-3 px-1 font-medium transition-colors border-b-2 ${x==="active"?"border-teal-600 text-teal-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Active Events"}),e.jsx("button",{onClick:()=>k("completed"),className:`pb-3 px-1 font-medium transition-colors border-b-2 ${x==="completed"?"border-teal-600 text-teal-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Completed Events"})]}),e.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center gap-4 mb-6",children:[e.jsxs("div",{className:"flex-1 max-w-md relative",children:[e.jsx(G,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),e.jsx("input",{type:"text",placeholder:"Search events or venues...",value:g,onChange:s=>S(s.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent"})]}),e.jsxs("select",{value:h,onChange:s=>a(s.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500 bg-white",children:[e.jsx("option",{value:"date",children:"Sort by Date"}),e.jsx("option",{value:"name",children:"Sort by Name"}),x!=="draft"&&e.jsx("option",{value:"staffing",children:"Sort by Staffing"})]}),x==="active"&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>M("all"),className:`px-3 py-2 text-sm font-medium rounded-lg transition ${i==="all"?"bg-teal-100 text-teal-700":"bg-white text-gray-600 hover:bg-gray-50 border border-gray-300"}`,children:"All"}),e.jsx("button",{onClick:()=>M("needs_workers"),className:`px-3 py-2 text-sm font-medium rounded-lg transition ${i==="needs_workers"?"bg-red-100 text-red-700":"bg-white text-gray-600 hover:bg-gray-50 border border-gray-300"}`,children:"Needs Workers"}),e.jsx("button",{onClick:()=>M("partially_filled"),className:`px-3 py-2 text-sm font-medium rounded-lg transition ${i==="partially_filled"?"bg-yellow-100 text-yellow-700":"bg-white text-gray-600 hover:bg-gray-50 border border-gray-300"}`,children:"Partial"}),e.jsx("button",{onClick:()=>M("fully_staffed"),className:`px-3 py-2 text-sm font-medium rounded-lg transition ${i==="fully_staffed"?"bg-green-100 text-green-700":"bg-white text-gray-600 hover:bg-gray-50 border border-gray-300"}`,children:"Ready"})]})]}),D?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-teal-600"})}):e.jsxs(e.Fragment,{children:[x==="draft"&&e.jsx(Te,{events:J,onDelete:T,onPublish:se,onNavigate:s=>b(s),searchQuery:g}),x==="active"&&e.jsx(De,{events:J,expandedEvents:p,onToggleEvent:L,onAssignWorker:pe,onUnassign:fe,onQuickFill:(s,o,N,Q)=>_({isOpen:!0,eventId:s,roleName:o,unfilledShiftIds:N,payRate:Q}),onPublish:se,onDelete:T,searchQuery:g}),x==="completed"&&e.jsx(Pe,{events:J,expandedEvents:p,onToggleEvent:L,searchQuery:g})]})]}),y.isOpen&&y.shiftId&&e.jsx($e,{shiftId:y.shiftId,onClose:te,onSuccess:ye}),e.jsx(ke,{isVisible:I.isVisible,message:I.message,type:I.type,action:I.action,onClose:()=>w({...I,isVisible:!1})}),e.jsx(K,{isOpen:F.isOpen,onClose:ge,onConfirm:ue,title:"Publish Event",message:"Publish this event? This will create shifts and make them available for staffing.",confirmText:F.isLoading?"Publishingâ€¦":"Publish",cancelText:"Cancel",isLoading:F.isLoading,isDestructive:!1}),e.jsx(K,{isOpen:W.isOpen,onClose:()=>l({isOpen:!1,isLoading:!1}),onConfirm:he,title:"Unassign Worker",message:`Remove ${W.workerName||"this worker"} from this shift?`,confirmText:W.isLoading?"Removingâ€¦":"Unassign",cancelText:"Cancel",isLoading:W.isLoading,isDestructive:!0}),e.jsx(K,{isOpen:m.isOpen,onClose:xe,onConfirm:q,title:"Delete Event",message:`Are you sure you want to delete "${m.eventTitle}"? This action cannot be undone.`,confirmText:m.isLoading?"Deletingâ€¦":"Delete",cancelText:"Cancel",isLoading:m.isLoading,isDestructive:!0}),e.jsx(Le,{isOpen:n.isOpen,eventId:n.eventId||0,roleName:n.roleName||"",unfilledShiftIds:n.unfilledShiftIds,defaultPayRate:n.payRate,onClose:()=>_({isOpen:!1,unfilledShiftIds:[]}),onDone:({assigned:s,conflicts:o})=>{_({isOpen:!1,unfilledShiftIds:[]}),w({isVisible:!0,message:`Assigned ${s} workers â€¢ ${o} skipped`,type:o>0?"error":"success"}),E()}})]})}function Te({events:b,onDelete:f,onPublish:C,onNavigate:r,searchQuery:$}){const x=i=>i?U(V(i),"MMM d, yyyy"):"No date set",c=i=>i?U(V(i),"h:mm a"):"";return b.length===0?e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ“…"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:$?"No draft events found":"No draft events yet"}),e.jsx("p",{className:"text-gray-600 mb-6",children:$?"Try adjusting your search query":"Create your first event to get started"}),!$&&e.jsxs("button",{onClick:()=>r("/events/create"),className:"inline-flex items-center gap-2 px-4 py-2 bg-teal-600 text-white font-medium rounded-lg hover:bg-teal-700 transition-colors",children:[e.jsx(de,{size:20}),"Create Event"]})]}):e.jsx("div",{className:"space-y-4",children:b.map(i=>e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 hover:shadow-md transition-shadow",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 flex-1",children:i.title}),e.jsx("span",{className:"px-2.5 py-1 bg-gray-100 text-gray-700 text-xs font-medium rounded-full",children:"Draft"})]}),i.venue&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 mb-2",children:[e.jsx(X,{size:16,className:"text-gray-400 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:i.venue.name})]}),i.schedule&&e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600 mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{size:16,className:"text-gray-400 flex-shrink-0"}),e.jsx("span",{children:x(i.schedule.start_time_utc)})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(H,{size:16,className:"text-gray-400 flex-shrink-0"}),e.jsxs("span",{children:[c(i.schedule.start_time_utc)," - ",c(i.schedule.end_time_utc)]})]})]}),i.total_workers_needed>0&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(Y,{size:16,className:"text-gray-400"}),e.jsxs("span",{children:[i.total_workers_needed," workers needed"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>r(`/events/${i.id}/edit`),className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition",title:"Edit",children:e.jsx(Fe,{size:18})}),e.jsx("button",{onClick:()=>C(i.id),className:"px-4 py-2 bg-teal-600 text-white text-sm font-medium rounded-lg hover:bg-teal-700 transition-colors",children:"Publish"}),e.jsx("button",{onClick:()=>f(i.id),className:"p-2 text-red-600 hover:text-red-700 hover:bg-red-50 rounded-lg transition",title:"Delete",children:e.jsx(ne,{size:18})})]})]})})},i.id))})}function De({events:b,expandedEvents:f,onToggleEvent:C,onAssignWorker:r,onUnassign:$,onQuickFill:x,onPublish:c,onDelete:i,searchQuery:v}){const g=a=>U(V(a),"EEE, MMM d, yyyy"),S=a=>U(V(a),"h:mm a"),h=a=>{switch(a){case"fully_staffed":return e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 bg-green-100 text-green-700 text-xs font-medium rounded-full",children:[e.jsx(re,{size:14}),"Ready"]});case"partially_staffed":return e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 bg-yellow-100 text-yellow-700 text-xs font-medium rounded-full",children:[e.jsx(Z,{size:14}),"Partial"]});case"needs_workers":return e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 bg-red-100 text-red-700 text-xs font-medium rounded-full",children:[e.jsx(B,{size:14}),"Needs Workers"]});default:return null}};return b.length===0?e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ“…"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:v?"No active events found":"No active events"}),e.jsx("p",{className:"text-gray-600",children:v?"Try adjusting your search query or filters":"Publish draft events to see them here"})]}):e.jsx("div",{className:"space-y-4",children:b.map(a=>{const D=f.has(a.id);return e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[e.jsxs("div",{onClick:()=>C(a.id),className:"w-full px-6 py-4 flex items-center justify-between hover:bg-gray-50 transition-colors cursor-pointer",children:[e.jsxs("div",{className:"flex-1 text-left",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:a.title}),h(a.staffing_status)]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600 mb-3",children:[a.venue&&e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(X,{size:14,className:"text-gray-400"}),a.venue.name]}),a.schedule&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(ee,{size:14,className:"text-gray-400"}),g(a.schedule.start_time_utc)]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(H,{size:14,className:"text-gray-400"}),S(a.schedule.start_time_utc)]})]})]}),e.jsxs("div",{className:"mb-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm mb-1",children:[e.jsxs("span",{className:"font-medium text-gray-700",children:[a.assigned_workers_count," of ",a.total_workers_needed," roles filled"]}),e.jsxs("span",{className:"font-semibold text-gray-900",children:[a.staffing_percentage,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-full rounded-full transition-all ${a.staffing_percentage===100?"bg-green-500":a.staffing_percentage>0?"bg-yellow-500":"bg-red-500"}`,style:{width:`${a.staffing_percentage}%`}})})]}),a.unfilled_roles_count>0&&e.jsxs("p",{className:"text-sm text-red-600 font-medium",children:[a.unfilled_roles_count," role",a.unfilled_roles_count!==1?"s":""," still need workers"]}),a.shifts_by_role&&a.shifts_by_role.length>0&&e.jsxs("div",{className:"text-sm text-gray-600 mt-2",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Est. Cost: "}),e.jsxs("span",{className:"font-semibold text-green-600",children:["$",(()=>{let u=0;return a.shifts_by_role.forEach(j=>{j.shifts.forEach(P=>{const p=(new Date(P.end_time_utc).getTime()-new Date(P.start_time_utc).getTime())/36e5;P.assignments.forEach(z=>{const y=Number(z.hourly_rate||P.pay_rate||0);u+=y*p})})}),u.toFixed(0)})()]})]})]}),e.jsxs("div",{className:"ml-4 flex items-center gap-2",children:[(!a.shifts_by_role||a.shifts_by_role.length===0)&&i&&e.jsx("button",{onClick:u=>{u.stopPropagation(),i(a.id)},className:"px-3 py-1.5 bg-red-600 text-white text-sm font-medium rounded-lg hover:bg-red-700 transition-colors",children:"Delete Event"}),i&&e.jsx("button",{onClick:u=>{u.stopPropagation(),i(a.id)},title:"Delete",className:"p-1.5 text-red-600 hover:text-red-700 hover:bg-red-50 rounded transition-colors",children:e.jsx(ne,{size:14})}),e.jsx("div",{className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:D?e.jsx(le,{size:24,className:"text-gray-600 hover:text-gray-800"}):e.jsx(ce,{size:24,className:"text-gray-600 hover:text-gray-800"})})]})]}),D&&e.jsx("div",{className:"border-t border-gray-200 bg-gray-50 px-6 py-4",children:a.shifts_by_role&&a.shifts_by_role.length>0?e.jsx("div",{className:"space-y-4",children:a.shifts_by_role.map(u=>e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:u.role_name}),e.jsxs("span",{className:"text-sm text-gray-600",children:[u.filled_shifts,"/",u.total_shifts," assigned"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[u.filled_shifts<u.total_shifts&&e.jsxs("span",{className:"px-2.5 py-1 bg-red-100 text-red-700 text-xs font-medium rounded-full",children:[u.total_shifts-u.filled_shifts," needed"]}),u.filled_shifts<u.total_shifts&&e.jsx("button",{onClick:j=>{var z;j.stopPropagation();const P=u.shifts.filter(y=>y.staffing_progress.percentage<100).sort((y,O)=>new Date(y.start_time_utc).getTime()-new Date(O.start_time_utc).getTime()).map(y=>y.id),p=(z=u.shifts[0])==null?void 0:z.pay_rate;x(a.id,u.role_name,P,p)},className:"px-2.5 py-1 text-xs font-semibold bg-teal-600 text-white rounded hover:bg-teal-700",title:"Quick Fill by Skill",children:"Quick Fill by Skill"})]})]}),e.jsx("div",{className:"space-y-2",children:u.shifts.map((j,P)=>e.jsxs("div",{className:"flex items-center justify-between py-2 px-3 bg-gray-50 rounded border border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-6 h-6 bg-gray-200 text-gray-700 rounded-md flex items-center justify-center text-xs font-medium",children:P+1}),e.jsxs("span",{className:"text-sm text-gray-700",children:[S(j.start_time_utc)," - ",S(j.end_time_utc)]}),j.assignments.length>0&&e.jsx("div",{className:"flex items-center gap-1",children:j.assignments.map(p=>e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("span",{className:"px-2 py-0.5 bg-teal-100 text-teal-700 text-xs rounded",children:[p.worker.first_name," ",p.worker.last_name[0],".",e.jsxs("span",{className:"ml-1 text-teal-600 font-medium",children:["$",Number(p.hourly_rate||j.pay_rate||0).toFixed(0),"/hr"]})]}),e.jsx("button",{onClick:z=>{z.stopPropagation(),$(p.id,`${p.worker.first_name} ${p.worker.last_name}`)},className:"w-5 h-5 flex items-center justify-center text-red-600 hover:text-red-700 hover:bg-red-50 rounded",title:"Unassign worker",children:e.jsx(B,{size:12})})]},p.id))})]}),j.staffing_progress.percentage===100?e.jsxs("span",{className:"flex items-center gap-1.5 text-sm font-medium text-green-600",children:[e.jsx(re,{size:16}),"Assigned"]}):e.jsx("button",{onClick:p=>{p.stopPropagation(),r(j.id)},className:"px-3 py-1.5 bg-teal-600 text-white text-sm font-medium rounded-lg hover:bg-teal-700 transition-colors",children:"Assign Worker"})]},j.id))})]},u.role_name))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-gray-500 mb-4",children:a.status==="draft"?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"font-medium",children:"This event is still in draft status"}),e.jsx("p",{className:"text-sm",children:"Publish the event to generate shifts and assign workers"})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"font-medium",children:"No shifts available"}),e.jsx("p",{className:"text-sm",children:"This event may not have any shifts generated yet"})]})}),e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[a.status==="draft"&&e.jsx("button",{onClick:()=>c(a.id),className:"px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-colors",children:"Publish Event"}),i&&e.jsx("button",{onClick:()=>i(a.id),className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"Delete Event"})]})]})})]},a.id)})})}function Pe({events:b,expandedEvents:f,onToggleEvent:C,searchQuery:r}){const $=c=>U(V(c),"MMM d, yyyy"),x=c=>U(V(c),"h:mm a");return b.length===0?e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ“‹"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:r?"No past events found":"No past events yet"}),e.jsx("p",{className:"text-gray-600",children:r?"Try adjusting your search query":"Completed events will appear here"})]}):e.jsx("div",{className:"space-y-4",children:b.map(c=>{var g;const i=f.has(c.id);let v=0;return(g=c.shifts_by_role)==null||g.forEach(S=>{S.shifts.forEach(h=>{h.assignments.forEach(a=>{const D=a.hours_worked?parseFloat(a.hours_worked.toString()):0;v+=D})})}),v=Number(v)||0,e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[e.jsxs("div",{onClick:()=>C(c.id),className:"w-full px-6 py-4 flex items-center justify-between hover:bg-gray-50 transition-colors cursor-pointer",children:[e.jsxs("div",{className:"flex-1 text-left",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:c.title}),e.jsx("span",{className:"px-2.5 py-1 bg-gray-100 text-gray-700 text-xs font-medium rounded-full",children:"Completed"})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[c.schedule&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(ee,{size:14,className:"text-gray-400"}),$(c.schedule.start_time_utc)]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(H,{size:14,className:"text-gray-400"}),x(c.schedule.start_time_utc)," - ",x(c.schedule.end_time_utc)]})]}),c.venue&&e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(X,{size:14,className:"text-gray-400"}),c.venue.name]})]})]}),e.jsx("div",{className:"ml-4 flex items-center",children:e.jsx("div",{className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:i?e.jsx(le,{size:24,className:"text-gray-600 hover:text-gray-800"}):e.jsx(ce,{size:24,className:"text-gray-600 hover:text-gray-800"})})})]}),i&&c.shifts_by_role&&e.jsxs("div",{className:"border-t border-gray-200 bg-gray-50 px-6 py-4",children:[e.jsx("div",{className:"mb-4 p-4 bg-white rounded-lg border border-gray-200",children:e.jsxs("div",{className:"grid grid-cols-4 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Workers"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:c.assigned_workers_count})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Hours"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:v.toFixed(2)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Event Cost"}),e.jsxs("p",{className:"text-2xl font-semibold text-green-600",children:["$",(()=>{let S=0;return c.shifts_by_role.forEach(h=>{h.shifts.forEach(a=>{const D=(new Date(a.end_time_utc).getTime()-new Date(a.start_time_utc).getTime())/36e5;a.assignments.forEach(u=>{const j=Number(u.hourly_rate||a.pay_rate||0);S+=j*D})})}),S.toFixed(0)})()]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Staffing"}),e.jsxs("p",{className:"text-2xl font-semibold text-gray-900",children:[c.staffing_percentage,"%"]})]})]})}),e.jsx("div",{className:"space-y-3",children:c.shifts_by_role.map(S=>e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:S.role_name}),e.jsx("div",{className:"space-y-2",children:S.shifts.flatMap(h=>h.assignments.map(a=>e.jsxs("div",{className:"flex items-center justify-between py-2 px-3 bg-gray-50 rounded",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"w-8 h-8 rounded-full bg-teal-100 text-teal-700 flex items-center justify-center text-sm font-medium",children:[a.worker.first_name[0],a.worker.last_name[0]]}),e.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[a.worker.first_name," ",a.worker.last_name]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[a.hours_worked&&e.jsxs("span",{className:"font-medium",children:[parseFloat(a.hours_worked.toString()).toFixed(2)," hrs"]}),e.jsxs("span",{className:"font-medium text-green-600",children:["$",Number(a.hourly_rate||h.pay_rate||0).toFixed(0),"/hr"]}),a.hours_worked&&e.jsxs("span",{className:"font-semibold text-blue-600",children:["$",(parseFloat(a.hours_worked.toString())*Number(a.hourly_rate||h.pay_rate||0)).toFixed(0)]}),e.jsxs("span",{className:"text-xs text-gray-500",children:[x(h.start_time_utc)," - ",x(h.end_time_utc)]})]})]},a.id)))})]},S.role_name))})]})]},c.id)})})}export{Ye as EventsPage};
