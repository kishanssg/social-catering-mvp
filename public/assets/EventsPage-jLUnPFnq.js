import{c as Oe,j as e,X as be,a as Y,A as ke,b as _s,C as Cs}from"./index-h5b3h3Nh.js";import{r as v,b as cs,f as Ss}from"./vendor-79DyBOV9.js";import{f as $s,a as rs}from"./dateUtils-CHmZs4Ub.js";import{C as Me}from"./clock-B2esJY9K.js";import{M as Ue}from"./map-pin-hmBXlJ8f.js";import{U as De}from"./users-Bc0QJZsX.js";import{S as Ye,T as Ie,L as Ge,C as qe}from"./ConfirmationModal-BRqq6s4I.js";import{D as ds}from"./dollar-sign-BwN2LQLo.js";import{T as es}from"./Toast-CFvCR76y.js";import{C as As}from"./x-circle-CXu6hj1c.js";import{b as Ms,a as Es,c as Fs,e as zs,p as Ps}from"./Prep Cook-CE8OFMb5.js";import{P as ms}from"./pen-square-AmWusTw1.js";import{P as ss}from"./plus-DMRulU7z.js";import{f as ye}from"./index-C_slYh2M.js";import{p as ge}from"./index-BK_MyBzW.js";import{U as Ls}from"./user-CmK2xls8.js";import{C as We}from"./calendar-P1YLyFOa.js";import{C as Rs}from"./chevron-down-DefBoxdH.js";import{C as Ts}from"./chevron-right-BfTQU7Vm.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const as=Oe("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=Oe("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=Oe("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ds=Oe("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);function Ve(s,r=0){const a=typeof s=="string"?Number(s):s;return Number.isFinite(a)?a:r}function ee(s,r=2,a="0"){const t=Ve(s,NaN);if(!Number.isFinite(t))return a;try{return t.toFixed(r)}catch{return a}}function us(s){var r,a,t="";if(typeof s=="string"||typeof s=="number")t+=s;else if(typeof s=="object")if(Array.isArray(s)){var g=s.length;for(r=0;r<g;r++)s[r]&&(a=us(s[r]))&&(t&&(t+=" "),t+=a)}else for(a in s)s[a]&&(t&&(t+=" "),t+=a);return t}function Is(){for(var s,r,a=0,t="",g=arguments.length;a<g;a++)(s=arguments[a])&&(r=us(s))&&(t&&(t+=" "),t+=r);return t}const ts="-",Vs=s=>{const r=Us(s),{conflictingClassGroups:a,conflictingClassGroupModifiers:t}=s;return{getClassGroupId:f=>{const i=f.split(ts);return i[0]===""&&i.length!==1&&i.shift(),xs(i,r)||Os(f)},getConflictingClassGroupIds:(f,i)=>{const u=a[f]||[];return i&&t[f]?[...u,...t[f]]:u}}},xs=(s,r)=>{var f;if(s.length===0)return r.classGroupId;const a=s[0],t=r.nextPart.get(a),g=t?xs(s.slice(1),t):void 0;if(g)return g;if(r.validators.length===0)return;const n=s.join(ts);return(f=r.validators.find(({validator:i})=>i(n)))==null?void 0:f.classGroupId},ns=/^\[(.+)\]$/,Os=s=>{if(ns.test(s)){const r=ns.exec(s)[1],a=r==null?void 0:r.substring(0,r.indexOf(":"));if(a)return"arbitrary.."+a}},Us=s=>{const{theme:r,classGroups:a}=s,t={nextPart:new Map,validators:[]};for(const g in a)Je(a[g],t,g,r);return t},Je=(s,r,a,t)=>{s.forEach(g=>{if(typeof g=="string"){const n=g===""?r:ls(r,g);n.classGroupId=a;return}if(typeof g=="function"){if(Ws(g)){Je(g(t),r,a,t);return}r.validators.push({validator:g,classGroupId:a});return}Object.entries(g).forEach(([n,f])=>{Je(f,ls(r,n),a,t)})})},ls=(s,r)=>{let a=s;return r.split(ts).forEach(t=>{a.nextPart.has(t)||a.nextPart.set(t,{nextPart:new Map,validators:[]}),a=a.nextPart.get(t)}),a},Ws=s=>s.isThemeGetter,qs=s=>{if(s<1)return{get:()=>{},set:()=>{}};let r=0,a=new Map,t=new Map;const g=(n,f)=>{a.set(n,f),r++,r>s&&(r=0,t=a,a=new Map)};return{get(n){let f=a.get(n);if(f!==void 0)return f;if((f=t.get(n))!==void 0)return g(n,f),f},set(n,f){a.has(n)?a.set(n,f):g(n,f)}}},Ke="!",Xe=":",Bs=Xe.length,Qs=s=>{const{prefix:r,experimentalParseClassName:a}=s;let t=g=>{const n=[];let f=0,i=0,u=0,_;for(let b=0;b<g.length;b++){let Q=g[b];if(f===0&&i===0){if(Q===Xe){n.push(g.slice(u,b)),u=b+Bs;continue}if(Q==="/"){_=b;continue}}Q==="["?f++:Q==="]"?f--:Q==="("?i++:Q===")"&&i--}const q=n.length===0?g:g.substring(u),B=Hs(q),X=B!==q,H=_&&_>u?_-u:void 0;return{modifiers:n,hasImportantModifier:X,baseClassName:B,maybePostfixModifierPosition:H}};if(r){const g=r+Xe,n=t;t=f=>f.startsWith(g)?n(f.substring(g.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:f,maybePostfixModifierPosition:void 0}}if(a){const g=t;t=n=>a({className:n,parseClassName:g})}return t},Hs=s=>s.endsWith(Ke)?s.substring(0,s.length-1):s.startsWith(Ke)?s.substring(1):s,Gs=s=>{const r=Object.fromEntries(s.orderSensitiveModifiers.map(t=>[t,!0]));return t=>{if(t.length<=1)return t;const g=[];let n=[];return t.forEach(f=>{f[0]==="["||r[f]?(g.push(...n.sort(),f),n=[]):n.push(f)}),g.push(...n.sort()),g}},Js=s=>({cache:qs(s.cacheSize),parseClassName:Qs(s),sortModifiers:Gs(s),...Vs(s)}),Ks=/\s+/,Xs=(s,r)=>{const{parseClassName:a,getClassGroupId:t,getConflictingClassGroupIds:g,sortModifiers:n}=r,f=[],i=s.trim().split(Ks);let u="";for(let _=i.length-1;_>=0;_-=1){const q=i[_],{isExternal:B,modifiers:X,hasImportantModifier:H,baseClassName:b,maybePostfixModifierPosition:Q}=a(q);if(B){u=q+(u.length>0?" "+u:u);continue}let S=!!Q,$=t(S?b.substring(0,Q):b);if(!$){if(!S){u=q+(u.length>0?" "+u:u);continue}if($=t(b),!$){u=q+(u.length>0?" "+u:u);continue}S=!1}const I=n(X).join(":"),x=H?I+Ke:I,z=x+$;if(f.includes(z))continue;f.push(z);const V=g($,S);for(let G=0;G<V.length;++G){const J=V[G];f.push(x+J)}u=q+(u.length>0?" "+u:u)}return u};function Zs(){let s=0,r,a,t="";for(;s<arguments.length;)(r=arguments[s++])&&(a=gs(r))&&(t&&(t+=" "),t+=a);return t}const gs=s=>{if(typeof s=="string")return s;let r,a="";for(let t=0;t<s.length;t++)s[t]&&(r=gs(s[t]))&&(a&&(a+=" "),a+=r);return a};function Ys(s,...r){let a,t,g,n=f;function f(u){const _=r.reduce((q,B)=>B(q),s());return a=Js(_),t=a.cache.get,g=a.cache.set,n=i,i(u)}function i(u){const _=t(u);if(_)return _;const q=Xs(u,a);return g(u,q),q}return function(){return n(Zs.apply(null,arguments))}}const ae=s=>{const r=a=>a[s]||[];return r.isThemeGetter=!0,r},hs=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,fs=/^\((?:(\w[\w-]*):)?(.+)\)$/i,et=/^\d+\/\d+$/,st=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,tt=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,rt=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,at=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,nt=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,$e=s=>et.test(s),W=s=>!!s&&!Number.isNaN(Number(s)),we=s=>!!s&&Number.isInteger(Number(s)),Be=s=>s.endsWith("%")&&W(s.slice(0,-1)),pe=s=>st.test(s),lt=()=>!0,ot=s=>tt.test(s)&&!rt.test(s),ps=()=>!1,it=s=>at.test(s),ct=s=>nt.test(s),dt=s=>!N(s)&&!k(s),mt=s=>Ee(s,js,ps),N=s=>hs.test(s),_e=s=>Ee(s,vs,ot),Qe=s=>Ee(s,ft,W),os=s=>Ee(s,bs,ps),ut=s=>Ee(s,ys,ct),Re=s=>Ee(s,ws,it),k=s=>fs.test(s),Pe=s=>Fe(s,vs),xt=s=>Fe(s,pt),is=s=>Fe(s,bs),gt=s=>Fe(s,js),ht=s=>Fe(s,ys),Te=s=>Fe(s,ws,!0),Ee=(s,r,a)=>{const t=hs.exec(s);return t?t[1]?r(t[1]):a(t[2]):!1},Fe=(s,r,a=!1)=>{const t=fs.exec(s);return t?t[1]?r(t[1]):a:!1},bs=s=>s==="position"||s==="percentage",ys=s=>s==="image"||s==="url",js=s=>s==="length"||s==="size"||s==="bg-size",vs=s=>s==="length",ft=s=>s==="number",pt=s=>s==="family-name",ws=s=>s==="shadow",bt=()=>{const s=ae("color"),r=ae("font"),a=ae("text"),t=ae("font-weight"),g=ae("tracking"),n=ae("leading"),f=ae("breakpoint"),i=ae("container"),u=ae("spacing"),_=ae("radius"),q=ae("shadow"),B=ae("inset-shadow"),X=ae("text-shadow"),H=ae("drop-shadow"),b=ae("blur"),Q=ae("perspective"),S=ae("aspect"),$=ae("ease"),I=ae("animate"),x=()=>["auto","avoid","all","avoid-page","page","left","right","column"],z=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],V=()=>[...z(),k,N],G=()=>["auto","hidden","clip","visible","scroll"],J=()=>["auto","contain","none"],C=()=>[k,N,u],O=()=>[$e,"full","auto",...C()],K=()=>[we,"none","subgrid",k,N],w=()=>["auto",{span:["full",we,k,N]},we,k,N],m=()=>[we,"auto",k,N],y=()=>["auto","min","max","fr",k,N],D=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],U=()=>["start","end","center","stretch","center-safe","end-safe"],A=()=>["auto",...C()],L=()=>[$e,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...C()],c=()=>[s,k,N],M=()=>[...z(),is,os,{position:[k,N]}],d=()=>["no-repeat",{repeat:["","x","y","space","round"]}],h=()=>["auto","cover","contain",gt,mt,{size:[k,N]}],T=()=>[Be,Pe,_e],j=()=>["","none","full",_,k,N],R=()=>["",W,Pe,_e],o=()=>["solid","dashed","dotted","double"],E=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],F=()=>[W,Be,is,os],se=()=>["","none",b,k,N],te=()=>["none",W,k,N],he=()=>["none",W,k,N],je=()=>[W,k,N],fe=()=>[$e,"full",...C()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[pe],breakpoint:[pe],color:[lt],container:[pe],"drop-shadow":[pe],ease:["in","out","in-out"],font:[dt],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[pe],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[pe],shadow:[pe],spacing:["px",W],text:[pe],"text-shadow":[pe],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",$e,N,k,S]}],container:["container"],columns:[{columns:[W,N,k,i]}],"break-after":[{"break-after":x()}],"break-before":[{"break-before":x()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:V()}],overflow:[{overflow:G()}],"overflow-x":[{"overflow-x":G()}],"overflow-y":[{"overflow-y":G()}],overscroll:[{overscroll:J()}],"overscroll-x":[{"overscroll-x":J()}],"overscroll-y":[{"overscroll-y":J()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:O()}],"inset-x":[{"inset-x":O()}],"inset-y":[{"inset-y":O()}],start:[{start:O()}],end:[{end:O()}],top:[{top:O()}],right:[{right:O()}],bottom:[{bottom:O()}],left:[{left:O()}],visibility:["visible","invisible","collapse"],z:[{z:[we,"auto",k,N]}],basis:[{basis:[$e,"full","auto",i,...C()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[W,$e,"auto","initial","none",N]}],grow:[{grow:["",W,k,N]}],shrink:[{shrink:["",W,k,N]}],order:[{order:[we,"first","last","none",k,N]}],"grid-cols":[{"grid-cols":K()}],"col-start-end":[{col:w()}],"col-start":[{"col-start":m()}],"col-end":[{"col-end":m()}],"grid-rows":[{"grid-rows":K()}],"row-start-end":[{row:w()}],"row-start":[{"row-start":m()}],"row-end":[{"row-end":m()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":y()}],"auto-rows":[{"auto-rows":y()}],gap:[{gap:C()}],"gap-x":[{"gap-x":C()}],"gap-y":[{"gap-y":C()}],"justify-content":[{justify:[...D(),"normal"]}],"justify-items":[{"justify-items":[...U(),"normal"]}],"justify-self":[{"justify-self":["auto",...U()]}],"align-content":[{content:["normal",...D()]}],"align-items":[{items:[...U(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...U(),{baseline:["","last"]}]}],"place-content":[{"place-content":D()}],"place-items":[{"place-items":[...U(),"baseline"]}],"place-self":[{"place-self":["auto",...U()]}],p:[{p:C()}],px:[{px:C()}],py:[{py:C()}],ps:[{ps:C()}],pe:[{pe:C()}],pt:[{pt:C()}],pr:[{pr:C()}],pb:[{pb:C()}],pl:[{pl:C()}],m:[{m:A()}],mx:[{mx:A()}],my:[{my:A()}],ms:[{ms:A()}],me:[{me:A()}],mt:[{mt:A()}],mr:[{mr:A()}],mb:[{mb:A()}],ml:[{ml:A()}],"space-x":[{"space-x":C()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":C()}],"space-y-reverse":["space-y-reverse"],size:[{size:L()}],w:[{w:[i,"screen",...L()]}],"min-w":[{"min-w":[i,"screen","none",...L()]}],"max-w":[{"max-w":[i,"screen","none","prose",{screen:[f]},...L()]}],h:[{h:["screen","lh",...L()]}],"min-h":[{"min-h":["screen","lh","none",...L()]}],"max-h":[{"max-h":["screen","lh",...L()]}],"font-size":[{text:["base",a,Pe,_e]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[t,k,Qe]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",Be,N]}],"font-family":[{font:[xt,N,r]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[g,k,N]}],"line-clamp":[{"line-clamp":[W,"none",k,Qe]}],leading:[{leading:[n,...C()]}],"list-image":[{"list-image":["none",k,N]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",k,N]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:c()}],"text-color":[{text:c()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...o(),"wavy"]}],"text-decoration-thickness":[{decoration:[W,"from-font","auto",k,_e]}],"text-decoration-color":[{decoration:c()}],"underline-offset":[{"underline-offset":[W,"auto",k,N]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:C()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",k,N]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",k,N]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:M()}],"bg-repeat":[{bg:d()}],"bg-size":[{bg:h()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},we,k,N],radial:["",k,N],conic:[we,k,N]},ht,ut]}],"bg-color":[{bg:c()}],"gradient-from-pos":[{from:T()}],"gradient-via-pos":[{via:T()}],"gradient-to-pos":[{to:T()}],"gradient-from":[{from:c()}],"gradient-via":[{via:c()}],"gradient-to":[{to:c()}],rounded:[{rounded:j()}],"rounded-s":[{"rounded-s":j()}],"rounded-e":[{"rounded-e":j()}],"rounded-t":[{"rounded-t":j()}],"rounded-r":[{"rounded-r":j()}],"rounded-b":[{"rounded-b":j()}],"rounded-l":[{"rounded-l":j()}],"rounded-ss":[{"rounded-ss":j()}],"rounded-se":[{"rounded-se":j()}],"rounded-ee":[{"rounded-ee":j()}],"rounded-es":[{"rounded-es":j()}],"rounded-tl":[{"rounded-tl":j()}],"rounded-tr":[{"rounded-tr":j()}],"rounded-br":[{"rounded-br":j()}],"rounded-bl":[{"rounded-bl":j()}],"border-w":[{border:R()}],"border-w-x":[{"border-x":R()}],"border-w-y":[{"border-y":R()}],"border-w-s":[{"border-s":R()}],"border-w-e":[{"border-e":R()}],"border-w-t":[{"border-t":R()}],"border-w-r":[{"border-r":R()}],"border-w-b":[{"border-b":R()}],"border-w-l":[{"border-l":R()}],"divide-x":[{"divide-x":R()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":R()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...o(),"hidden","none"]}],"divide-style":[{divide:[...o(),"hidden","none"]}],"border-color":[{border:c()}],"border-color-x":[{"border-x":c()}],"border-color-y":[{"border-y":c()}],"border-color-s":[{"border-s":c()}],"border-color-e":[{"border-e":c()}],"border-color-t":[{"border-t":c()}],"border-color-r":[{"border-r":c()}],"border-color-b":[{"border-b":c()}],"border-color-l":[{"border-l":c()}],"divide-color":[{divide:c()}],"outline-style":[{outline:[...o(),"none","hidden"]}],"outline-offset":[{"outline-offset":[W,k,N]}],"outline-w":[{outline:["",W,Pe,_e]}],"outline-color":[{outline:c()}],shadow:[{shadow:["","none",q,Te,Re]}],"shadow-color":[{shadow:c()}],"inset-shadow":[{"inset-shadow":["none",B,Te,Re]}],"inset-shadow-color":[{"inset-shadow":c()}],"ring-w":[{ring:R()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:c()}],"ring-offset-w":[{"ring-offset":[W,_e]}],"ring-offset-color":[{"ring-offset":c()}],"inset-ring-w":[{"inset-ring":R()}],"inset-ring-color":[{"inset-ring":c()}],"text-shadow":[{"text-shadow":["none",X,Te,Re]}],"text-shadow-color":[{"text-shadow":c()}],opacity:[{opacity:[W,k,N]}],"mix-blend":[{"mix-blend":[...E(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":E()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[W]}],"mask-image-linear-from-pos":[{"mask-linear-from":F()}],"mask-image-linear-to-pos":[{"mask-linear-to":F()}],"mask-image-linear-from-color":[{"mask-linear-from":c()}],"mask-image-linear-to-color":[{"mask-linear-to":c()}],"mask-image-t-from-pos":[{"mask-t-from":F()}],"mask-image-t-to-pos":[{"mask-t-to":F()}],"mask-image-t-from-color":[{"mask-t-from":c()}],"mask-image-t-to-color":[{"mask-t-to":c()}],"mask-image-r-from-pos":[{"mask-r-from":F()}],"mask-image-r-to-pos":[{"mask-r-to":F()}],"mask-image-r-from-color":[{"mask-r-from":c()}],"mask-image-r-to-color":[{"mask-r-to":c()}],"mask-image-b-from-pos":[{"mask-b-from":F()}],"mask-image-b-to-pos":[{"mask-b-to":F()}],"mask-image-b-from-color":[{"mask-b-from":c()}],"mask-image-b-to-color":[{"mask-b-to":c()}],"mask-image-l-from-pos":[{"mask-l-from":F()}],"mask-image-l-to-pos":[{"mask-l-to":F()}],"mask-image-l-from-color":[{"mask-l-from":c()}],"mask-image-l-to-color":[{"mask-l-to":c()}],"mask-image-x-from-pos":[{"mask-x-from":F()}],"mask-image-x-to-pos":[{"mask-x-to":F()}],"mask-image-x-from-color":[{"mask-x-from":c()}],"mask-image-x-to-color":[{"mask-x-to":c()}],"mask-image-y-from-pos":[{"mask-y-from":F()}],"mask-image-y-to-pos":[{"mask-y-to":F()}],"mask-image-y-from-color":[{"mask-y-from":c()}],"mask-image-y-to-color":[{"mask-y-to":c()}],"mask-image-radial":[{"mask-radial":[k,N]}],"mask-image-radial-from-pos":[{"mask-radial-from":F()}],"mask-image-radial-to-pos":[{"mask-radial-to":F()}],"mask-image-radial-from-color":[{"mask-radial-from":c()}],"mask-image-radial-to-color":[{"mask-radial-to":c()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":z()}],"mask-image-conic-pos":[{"mask-conic":[W]}],"mask-image-conic-from-pos":[{"mask-conic-from":F()}],"mask-image-conic-to-pos":[{"mask-conic-to":F()}],"mask-image-conic-from-color":[{"mask-conic-from":c()}],"mask-image-conic-to-color":[{"mask-conic-to":c()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:M()}],"mask-repeat":[{mask:d()}],"mask-size":[{mask:h()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",k,N]}],filter:[{filter:["","none",k,N]}],blur:[{blur:se()}],brightness:[{brightness:[W,k,N]}],contrast:[{contrast:[W,k,N]}],"drop-shadow":[{"drop-shadow":["","none",H,Te,Re]}],"drop-shadow-color":[{"drop-shadow":c()}],grayscale:[{grayscale:["",W,k,N]}],"hue-rotate":[{"hue-rotate":[W,k,N]}],invert:[{invert:["",W,k,N]}],saturate:[{saturate:[W,k,N]}],sepia:[{sepia:["",W,k,N]}],"backdrop-filter":[{"backdrop-filter":["","none",k,N]}],"backdrop-blur":[{"backdrop-blur":se()}],"backdrop-brightness":[{"backdrop-brightness":[W,k,N]}],"backdrop-contrast":[{"backdrop-contrast":[W,k,N]}],"backdrop-grayscale":[{"backdrop-grayscale":["",W,k,N]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[W,k,N]}],"backdrop-invert":[{"backdrop-invert":["",W,k,N]}],"backdrop-opacity":[{"backdrop-opacity":[W,k,N]}],"backdrop-saturate":[{"backdrop-saturate":[W,k,N]}],"backdrop-sepia":[{"backdrop-sepia":["",W,k,N]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":C()}],"border-spacing-x":[{"border-spacing-x":C()}],"border-spacing-y":[{"border-spacing-y":C()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",k,N]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[W,"initial",k,N]}],ease:[{ease:["linear","initial",$,k,N]}],delay:[{delay:[W,k,N]}],animate:[{animate:["none",I,k,N]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[Q,k,N]}],"perspective-origin":[{"perspective-origin":V()}],rotate:[{rotate:te()}],"rotate-x":[{"rotate-x":te()}],"rotate-y":[{"rotate-y":te()}],"rotate-z":[{"rotate-z":te()}],scale:[{scale:he()}],"scale-x":[{"scale-x":he()}],"scale-y":[{"scale-y":he()}],"scale-z":[{"scale-z":he()}],"scale-3d":["scale-3d"],skew:[{skew:je()}],"skew-x":[{"skew-x":je()}],"skew-y":[{"skew-y":je()}],transform:[{transform:[k,N,"","none","gpu","cpu"]}],"transform-origin":[{origin:V()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:fe()}],"translate-x":[{"translate-x":fe()}],"translate-y":[{"translate-y":fe()}],"translate-z":[{"translate-z":fe()}],"translate-none":["translate-none"],accent:[{accent:c()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:c()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",k,N]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":C()}],"scroll-mx":[{"scroll-mx":C()}],"scroll-my":[{"scroll-my":C()}],"scroll-ms":[{"scroll-ms":C()}],"scroll-me":[{"scroll-me":C()}],"scroll-mt":[{"scroll-mt":C()}],"scroll-mr":[{"scroll-mr":C()}],"scroll-mb":[{"scroll-mb":C()}],"scroll-ml":[{"scroll-ml":C()}],"scroll-p":[{"scroll-p":C()}],"scroll-px":[{"scroll-px":C()}],"scroll-py":[{"scroll-py":C()}],"scroll-ps":[{"scroll-ps":C()}],"scroll-pe":[{"scroll-pe":C()}],"scroll-pt":[{"scroll-pt":C()}],"scroll-pr":[{"scroll-pr":C()}],"scroll-pb":[{"scroll-pb":C()}],"scroll-pl":[{"scroll-pl":C()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",k,N]}],fill:[{fill:["none",...c()]}],"stroke-w":[{stroke:[W,Pe,_e,Qe]}],stroke:[{stroke:["none",...c()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},yt=Ys(bt);function Ae(...s){return yt(Is(s))}const jt={sm:"max-w-md",md:"max-w-2xl",lg:"max-w-4xl",xl:"max-w-6xl"},Ze=({isOpen:s,onClose:r,title:a,subtitle:t,children:g,footer:n,size:f="md",closeOnOverlayClick:i=!0})=>{if(v.useEffect(()=>(s?document.body.classList.add("modal-open"):document.body.classList.remove("modal-open"),()=>{document.body.classList.remove("modal-open")}),[s]),v.useEffect(()=>{const _=q=>{q.key==="Escape"&&s&&r()};return document.addEventListener("keydown",_),()=>document.removeEventListener("keydown",_)},[s,r]),!s)return null;const u=_=>{_.target===_.currentTarget&&i&&r()};return e.jsx("div",{className:"modal-overlay",onClick:u,role:"dialog","aria-modal":"true","aria-labelledby":"modal-title",children:e.jsxs("div",{className:`modal-container ${jt[f]}`,children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{id:"modal-title",className:"text-xl font-semibold text-gray-900 font-manrope",children:a}),t&&e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:t})]}),e.jsx("button",{onClick:r,className:"p-1.5 rounded-lg bg-gray-100 hover:bg-gray-200 transition-colors","aria-label":"Close modal",children:e.jsx(be,{size:20,className:"text-gray-600"})})]}),e.jsx("div",{className:"modal-body",children:g}),n&&e.jsx("div",{className:"modal-footer",children:n})]})})};function vt({shiftId:s,onClose:r,onSuccess:a}){var K,w;const[t,g]=v.useState(null),[n,f]=v.useState([]),[i,u]=v.useState([]),[_,q]=v.useState(""),[B,X]=v.useState(null),[H,b]=v.useState({}),[Q,S]=v.useState(!0),[$,I]=v.useState(!1),[x,z]=v.useState(null),V=(m,y)=>{b(D=>({...D,[m]:y}))};v.useEffect(()=>{G()},[s]),v.useEffect(()=>{t&&J()},[t]),v.useEffect(()=>{if(!_)u(n);else{const m=_.toLowerCase();u(n.filter(y=>{var D;return y.first_name.toLowerCase().includes(m)||y.last_name.toLowerCase().includes(m)||y.email.toLowerCase().includes(m)||((D=y.skills_json)==null?void 0:D.some(U=>U.toLowerCase().includes(m)))}))}},[_,n]);async function G(){try{const m=await Y.get(`/shifts/${s}`);m.data.status==="success"?g(m.data.data):z("Failed to load shift details")}catch(m){console.error("Failed to load shift details:",m),z("Failed to load shift details")}}async function J(){var m;try{const y=new Set;if(t!=null&&t.event_id)try{const A=((m=(await Y.get(`/events/${t.event_id}`)).data)==null?void 0:m.data)||{};if(A.shifts_by_role){const L=A.shifts_by_role.find(c=>c.skill_name===t.role_needed||c.role_name===t.role_needed);L!=null&&L.shifts&&L.shifts.forEach(c=>{c.assignments&&c.assignments.forEach(M=>{var T;const d=M.worker_id||((T=M.worker)==null?void 0:T.id),h=M.status;d&&h!=="cancelled"&&h!=="no_show"&&y.add(d)})})}}catch(U){console.log("Could not fetch event to filter assigned workers:",U)}console.log(`AssignmentModal: Found ${y.size} already assigned workers for "${t==null?void 0:t.role_needed}"`);const D=await Y.get("/workers?active=true");if(D.data.status==="success"){const U=D.data.data.workers||D.data.data;if(t!=null&&t.role_needed){const A=U.filter(L=>{var c;return((c=L.skills_json)==null?void 0:c.includes(t.role_needed))&&!y.has(L.id)});console.log(`AssignmentModal: Showing ${A.length} eligible workers`),f(A)}else{const A=U.filter(L=>!y.has(L.id));f(A)}}else z("Failed to load workers")}catch(y){console.error("Failed to load workers:",y),z("Failed to load workers")}finally{S(!1)}}async function C(){var m,y,D,U,A,L;if(!(!B||!t)){I(!0),z(null);try{const M=(await Y.post("/staffing",{assignment:{shift_id:t.id,worker_id:B.id,status:"assigned",assigned_at_utc:new Date().toISOString(),hourly_rate:H[B.id]||Number(t.pay_rate)||0}})).data;if(M.status==="success")a();else{let d=M.message||"Failed to assign worker";M.details&&M.details.length>0?d+=`

Details:
â€¢ `+M.details.join(`
â€¢ `):M.errors&&(d+=`

Details:
â€¢ `+M.errors.join(`
â€¢ `)),z(d)}}catch(c){console.error("Failed to assign worker:",c);let M="Failed to assign worker";if((y=(m=c.response)==null?void 0:m.data)!=null&&y.details&&c.response.data.details.length>0){const d=c.response.data.details.map(h=>(h.includes("conflicting shift"),h));M+=`

`+d.join(`
`)}else(U=(D=c.response)==null?void 0:D.data)!=null&&U.errors?M+=`

`+c.response.data.errors.join(`
`):(L=(A=c.response)==null?void 0:A.data)!=null&&L.message?M=c.response.data.message:c.message&&(M=c.message);z(M)}finally{I(!1)}}}if(Q)return e.jsx(Ze,{isOpen:!0,onClose:r,title:"Assign Worker",size:"lg",children:e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-teal-600"})})});const O=e.jsxs(e.Fragment,{children:[x&&e.jsxs("div",{className:"mb-4 p-3 bg-gradient-to-r from-red-50 to-amber-50 border-l-4 border-red-500 rounded-r-lg shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-6 h-6 bg-red-500 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-white text-xs font-bold",children:"!"})}),e.jsx("h4",{className:"text-sm font-semibold text-red-900",children:"âš ï¸ Scheduling Conflict Detected"})]}),e.jsx("p",{className:"text-xs text-gray-600 ml-8",children:"Please resolve the conflict before attempting to assign this worker"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:r,disabled:$,className:"btn-secondary",children:"Cancel"}),e.jsx("button",{onClick:C,disabled:!B||$||!!x,className:`btn-primary ${x?"opacity-50 cursor-not-allowed":""}`,title:x?"Cannot assign due to scheduling conflict":"",children:$?"Assigning Worker...":"Assign Worker"})]})]});return e.jsx(Ze,{isOpen:!0,onClose:r,title:t?`${t.client_name} â€¢ ${t.role_needed}`:"Assign Worker",size:"xl",footer:O,children:e.jsxs("div",{className:"flex h-[600px]",children:[e.jsx("div",{className:"w-1/3 border-r border-gray-200 p-6 bg-gray-50",children:t?e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Shift Details"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Me,{size:16,className:"text-gray-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:$s(t.start_time_utc)}),e.jsxs("div",{className:"text-sm text-gray-600",children:[rs(t.start_time_utc)," - ",rs(t.end_time_utc)]})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Ue,{size:16,className:"text-gray-400 mt-0.5 flex-shrink-0"}),e.jsx("div",{className:"text-sm text-gray-900",children:t.location||((w=(K=t.event)==null?void 0:K.venue)==null?void 0:w.formatted_address)||"Location not specified"})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(De,{size:16,className:"text-gray-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-900",children:t.role_needed}),t.required_skill&&e.jsxs("div",{className:"text-sm text-gray-600",children:["Requires: ",t.required_skill]})]})]}),e.jsxs("div",{className:"pt-2 border-t border-gray-200",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Pay Rate:"})," $",(Number(t.pay_rate)||0).toFixed(2),"/hour"]}),t.uniform_name&&e.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[e.jsx("span",{className:"font-medium",children:"Uniform:"})," ",t.uniform_name]})]}),t.notes&&e.jsx("div",{className:"pt-2 border-t border-gray-200",children:e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Notes:"}),e.jsx("div",{className:"mt-1 whitespace-pre-line",children:t.notes.split("Uniform:").map((m,y)=>y===0?m.trim():e.jsxs("div",{children:[e.jsx("br",{}),e.jsx("span",{className:"font-medium",children:"Uniform:"})," ",m.trim()]},y))})]})})]})]})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ke,{size:32,className:"text-gray-400 mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Failed to load shift details"})]})}),e.jsxs("div",{className:"flex-1 flex flex-col",children:[e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsxs("div",{className:"relative",children:[e.jsx(Ye,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:16}),e.jsx("input",{type:"text",placeholder:"Search workers...",value:_,onChange:m=>q(m.target.value),className:"w-full pl-9 pr-4 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-1 focus:ring-teal-500 focus:border-teal-500"})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:x?e.jsx("div",{className:"p-6 flex items-center justify-center h-full",children:e.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 rounded-lg p-5 shadow-sm w-full max-w-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx(ke,{size:20,className:"text-red-600"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-lg font-semibold text-red-900 mb-1",children:"âš ï¸ Scheduling Conflict"}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"This worker cannot be assigned due to a scheduling conflict"}),e.jsx("div",{className:"bg-white border border-red-200 rounded p-3 mt-3",children:e.jsx("div",{className:"text-sm text-red-800 font-mono",children:x.split(`
`).map((m,y)=>m.trim()===""?null:m.startsWith("â€¢")?e.jsxs("div",{className:"mt-1 flex items-start gap-2",children:[e.jsx("span",{className:"text-red-500",children:"â—"}),e.jsx("span",{className:"flex-1",children:m.replace("â€¢","").trim()})]},y):m.startsWith("Details:")?null:m.includes("conflicting shift")?e.jsx("div",{className:"mt-1 text-red-700 font-medium",children:m},y):e.jsx("div",{className:"text-gray-700",children:m},y))})})]})]})})}):i.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(De,{size:32,className:"text-gray-400 mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-gray-600",children:_?"No workers found matching your search":t!=null&&t.role_needed?`No workers found with "${t.role_needed}" skill`:"No available workers"}),(t==null?void 0:t.role_needed)&&!_&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:['Try adding "',t.role_needed,'" skill to workers or select a different shift.']})]}):e.jsx("ul",{children:i.map(m=>{const y=(B==null?void 0:B.id)===m.id,D=H[m.id]||Number(t.pay_rate)||0,U=H[m.id]&&H[m.id]!==(Number(t.pay_rate)||0);return e.jsxs("li",{className:`flex items-center justify-between px-4 py-3 border-b last:border-b-0 ${y?"bg-teal-50":"bg-white"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"w-8 h-8 rounded-full bg-teal-100 flex items-center justify-center text-teal-700 text-xs font-semibold",children:[m.first_name[0],m.last_name[0]]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[m.first_name," ",m.last_name]}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:(m.skills_json||[]).map((A,L)=>{const c=A===(t==null?void 0:t.role_needed);return e.jsx("span",{className:`px-2 py-0.5 text-xs rounded ${c?"bg-teal-100 text-teal-700 font-medium":"bg-gray-100 text-gray-600"}`,children:A},L)})})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[U&&e.jsx("span",{className:"text-xs text-amber-600 font-medium",children:"Custom"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ds,{className:"h-4 w-4 text-gray-400"}),e.jsx("input",{type:"number",step:"1",min:"0",placeholder:(Number(t.pay_rate)||0).toString(),value:D||"",onChange:A=>{const L=A.target.value;(L===""||/^\d*\.?\d*$/.test(L))&&V(m.id,parseFloat(L)||0)},className:"w-20 px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent",onMouseDown:A=>A.stopPropagation(),onFocus:A=>A.stopPropagation()}),e.jsx("span",{className:"text-xs text-gray-600",children:"/hr"})]}),e.jsx("button",{onClick:()=>X(m),className:`px-3 py-1.5 rounded-lg text-sm font-medium border ${y?"bg-teal-600 text-white border-teal-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:y?"Selected":"Select"})]})]},m.id)})})})]})]})})}function wt({isOpen:s,eventId:r,roleName:a,unfilledShiftIds:t,defaultPayRate:g,onClose:n,onDone:f}){const[i,u]=v.useState([]),[_,q]=v.useState([]),[B,X]=v.useState(""),[H,b]=v.useState(!1),[Q,S]=v.useState(!1),[$,I]=v.useState({}),[x,z]=v.useState(0),V=(w,m)=>{I(y=>({...y,[w]:m}))};v.useEffect(()=>{s&&(u([]),q([]),X(""),I({}),b(!0),(async()=>{var w,m;try{const D=((w=(await Y.get(`/events/${r}`)).data)==null?void 0:w.data)||{};console.log("QuickFill: Full event data:",JSON.stringify(D,null,2)),console.log("QuickFill: Looking for role:",a),console.log("QuickFill: shifts_by_role:",D.shifts_by_role);const U=new Set;if(D.shifts_by_role){const M=D.shifts_by_role.find(d=>(console.log("QuickFill: Checking role:",d.skill_name,d.role_name,"vs",a),d.skill_name===a||d.role_name===a));M?(console.log("QuickFill: Found role shifts:",M),M.shifts&&M.shifts.forEach(d=>{d.assignments&&(console.log("QuickFill: Shift has assignments:",d.assignments),d.assignments.forEach(h=>{var R;const T=h.worker_id||((R=h.worker)==null?void 0:R.id),j=h.status;T&&j!=="cancelled"&&(U.add(T),console.log("QuickFill: Adding worker_id to exclude:",T,"status:",j))}))})):console.log("QuickFill: No role shifts found for:",a)}console.log(`QuickFill: Found ${U.size} already assigned worker IDs:`,Array.from(U));const A=await Y.get("/workers?active=true"),c=(((m=A.data)==null?void 0:m.data)||A.data||[]).filter(M=>{const d=(M.skills_json||[]).includes(a),h=U.has(M.id);return h&&console.log(`QuickFill: Excluding ${M.first_name} ${M.last_name} (ID: ${M.id}) - already assigned`),d&&!h});if(console.log(`QuickFill: Found ${c.length} eligible workers for "${a}"`),console.log("QuickFill: Eligible workers:",c.map(M=>`${M.first_name} ${M.last_name}`)),u(c),g){const M=Number(g)||0;z(M),console.log(`QuickFill: Default pay rate for ${a}: $${M}/hr`)}else console.log(`QuickFill: No default pay rate provided for ${a}`)}catch(y){console.error("Error loading workers:",y)}finally{b(!1)}})())},[s,r,a,g]);const G=v.useMemo(()=>{const w=B.trim().toLowerCase(),m=i;return w?m.filter(y=>`${y.first_name} ${y.last_name}`.toLowerCase().includes(w)||(y.email||"").toLowerCase().includes(w)):m},[i,B]),J=t.length,C=w=>{q(m=>m.includes(w)?m.filter(y=>y!==w):m.length>=J?m:[...m,w])},O=async()=>{var D,U,A,L,c,M,d,h,T,j,R,o,E,F,se;if(_.length===0||J===0)return;S(!0);let w=0,m=0;const y=[];try{const te=_.map(ue=>i.find(ze=>ze.id===ue)).filter(Boolean),he=[...t];let je=0;for(;he.length>0&&te.length>0;){const ue=te[je%te.length],ze=he.shift();try{const de=$[ue.id]||Number(x)||0||0,ve=await Y.post("/staffing",{assignment:{shift_id:ze,worker_id:ue.id,status:"assigned",assigned_at_utc:new Date().toISOString(),hourly_rate:de}});if(((D=ve.data)==null?void 0:D.status)==="success")w+=1;else{m+=1;const oe=`${ue.first_name} ${ue.last_name}`,l=((U=ve.data)==null?void 0:U.message)||((L=(A=ve.data)==null?void 0:A.error)==null?void 0:L.message)||((M=(c=ve.data)==null?void 0:c.errors)==null?void 0:M.join(", "))||"Unknown error";let p="Unable to assign";const P=String(l).toLowerCase();P.includes("overlapping")||P.includes("conflict")?p="Has overlapping shift":P.includes("capacity")||P.includes("full")?p="Shift is full":P.includes("skill")||P.includes("certification")||P.includes("requirement")?p="Missing required skill":P.includes("status")?p="Cannot be assigned":p="Unable to assign",y.push(`${oe}: ${p}`)}}catch(de){m+=1;const ve=`${ue.first_name} ${ue.last_name}`;let oe="Unable to assign";const l=((h=(d=de.response)==null?void 0:d.data)==null?void 0:h.message)||((R=(j=(T=de.response)==null?void 0:T.data)==null?void 0:j.error)==null?void 0:R.message)||((F=(E=(o=de.response)==null?void 0:o.data)==null?void 0:E.errors)==null?void 0:F.join(", "))||null;if(l){const p=String(l).toLowerCase();p.includes("overlapping")||p.includes("conflict")?oe="Has overlapping shift":p.includes("capacity")||p.includes("full")?oe="Shift is full":p.includes("skill")||p.includes("certification")||p.includes("requirement")?oe="Missing required skill":p.includes("status")?oe="Cannot be assigned":oe="Unable to assign"}else((se=de.response)==null?void 0:se.status)===422?oe="Unable to assign":de.message&&!de.message.includes("status code")&&(oe=de.message);y.push(`${ve}: ${oe}`)}je+=1}let fe="";m>0&&y.length>0&&(fe=y.join(", ")),f({assigned:w,conflicts:m,details:fe})}finally{S(!1)}};if(!s)return null;const K=e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:n,disabled:Q,className:"btn-secondary",children:"Cancel"}),e.jsx("button",{onClick:O,disabled:Q||_.length===0||J===0,className:"btn-primary",children:Q?"Filling Shifts...":_.length===1?`Assign worker to ${J} shift${J!==1?"s":""}`:`Assign ${_.length} workers to ${J} shifts`})]});return e.jsxs(Ze,{isOpen:s,onClose:n,title:`Quick Fill â€” ${a}`,subtitle:`Unfilled shifts: ${J}`,size:"lg",footer:K,children:[e.jsxs("div",{className:"relative",children:[e.jsx(Ye,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx("input",{value:B,onChange:w=>X(w.target.value),placeholder:"Search eligible workersâ€¦",className:"w-full pl-9 pr-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500"})]}),e.jsx("div",{className:"max-h-[340px] overflow-y-auto border border-gray-200 rounded-lg",children:H?e.jsx("div",{className:"p-6 text-center text-gray-500",children:"Loadingâ€¦"}):G.length===0?e.jsx("div",{className:"p-6 text-center text-gray-500",children:"No eligible workers"}):e.jsx("ul",{children:G.map(w=>{const m=_.includes(w.id);return e.jsxs("li",{className:`flex items-center justify-between px-4 py-3 border-b last:border-b-0 ${m?"bg-teal-50":"bg-white"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"w-8 h-8 rounded-full bg-teal-100 flex items-center justify-center text-teal-700 text-xs font-semibold",children:[w.first_name[0],w.last_name[0]]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[w.first_name," ",w.last_name]}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:(w.skills_json||[]).map((y,D)=>{const U=y===a;return e.jsx("span",{className:`px-2 py-0.5 text-xs rounded ${U?"bg-teal-100 text-teal-700 font-medium":"bg-gray-100 text-gray-600"}`,children:y},D)})})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[$[w.id]&&$[w.id]!==(Number(x)||0)&&e.jsx("span",{className:"text-xs text-amber-600 font-medium",children:"Custom"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ds,{className:"h-4 w-4 text-gray-400"}),e.jsx("input",{type:"number",step:"1",min:"0",placeholder:Number(x)?(Number(x)||0).toString():"Rate",value:$[w.id]||Number(x)||0||"",onChange:y=>{const D=y.target.value;(D===""||/^\d*\.?\d*$/.test(D))&&V(w.id,parseFloat(D)||0)},className:"w-20 px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent",onMouseDown:y=>y.stopPropagation(),onFocus:y=>y.stopPropagation()}),e.jsx("span",{className:"text-xs text-gray-600",children:"/hr"})]}),e.jsx("button",{onClick:()=>C(w.id),disabled:!m&&_.length>=J,className:`px-3 py-1.5 rounded-lg text-sm font-medium border ${m?"bg-teal-600 text-white border-teal-600":_.length>=J?"bg-gray-100 text-gray-400 border-gray-200 cursor-not-allowed":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:m?"Selected":"Select"})]})]},w.id)})})}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[e.jsx(As,{size:16,className:"text-teal-600"}),e.jsxs("span",{children:["Will assign ",e.jsx("strong",{children:_.length})," worker",_.length!==1?"s":""," to ",e.jsx("strong",{children:J})," shift",J!==1?"s":"","."]})]}),(Number(x)||0)>0&&e.jsxs("div",{className:"border-t pt-4 mt-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-gray-600",children:["Default rate for ",a,":"]}),e.jsxs("span",{className:"font-medium",children:["$",(Number(x)||0).toFixed(2),"/hr"]})]}),Object.keys($).length>0&&e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["ðŸ’¡ Empty fields will use default rate ($",(Number(x)||0).toFixed(2),"/hr)"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[e.jsx(_s,{size:14,className:"text-yellow-600"}),"Conflicts and already-filled shifts will be skipped automatically."]})]})}function Nt({event:s,isOpen:r,onClose:a,onSuccess:t}){var c,M;const g=cs(),[n,f]=v.useState(!1),[i,u]=v.useState([]),[_,q]=v.useState(!1),[B,X]=v.useState(!1),[H,b]=v.useState(null),[Q,S]=v.useState(null),[$,I]=v.useState({isVisible:!1,message:"",type:"error"}),[x,z]=v.useState(null),[V,G]=v.useState(!1);v.useEffect(()=>{r&&s.id&&J()},[r,s.id]);const J=async()=>{X(!0);try{const d=await Y.get(`/events/${s.id}`);d.data.status==="success"&&b(d.data.data)}catch(d){console.error("Failed to load full event details:",d),b(s)}finally{X(!1)}},C=()=>{a(),g(`/events/${s.id}/edit`)},O=[{name:"Bartender",icon:Ms},{name:"Banquet Server/Runner",icon:Es},{name:"Captain",icon:Fs},{name:"Event Helper",icon:zs},{name:"Prep Cook",icon:Ps}],K=H||s,w=H||s;v.useEffect(()=>{if(K){if(K.skill_requirements&&Array.isArray(K.skill_requirements)){const d=K.skill_requirements.map(h=>{var R,o;const T=(R=K.shifts_by_role)==null?void 0:R.find(E=>(E.skill_name||E.role_name)===h.skill_name),j=((o=T==null?void 0:T.shifts)==null?void 0:o.length)||(T==null?void 0:T.total_shifts)||h.needed_workers||1;return{skill_name:h.skill_name,needed_workers:j,pay_rate:h.pay_rate||15,description:h.description||"",uniform_id:void 0,cert_id:void 0}});u(d)}else if(K.shifts_by_role&&Array.isArray(K.shifts_by_role)){const d=K.shifts_by_role.map(h=>{const T=h.shifts?h.shifts.length:h.total_shifts||1;return{skill_name:h.skill_name||h.role_name||"",needed_workers:T,pay_rate:h.pay_rate||15,description:"",uniform_id:void 0,cert_id:void 0}});u(d)}}},[K]),v.useEffect(()=>{const d=H||s;d!=null&&d.schedule&&z({start_time_utc:d.schedule.start_time_utc,end_time_utc:d.schedule.end_time_utc,break_minutes:d.schedule.break_minutes||0})},[H,s]);const m=(d,h,T)=>{if(d<0||d>=i.length)return;const j=[...i];j[d]={...j[d],[h]:T},u(j)},y=()=>{u([...i,{skill_name:"",needed_workers:1,pay_rate:15,description:"",uniform_id:void 0,cert_id:void 0}])},D=d=>{var T;if(d<0||d>=i.length)return;const h=i[d];if((h==null?void 0:h.needed_workers)>0){const j=(T=w==null?void 0:w.shifts_by_role)==null?void 0:T[d];if(((j==null?void 0:j.assigned_workers)||(j==null?void 0:j.filled_shifts)||0)>0){I({isVisible:!0,message:"Cannot remove role with assigned workers. Please unassign workers first.",type:"error"});return}}u(i.filter((j,R)=>R!==d))},U=(d,h)=>{if(d<0||d>=i.length)return;O.find(j=>j.name===h);const T=[...i];T[d]={...T[d],skill_name:h},u(T),S(null)},A=async()=>{var h,T,j;const d=H||s;if(d.schedule&&new Date(d.schedule.start_time_utc)<=new Date){I({isVisible:!0,message:"Cannot edit event that has already started",type:"error"});return}q(!0);try{const R=H||s,o=await Y.patch(`/events/${R.id}`,{event:{roles:i.map(E=>({skill_name:E.skill_name,needed:E.needed_workers,pay_rate:E.pay_rate,description:E.description,uniform_id:E.uniform_id,cert_id:E.cert_id})),schedule:x?{start_time_utc:x.start_time_utc,end_time_utc:x.end_time_utc,break_minutes:x.break_minutes}:R.schedule?{start_time_utc:R.schedule.start_time_utc,end_time_utc:R.schedule.end_time_utc,break_minutes:R.schedule.break_minutes||0}:void 0}});o.data.status==="success"?(I({isVisible:!0,message:o.data.message||"Event updated successfully",type:"success"}),t(),a()):I({isVisible:!0,message:o.data.message||"Failed to update event",type:"error"})}catch(R){console.error("Failed to update event:",R);const o=(h=R==null?void 0:R.response)==null?void 0:h.data;if((o==null?void 0:o.status)==="validation_error"&&((j=(T=o==null?void 0:o.data)==null?void 0:T.conflicts)!=null&&j.length)){const E=o.data.conflicts.map(F=>{const se=new Date(F.conflicting_shift_start_time_utc).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"}),te=new Date(F.conflicting_shift_end_time_utc).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"});return`${F.worker_name} conflicts with ${F.conflicting_event_title} (${se} â€“ ${te})`});I({isVisible:!0,message:`Can't save changes: ${E.length} worker${E.length!==1?"s":""} would be double-booked
â€¢ `+E.join(`
â€¢ `),type:"error"})}else I({isVisible:!0,message:(o==null?void 0:o.message)||"Failed to update event",type:"error"})}finally{q(!1)}},L=e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:a,disabled:_,className:"btn-secondary",children:"Cancel"}),e.jsx("button",{onClick:A,disabled:_,className:"btn-primary",children:_?"Saving...":"Save Changes"})]});return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-0 sm:p-4 overflow-y-auto",children:e.jsxs("div",{className:"bg-white w-full h-full sm:h-auto sm:max-w-4xl sm:rounded-lg shadow-xl overflow-hidden flex flex-col sm:max-h-[90vh]",children:[e.jsxs("div",{className:"sticky top-0 bg-white px-4 sm:px-6 py-4 border-b border-gray-200 flex items-center justify-between z-10",children:[e.jsxs("h2",{className:"text-lg sm:text-xl md:text-2xl font-bold text-gray-900 truncate",children:["Edit Event: ",w.title]}),e.jsx("button",{onClick:a,className:"p-2 text-gray-400 hover:text-gray-600 min-h-touch min-w-touch","aria-label":"Close",children:e.jsx(be,{className:"h-5 w-5 sm:h-6 sm:w-6"})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto px-4 sm:px-6 py-4 space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 p-6 rounded-xl border border-gray-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-5",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"Event Details"}),e.jsxs("button",{onClick:C,className:"inline-flex items-center gap-1.5 px-3 py-1.5 bg-white border border-gray-300 text-sm font-medium text-gray-700 rounded-lg hover:bg-gray-50 hover:border-gray-400 transition-all shadow-sm",children:[e.jsx(ms,{size:14}),"Edit"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:"Venue"}),e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:(c=w.venue)==null?void 0:c.name})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:"Date"}),e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:w.schedule&&new Date(w.schedule.start_time_utc).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric"})})]}),e.jsxs("div",{className:"space-y-1 md:col-span-2",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:"Location"}),e.jsx("p",{className:"text-sm font-semibold text-gray-900 leading-relaxed",children:(M=w.venue)==null?void 0:M.formatted_address})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:"Time"}),e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:w.schedule&&e.jsxs(e.Fragment,{children:[new Date(w.schedule.start_time_utc).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})," - ",new Date(w.schedule.end_time_utc).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})]})})]}),e.jsx("div",{})]})]}),e.jsxs("div",{className:"col-span-2 bg-gray-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 uppercase tracking-wide",children:"Event Schedule"}),e.jsx("button",{type:"button",onClick:()=>G(!V),className:"text-sm text-blue-600 hover:text-blue-800 font-medium",children:V?"Cancel":"Edit Schedule"})]}),V?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Start Time"}),e.jsx("input",{type:"datetime-local",value:x!=null&&x.start_time_utc?new Date(x.start_time_utc).toISOString().slice(0,16):"",onChange:d=>z(h=>h?{...h,start_time_utc:new Date(d.target.value).toISOString()}:null),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"End Time"}),e.jsx("input",{type:"datetime-local",value:x!=null&&x.end_time_utc?new Date(x.end_time_utc).toISOString().slice(0,16):"",onChange:d=>z(h=>h?{...h,end_time_utc:new Date(d.target.value).toISOString()}:null),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Break Minutes"}),e.jsx("input",{type:"number",min:"0",value:(x==null?void 0:x.break_minutes)||0,onChange:d=>z(h=>h?{...h,break_minutes:parseInt(d.target.value)||0}:null),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm"})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-3",children:e.jsx("p",{className:"text-xs text-blue-800",children:"âš ï¸ Changing schedule times will update ALL shifts and worker schedules for this event."})})]}):e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Date"}),e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:w.schedule&&new Date(w.schedule.start_time_utc).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric"})})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Time"}),e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:x&&e.jsxs(e.Fragment,{children:[new Date(x.start_time_utc).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})," -",new Date(x.end_time_utc).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})]})})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Break"}),e.jsxs("p",{className:"text-sm font-semibold text-gray-900",children:[(x==null?void 0:x.break_minutes)||0," minutes"]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-base font-semibold text-gray-900",children:"Roles"}),e.jsxs("button",{onClick:y,className:"inline-flex items-center gap-2 px-4 py-2 bg-teal-600 text-white text-sm font-semibold rounded-lg hover:bg-teal-700 transition-colors shadow-sm",children:[e.jsx(ss,{size:16}),"Add Role"]})]}),i.map((d,h)=>{var T;return e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start gap-4 mb-3",children:[e.jsxs("div",{className:"flex-1 relative overflow-visible",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Role Name *"}),e.jsxs("div",{className:"relative",style:{zIndex:Q===h?1e3:1},children:[e.jsxs("button",{type:"button",onClick:()=>S(Q===h?null:h),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500 bg-white text-left flex items-center justify-between",children:[d.skill_name?e.jsxs("div",{className:"flex items-center gap-2",children:[((T=O.find(j=>j.name===d.skill_name))==null?void 0:T.icon)&&e.jsx("img",{src:O.find(j=>j.name===d.skill_name).icon,alt:d.skill_name,className:"w-5 h-5"}),e.jsx("span",{className:"text-gray-900",children:d.skill_name})]}):e.jsx("span",{className:"text-gray-400",children:"Pick the Skills the Worker Has"}),e.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{d:"M19 9l-7 7-7-7"})})]}),Q===h&&e.jsx("div",{className:"absolute top-full left-0 right-0 mt-2 bg-white border-2 border-gray-200 rounded-xl shadow-2xl z-[9999] max-h-[300px] overflow-y-auto w-full min-w-max",children:O.filter(j=>!i.some((R,o)=>o!==h&&R.skill_name===j.name)).map(j=>e.jsxs("div",{onClick:()=>U(h,j.name),className:"flex items-center gap-3 px-4 py-3 cursor-pointer hover:bg-teal-50 border-b border-gray-100 last:border-0",children:[e.jsx("img",{src:j.icon,width:"24",height:"24",alt:j.name,className:"flex-shrink-0"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:j.name})]},j.name))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Needed Workers *"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>m(h,"needed_workers",Math.max(1,d.needed_workers-1)),className:"w-8 h-8 flex items-center justify-center border border-gray-300 bg-white hover:bg-gray-50 rounded-lg transition-colors font-semibold text-gray-700",children:"-"}),e.jsx("input",{type:"number",value:d.needed_workers,onChange:j=>m(h,"needed_workers",parseInt(j.target.value)||1),min:"1",className:"w-16 px-2 py-2 border border-gray-300 rounded-lg text-center focus:outline-none focus:ring-2 focus:ring-teal-500 font-medium"}),e.jsx("button",{onClick:()=>m(h,"needed_workers",d.needed_workers+1),className:"w-8 h-8 flex items-center justify-center border border-gray-300 bg-white hover:bg-gray-50 rounded-lg transition-colors font-semibold text-gray-700",children:"+"}),e.jsx("button",{onClick:()=>D(h),className:"ml-2 w-8 h-8 flex items-center justify-center text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Remove role",children:e.jsx(Ie,{size:18})})]})]})]}),(()=>{var o;const j=(o=w==null?void 0:w.shifts_by_role)==null?void 0:o[h],R=(j==null?void 0:j.assigned_workers)||(j==null?void 0:j.filled_shifts)||0;return R>0?e.jsxs("div",{className:"text-sm text-amber-600 font-semibold bg-amber-50 px-3 py-2 rounded-lg",children:[R," worker(s) assigned"]}):null})()]},h)})]})]}),e.jsx("div",{className:"sticky bottom-0 bg-white px-4 sm:px-6 py-4 border-t border-gray-200 flex flex-col sm:flex-row gap-3 sm:justify-end z-10",children:L})]})}),e.jsx(es,{isVisible:$.isVisible,message:$.message,type:$.type,onClose:()=>I({...$,isVisible:!1})})]})}function kt({assignment:s,isEditing:r,editHours:a,isSavingEdit:t,onStartEdit:g,onSaveEdit:n,onCancelEdit:f,onEditHoursChange:i,onEditKeyDown:u,calculateLiveTotal:_,onNoShow:q,onRemove:B,onReEdit:X}){const[H,b]=v.useState(!1),Q=$=>{if(!$)return"";try{const I=ge($);return ye(I,"MMM d, yyyy h:mm a")}catch{return new Date($).toLocaleString()}},S=s.approved;return e.jsxs(e.Fragment,{children:[e.jsxs("tr",{className:Ae("hidden sm:table-row group transition-all duration-150 ease-in-out",S&&"bg-green-50/30",!S&&!r&&s.status==="no_show"&&"bg-red-50/30",!S&&!r&&s.status==="cancelled"&&"bg-gray-50/30",!S&&!r&&"hover:bg-gray-50",r&&"bg-blue-50 ring-2 ring-blue-500 ring-offset-2"),onMouseEnter:()=>b(!0),onMouseLeave:()=>b(!1),children:[e.jsxs("td",{className:"py-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-8 w-8 rounded-full bg-gray-100 flex items-center justify-center flex-shrink-0",children:e.jsx(Ls,{className:"h-4 w-4 text-gray-600"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"font-medium text-gray-900 truncate",children:s.worker_name}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Scheduled: ",ee(s.scheduled_hours,2,"0.00"),"h"]})]})]}),s.approved&&s.approved_by_name&&e.jsxs("div",{className:"mt-2 text-xs text-gray-500 ml-11",children:["Approved by ",s.approved_by_name," on ",Q(s.approved_at)]})]}),e.jsx("td",{className:"py-4 text-sm text-gray-700",children:s.shift_role||"N/A"}),e.jsx("td",{className:"py-4 text-right",children:r?e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[e.jsx("input",{type:"number",step:"0.25",min:"0",max:"24",value:a,onChange:$=>i($.target.value),onKeyDown:u,disabled:t,className:"w-20 px-2 py-1 border-2 border-blue-500 rounded text-sm font-medium text-gray-900 text-right focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:border-blue-500 disabled:bg-gray-100 disabled:cursor-not-allowed",autoFocus:!0,placeholder:"0.0"}),e.jsx("span",{className:"text-xs text-gray-500",children:"h"})]}):e.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[ee(s.effective_hours,2,"0.00"),"h",s.edited_at&&e.jsx("span",{className:"ml-1 text-xs text-orange-600",title:"Edited",children:e.jsx(Le,{className:"h-3 w-3 inline"})})]})}),e.jsxs("td",{className:"py-4 text-right text-sm text-gray-700",children:["$",ee(s.effective_hourly_rate,2,"0.00"),"/h"]}),e.jsxs("td",{className:"py-4 text-right",children:[e.jsxs("span",{className:Ae("text-sm font-semibold",r?"text-blue-600":"text-gray-900"),children:["$",r?_(a,s.effective_hourly_rate||0):ee(s.effective_pay,2,"0.00")]}),r&&e.jsx("div",{className:"text-xs text-blue-600 mt-0.5",children:"live preview"})]}),e.jsx("td",{className:"py-4 text-right",children:r?e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[e.jsx("button",{onClick:n,disabled:t,className:"p-1.5 text-white bg-green-600 hover:bg-green-700 disabled:bg-green-400 rounded transition-colors",title:"Save changes (Enter)",children:t?e.jsx(Ge,{className:"h-4 w-4 animate-spin"}):e.jsx(Ne,{className:"h-4 w-4"})}),e.jsx("button",{onClick:f,disabled:t,className:"p-1.5 text-gray-600 hover:bg-gray-100 disabled:opacity-50 rounded transition-colors",title:"Cancel (Esc)",children:e.jsx(be,{className:"h-4 w-4"})})]}):e.jsx("div",{className:"flex items-center justify-end gap-2",children:s.status==="no_show"?e.jsx(e.Fragment,{children:e.jsxs("span",{className:"inline-flex items-center gap-1 text-xs font-medium text-red-700",children:[e.jsx(as,{className:"h-3.5 w-3.5"}),"No-Show"]})}):s.status==="cancelled"?e.jsx(e.Fragment,{children:e.jsxs("span",{className:"inline-flex items-center gap-1 text-xs font-medium text-gray-700",children:[e.jsx(be,{className:"h-3.5 w-3.5"}),"Cancelled"]})}):S?e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"inline-flex items-center gap-1 text-xs font-medium text-green-700",children:[e.jsx(Ne,{className:"h-3.5 w-3.5"}),"Approved"]}),s.can_edit_hours&&e.jsx("button",{onClick:()=>X(s),className:`text-xs text-gray-600 hover:text-gray-900 transition-all duration-200 ease-in-out ${H?"opacity-100":"opacity-0"}`,title:"Re-edit approved hours",children:"Re-edit"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium text-amber-700 bg-amber-50 rounded",children:[e.jsx(Me,{className:"h-3.5 w-3.5"}),"Pending"]}),s.can_edit_hours&&e.jsxs("div",{className:`flex items-center gap-1 transition-all duration-200 ease-in-out ${H?"opacity-100":"opacity-0"}`,children:[e.jsx("button",{onClick:()=>g(s),className:"p-1.5 text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded transition-all duration-200 ease-in-out",title:"Edit hours",children:e.jsx(Le,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>q(s),className:"p-1.5 text-gray-600 hover:text-orange-600 hover:bg-orange-50 rounded transition-all duration-200 ease-in-out",title:"Mark no-show",children:e.jsx(ke,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>B(s),className:"p-1.5 text-gray-600 hover:text-red-600 hover:bg-red-50 rounded transition-all duration-200 ease-in-out",title:"Remove worker",children:e.jsx(Ie,{className:"h-4 w-4"})})]})]})})})]}),e.jsx("tr",{className:"sm:hidden",children:e.jsx("td",{colSpan:6,className:"py-3 px-3",children:e.jsxs("div",{className:Ae("p-3 rounded-lg space-y-2 transition-all duration-150",r&&"bg-blue-50 border-2 border-blue-500",!r&&S&&"bg-green-50 border border-green-200",!r&&s.status==="no_show"&&"bg-red-50 border border-red-200",!r&&s.status==="cancelled"&&"bg-gray-50 border border-gray-200",!r&&"bg-white border border-gray-200"),children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-gray-900",children:s.worker_name}),e.jsx("div",{className:"text-xs text-gray-500",children:s.shift_role||"N/A"}),s.approved&&s.approved_by_name&&e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Approved by ",s.approved_by_name," on ",Q(s.approved_at)]})]}),s.approved?e.jsxs("span",{className:"inline-flex items-center gap-1 text-xs font-medium text-green-700",children:[e.jsx(Ne,{className:"h-3.5 w-3.5"}),"Approved"]}):s.status==="no_show"?e.jsxs("span",{className:"inline-flex items-center gap-1 text-xs font-medium text-red-700",children:[e.jsx(as,{className:"h-3.5 w-3.5"}),"No-Show"]}):s.status==="cancelled"?e.jsxs("span",{className:"inline-flex items-center gap-1 text-xs font-medium text-gray-700",children:[e.jsx(be,{className:"h-3.5 w-3.5"}),"Cancelled"]}):e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium text-amber-700 bg-amber-50 rounded",children:[e.jsx(Me,{className:"h-3.5 w-3.5"}),"Pending"]})]}),r?e.jsxs("div",{className:"space-y-2 pt-2 border-t border-gray-200",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600 block mb-1",children:"Hours Worked"}),e.jsx("input",{type:"number",step:"0.25",min:"0",max:"24",value:a,onChange:$=>i($.target.value),onKeyDown:u,disabled:t,className:"w-full px-3 py-2 border-2 border-blue-500 rounded text-sm font-medium focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100",autoFocus:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Rate:"}),e.jsxs("span",{className:"ml-1 font-medium",children:["$",ee(s.effective_hourly_rate,2,"0.00"),"/h"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Total:"}),e.jsxs("span",{className:"ml-1 font-semibold text-blue-600",children:["$",_(a,s.effective_hourly_rate||0)]})]})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx("button",{onClick:n,disabled:t,className:"flex-1 px-3 py-2 bg-green-600 hover:bg-green-700 disabled:bg-green-400 text-white text-sm font-medium rounded flex items-center justify-center gap-2 transition-colors",children:t?e.jsxs(e.Fragment,{children:[e.jsx(Ge,{className:"h-4 w-4 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ne,{className:"h-4 w-4"}),"Save"]})}),e.jsx("button",{onClick:f,disabled:t,className:"px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 disabled:opacity-50 text-sm font-medium rounded transition-colors",children:"Cancel"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-sm pt-2 border-t border-gray-200",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Hours"}),e.jsxs("div",{className:"font-medium",children:[ee(s.effective_hours,2,"0.00"),"h",s.edited_at&&e.jsx("span",{className:"ml-1 text-xs text-orange-600",title:"Edited",children:e.jsx(Le,{className:"h-3 w-3 inline"})})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Rate"}),e.jsxs("div",{className:"font-medium",children:["$",ee(s.effective_hourly_rate,2,"0.00"),"/h"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Total"}),e.jsxs("div",{className:"font-semibold",children:["$",ee(s.effective_pay,2,"0.00")]})]})]}),s.can_edit_hours&&s.status!=="no_show"&&s.status!=="cancelled"&&e.jsx("div",{className:"flex items-center gap-2 pt-2 border-t border-gray-200",children:s.approved?e.jsx("button",{onClick:()=>X(s),className:"w-full px-3 py-1.5 text-xs font-medium text-gray-700 bg-gray-100 rounded hover:bg-gray-200 transition-colors",children:"Re-edit"}):e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>g(s),className:"flex-1 px-3 py-1.5 text-xs font-medium text-blue-700 bg-blue-50 rounded hover:bg-blue-100 transition-colors flex items-center justify-center gap-1",children:[e.jsx(Le,{className:"h-3.5 w-3.5"}),"Edit"]}),e.jsxs("button",{onClick:()=>q(s),className:"flex-1 px-3 py-1.5 text-xs font-medium text-orange-700 bg-orange-50 rounded hover:bg-orange-100 transition-colors flex items-center justify-center gap-1",children:[e.jsx(ke,{className:"h-3.5 w-3.5"}),"No-Show"]}),e.jsx("button",{onClick:()=>B(s),className:"px-3 py-1.5 text-xs font-medium text-red-700 bg-red-50 rounded hover:bg-red-100 transition-colors",children:e.jsx(Ie,{className:"h-3.5 w-3.5"})})]})})]})]})})})]})}function _t({event:s,isOpen:r,onClose:a,onSuccess:t}){const[g,n]=v.useState([]),[f,i]=v.useState(null),[u,_]=v.useState(!1),[q,B]=v.useState(null),[X,H]=v.useState(""),[b,Q]=v.useState(!1),[S,$]=v.useState(!1),[I,x]=v.useState({isVisible:!1,message:"",type:"success"}),[z,V]=v.useState({open:!1,title:"",variant:"default"});v.useEffect(()=>{r&&s&&G()},[r,s]);const G=async()=>{var o,E;if(s!=null&&s.id){_(!0);try{const F=await Y.get(`/events/${s.id}/approvals`);n(F.data.data.assignments||[]),i(F.data.data.cost_summary||null)}catch(F){console.error("Error loading assignments:",F),x({isVisible:!0,type:"error",message:((E=(o=F.response)==null?void 0:o.data)==null?void 0:E.error)||F.message||"Unable to load assignments for approval"}),n([]),i(null)}finally{_(!1)}}},J=o=>{B(o.id),H(String(o.effective_hours||o.hours_worked||o.scheduled_hours||"0"))},C=()=>{B(null),H("")},O=async()=>{var E,F,se;if(!q)return;const o=parseFloat(X);if(isNaN(o)||o<0){x({isVisible:!0,type:"error",message:"Please enter a valid number of hours"});return}if(o>24){x({isVisible:!0,type:"error",message:"Hours cannot exceed 24 per shift"});return}Q(!0);try{const te=await Y.patch(`/approvals/${q}/update_hours`,{hours_worked:o});await G(),C(),(E=te.data)!=null&&E.message?x({isVisible:!0,type:"success",message:te.data.message}):x({isVisible:!0,type:"success",message:"Hours updated successfully"})}catch(te){console.error("Error updating hours:",te),x({isVisible:!0,type:"error",message:((se=(F=te.response)==null?void 0:F.data)==null?void 0:se.message)||"Failed to update hours. Please try again."})}finally{Q(!1)}},K=o=>{o.key==="Enter"?(o.preventDefault(),O()):o.key==="Escape"&&(o.preventDefault(),C())},w=(o,E)=>{const F=parseFloat(o);return isNaN(F)?"0.00":(F*E).toFixed(2)},m=o=>{V({open:!0,title:"Re-Edit Approved Hours",message:`Re-editing will un-approve ${o.worker_name}'s hours. The assignment will need to be re-approved after you make changes. Continue?`,variant:"warning",onConfirm:async()=>{V({open:!1,title:""}),J(o),x({isVisible:!0,type:"success",message:"Hours un-approved. Make your changes and save."})}})},y=async o=>{V({open:!0,title:"Mark No-Show",message:`Mark ${o.worker_name} as no-show? This will set hours to 0.`,requireNote:!0,note:"",variant:"warning",onConfirm:async()=>{var E,F;try{await Y.post(`/approvals/${o.id}/mark_no_show`,{notes:z.note}),await G(),x({isVisible:!0,type:"success",message:"Marked as no-show"})}catch(se){console.error("Error marking no-show:",se),x({isVisible:!0,type:"error",message:((F=(E=se.response)==null?void 0:E.data)==null?void 0:F.message)||"Failed to mark no-show"})}finally{V({open:!1,title:""})}}})},D=async o=>{V({open:!0,title:"Remove from Job",message:`Remove ${o.worker_name} from this job? This cannot be undone.`,requireNote:!0,note:"",variant:"danger",onConfirm:async()=>{var E,F;try{await Y.delete(`/approvals/${o.id}/remove`,{data:{notes:z.note}}),await G(),x({isVisible:!0,type:"success",message:"Assignment removed"})}catch(se){console.error("Error removing assignment:",se),x({isVisible:!0,type:"error",message:((F=(E=se.response)==null?void 0:E.data)==null?void 0:F.message)||"Failed to remove assignment"})}finally{V({open:!1,title:""})}}})},U=async()=>{const o=g.filter(E=>!E.approved&&E.can_approve&&E.status!=="no_show").length;V({open:!0,title:"Approve All Hours",message:`Approve hours for all ${o} eligible workers?`,onConfirm:async()=>{var E,F;$(!0);try{await Y.post(`/events/${s.id}/approve_all`),await G(),t(),x({isVisible:!0,type:"success",message:`Approved ${o} assignments`})}catch(se){console.error("Error approving all:",se),x({isVisible:!0,type:"error",message:((F=(E=se.response)==null?void 0:E.data)==null?void 0:F.message)||"Failed to approve all hours"})}finally{$(!1),V({open:!1,title:""})}}})};if(!r)return null;const A=g.filter(o=>o.status!=="no_show"&&o.status!=="cancelled"),L=A.filter(o=>!o.approved).length,c=A.filter(o=>o.approved).length,M=A.length,d=A.filter(o=>!o.approved).reduce((o,E)=>o+Number(E.effective_pay||0),0),h=A.filter(o=>o.approved).reduce((o,E)=>o+Number(E.effective_pay||0),0),T=d+h,j=A.reduce((o,E)=>o+Number(E.effective_hours||0),0),R=o=>{if(!o)return"";try{return ye(ge(o),"MMM d, yyyy")}catch{return new Date(o).toLocaleDateString()}};return e.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-0 sm:p-4 overflow-y-auto",children:[e.jsx(es,{isVisible:I.isVisible,message:I.message,type:I.type,onClose:()=>x({...I,isVisible:!1})}),e.jsxs("div",{className:"bg-white w-full h-full sm:h-auto sm:max-w-5xl sm:rounded-lg shadow-xl overflow-hidden flex flex-col sm:max-h-[90vh] my-0 sm:my-4",children:[e.jsx("header",{className:"border-b px-6 py-4 bg-white flex-shrink-0",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Approve Hours"}),e.jsxs("p",{className:"text-sm text-gray-500 mt-0.5",children:[s==null?void 0:s.title," Â· ",s!=null&&s.event_date?R(s.event_date):""]})]}),e.jsx("button",{onClick:a,className:"text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Close modal",children:e.jsx(be,{className:"h-5 w-5"})})]})}),L>0&&e.jsx("div",{className:"bg-amber-50 border-l-4 border-amber-400 px-6 py-3 flex-shrink-0",children:e.jsxs("p",{className:"text-sm text-amber-800 flex items-center gap-2",children:[e.jsx(ke,{className:"h-4 w-4"}),e.jsx("strong",{children:L})," ",L===1?"assignment":"assignments"," pending approval"]})}),e.jsx("div",{className:"flex-1 overflow-auto px-3 sm:px-6 py-4",children:u?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading assignments..."})]}):g.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ke,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"No assignments found for this event."})]}):e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"border-b border-gray-200 hidden sm:table-header-group",children:e.jsxs("tr",{className:"text-left",children:[e.jsx("th",{className:"pb-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Worker"}),e.jsx("th",{className:"pb-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),e.jsx("th",{className:"pb-3 text-xs font-medium text-gray-500 uppercase tracking-wider text-right",children:"Hours"}),e.jsx("th",{className:"pb-3 text-xs font-medium text-gray-500 uppercase tracking-wider text-right",children:"Rate"}),e.jsx("th",{className:"pb-3 text-xs font-medium text-gray-500 uppercase tracking-wider text-right",children:"Total"}),e.jsx("th",{className:"pb-3 text-xs font-medium text-gray-500 uppercase tracking-wider text-right",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:g.map(o=>e.jsx(kt,{assignment:o,isEditing:q===o.id,editHours:X,isSavingEdit:b,onStartEdit:J,onSaveEdit:O,onCancelEdit:C,onEditHoursChange:H,onEditKeyDown:K,calculateLiveTotal:w,onNoShow:y,onRemove:D,onReEdit:m},o.id))})]})}),e.jsxs("footer",{className:"border-t bg-gray-50 px-3 sm:px-6 py-4 flex-shrink-0",children:[L>0&&c>0?e.jsxs("div",{className:"mb-4 space-y-1.5 text-sm",children:[e.jsxs("div",{className:"flex justify-between text-gray-600",children:[e.jsx("span",{children:"Pending approval:"}),e.jsxs("span",{className:"font-medium",children:["$",ee(d,2,"0.00")," (",L," ",L===1?"worker":"workers",")"]})]}),e.jsxs("div",{className:"flex justify-between text-gray-600",children:[e.jsx("span",{children:"Approved:"}),e.jsxs("span",{className:"font-medium",children:["$",ee(h,2,"0.00")," (",c," ",c===1?"worker":"workers",")"]})]}),e.jsxs("div",{className:"pt-2 border-t border-gray-200 flex justify-between text-gray-900",children:[e.jsx("span",{className:"font-semibold",children:"Total:"}),e.jsxs("span",{className:"font-semibold",children:["$",ee(T,2,"0.00")," (",M," workers, ",ee(j,2,"0.00"),"h)"]})]})]}):L===0&&c>0?e.jsxs("div",{className:"mb-4 flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Final approved cost:"}),e.jsxs("span",{className:"text-lg font-bold text-green-600",children:["$",ee(h,2,"0.00")]})]}):e.jsxs("div",{className:"mb-4 flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Total cost:"}),e.jsxs("span",{className:"text-lg font-bold text-gray-900",children:["$",ee(T,2,"0.00")," (",M," workers, ",ee(j,2,"0.00"),"h)"]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center justify-end gap-3",children:[e.jsx("button",{onClick:a,className:"px-4 py-2 text-sm font-medium text-gray-700 hover:text-gray-900 transition-all duration-200 ease-in-out",children:"Close"}),L>0&&e.jsx("button",{onClick:U,disabled:S,className:"px-4 py-2 bg-green-600 hover:bg-green-700 disabled:bg-green-400 text-white text-sm font-medium rounded-lg shadow-sm flex items-center justify-center gap-2 transition-all duration-200 ease-in-out",children:S?e.jsxs(e.Fragment,{children:[e.jsx(Ge,{className:"h-4 w-4 animate-spin"}),"Approving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ne,{className:"h-4 w-4"}),"Approve All (",L,")"]})})]})]})]}),z.open&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>V({open:!1,title:""})}),e.jsxs("div",{className:"relative bg-white w-full max-w-md rounded-lg shadow-xl p-5",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:z.title}),z.message&&e.jsx("p",{className:"mt-2 text-sm text-gray-700",children:z.message}),z.requireNote&&e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Notes (optional)"}),e.jsx("textarea",{value:z.note||"",onChange:o=>V(E=>({...E,note:o.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:3})]}),e.jsxs("div",{className:"mt-5 flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>V({open:!1,title:""}),className:"px-4 py-2 bg-gray-100 text-gray-700 text-sm font-medium rounded-md hover:bg-gray-200",children:"Cancel"}),e.jsx("button",{onClick:async()=>{var o;await((o=z.onConfirm)==null?void 0:o.call(z))},className:"px-4 py-2 text-white text-sm font-medium rounded-md "+(z.variant==="danger"?"bg-red-600 hover:bg-red-700":z.variant==="warning"?"bg-yellow-600 hover:bg-yellow-700":"bg-blue-600 hover:bg-blue-700"),children:"Confirm"})]})]})]})]})}function ce({className:s="",count:r=1}){return e.jsx(e.Fragment,{children:Array.from({length:r}).map((a,t)=>e.jsx("div",{className:`animate-pulse bg-gray-200 rounded-lg ${s}`},t))})}function He(){return e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(ce,{className:"h-6 w-48 mb-2"}),e.jsx(ce,{className:"h-4 w-32"})]}),e.jsx(ce,{className:"h-8 w-8 rounded-full"})]}),e.jsxs("div",{className:"space-y-3 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ce,{className:"h-4 w-4 rounded"}),e.jsx(ce,{className:"h-4 w-40"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ce,{className:"h-4 w-4 rounded"}),e.jsx(ce,{className:"h-4 w-36"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ce,{className:"h-4 w-4 rounded"}),e.jsx(ce,{className:"h-4 w-32"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(ce,{className:"h-2 w-full rounded-full mb-2"}),e.jsx(ce,{className:"h-3 w-24"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ce,{className:"h-9 w-24 rounded-md"}),e.jsx(ce,{className:"h-9 w-24 rounded-md"})]})]})})}function Ct(s,r=500){const[a,t]=v.useState(s);return v.useEffect(()=>{const g=setTimeout(()=>{t(s)},r);return()=>{clearTimeout(g)}},[s,r]),a}function Jt(){const s=cs(),[r,a]=Ss(),t=(r.get("tab")==="completed"?"completed":r.get("tab"))||"active",g=r.get("filter")||"needs_workers",[n,f]=v.useState(t),[i,u]=v.useState(g),[_,q]=v.useState(""),B=Ct(_,500),[X,H]=v.useState("date"),[b,Q]=v.useState(!0),[S,$]=v.useState([]),[I,x]=v.useState(new Set),[z,V]=v.useState({isOpen:!1}),[G,J]=v.useState({isOpen:!1}),[C,O]=v.useState({isVisible:!1,message:"",type:"success"}),[K,w]=v.useState({isOpen:!1,isLoading:!1}),[m,y]=v.useState({isOpen:!1,isLoading:!1}),[D,U]=v.useState({isOpen:!1,isLoading:!1}),[A,L]=v.useState({isOpen:!1,unfilledShiftIds:[]}),[c,M]=v.useState({isOpen:!1});v.useEffect(()=>{d()},[n,i,r]),v.useEffect(()=>{const l=(r.get("tab")==="completed"?"completed":r.get("tab"))||"active",p=r.get("filter")||"all";l!==n&&f(l),p!==i&&u(p)},[r,n,i]),v.useEffect(()=>{const l=r.get("event_id"),p=r.get("shift_id");if(l){const P=parseInt(l);isNaN(P)||(x(new Set([P])),p&&console.log(`Auto-expanding event ${P} with shift ${p}`))}},[r]),v.useEffect(()=>{const l=r.get("event_id");if(!l)return;const p=parseInt(l);if(isNaN(p))return;const P=S.find(Z=>Z.id===p);P&&(!P.shifts_by_role||P.shifts_by_role.length===0)&&(j(p),x(new Set([p])))},[r,S]);async function d(){Q(!0);try{const l=n==="completed"?"completed":n,p=r.get("date");let P=`/events?tab=${l}`;i!=="all"&&(P+=`&filter=${i}`),p&&(P+=`&date=${p}`),console.log("Loading events with URL:",P,"filterStatus:",i,"date:",p);const Z=await Y.get(P);if(Z.data.status==="success"){console.log("Received events:",Z.data.data.length);const xe=Z.data.data;if(n==="completed"){const le=await Promise.all(xe.map(async ne=>{var me;try{const re=await Y.get(`/events/${ne.id}/approvals`);if(((me=re.data)==null?void 0:me.status)==="success"){const ie=re.data.data.assignments||[],Ce=ie.length,Se=ie.filter(ks=>ks.approved).length,Ns=re.data.data.cost_summary||null;return{...ne,approval_status:{total:Ce,approved:Se,pending:Ce-Se},cost_summary:Ns}}}catch(re){console.warn(`Failed to load approval status for event ${ne.id}:`,re)}return ne}));$(le)}else{const le=Array.from(I);$(ne=>{const me=new Map(ne.map(re=>[re.id,re]));return xe.map(re=>{const ie=me.get(re.id);return le.includes(re.id)&&(ie!=null&&ie.shifts_by_role)&&ie.shifts_by_role.length>0?{...re,shifts_by_role:ie.shifts_by_role,full_details:ie.full_details||ie}:re})}),le.length>0&&Promise.all(le.map(ne=>j(ne))).catch(ne=>{console.error("Failed to refresh expanded event details:",ne)})}}}catch(l){console.error("Failed to load events:",l)}finally{Q(!1)}}const h=l=>{f(l),a({tab:l}),u(l==="active"?"needs_workers":"all")},T=l=>{u(l);const p=new URLSearchParams;p.set("tab",n),l!=="all"&&p.set("filter",l),a(p)},j=async l=>{var p,P;try{const[Z,xe]=await Promise.all([Y.get(`/events/${l}`),Y.get(`/events/${l}/approvals`).catch(()=>null)]);if(((p=Z.data)==null?void 0:p.status)==="success"){const le=Z.data.data;if(((P=xe==null?void 0:xe.data)==null?void 0:P.status)==="success"){const ne=xe.data.data.assignments||[],me=new Map(ne.map(re=>[re.id,re]));le.shifts_by_role&&(le.shifts_by_role=le.shifts_by_role.map(re=>({...re,shifts:re.shifts.map(ie=>({...ie,assignments:ie.assignments.map(Ce=>{const Se=me.get(Ce.id);return Se&&typeof Se=="object"?{...Ce,...Se}:Ce})}))})))}$(ne=>ne.map(me=>me.id===l?{...me,...le}:me))}}catch(Z){console.error("Failed to load event details",Z)}},R=l=>{var P;const p=new Set(I);if(p.has(l))p.delete(l);else{p.add(l);const Z=S.find(le=>le.id===l);!!((P=Z==null?void 0:Z.shifts_by_role)!=null&&P.some(le=>{var ne;return(ne=le.shifts)==null?void 0:ne.some(me=>(me.assignments||[]).length>0)}))||j(l)}x(p)};async function o(l){const p=S==null?void 0:S.find(P=>P.id===l);U({isOpen:!0,isLoading:!1,eventId:l,eventTitle:p==null?void 0:p.title})}async function E(){if(D.eventId){U(l=>({...l,isLoading:!0}));try{const l=await Y.delete(`/events/${D.eventId}`);l.data.status==="success"?(U({isOpen:!1,isLoading:!1}),O({isVisible:!0,message:`"${l.data.event_title}" moved to trash`,type:"success",action:{label:"Undo",onClick:()=>F(l.data.event_id),variant:"primary"}}),d()):O({isVisible:!0,message:l.data.message||"Unable to delete event",type:"error"})}catch(l){console.error("Failed to delete event:",l),O({isVisible:!0,message:"Unable to delete event",type:"error"})}finally{U(l=>({...l,isLoading:!1}))}}}async function F(l){try{const p=await Y.post(`/events/${l}/restore`);p.data.status==="success"?(O({isVisible:!0,message:"Event restored to draft",type:"success"}),d()):O({isVisible:!0,message:p.data.message||"Unable to restore event",type:"error"})}catch(p){console.error("Failed to restore event:",p),O({isVisible:!0,message:"Unable to restore event",type:"error"})}}function se(){U({isOpen:!1,isLoading:!1})}function te(l){w({isOpen:!0,eventId:l,isLoading:!1})}async function he(){if(K.eventId){w(l=>({...l,isLoading:!0}));try{const l=await Y.post(`/events/${K.eventId}/publish`);l.data.status==="success"?(O({isVisible:!0,message:"Event published successfully",type:"success"}),w({isOpen:!1,isLoading:!1}),d()):(O({isVisible:!0,message:l.data.message||"Unable to publish event",type:"error"}),w({isOpen:!1,isLoading:!1}))}catch(l){console.error("Failed to publish event:",l),O({isVisible:!0,message:"Unable to publish event",type:"error"}),w({isOpen:!1,isLoading:!1})}}}function je(){w({isOpen:!1,isLoading:!1})}function fe(l,p){y({isOpen:!0,assignmentId:l,isLoading:!1,workerName:p})}async function ue(){var l,p;if(m.assignmentId){y(P=>({...P,isLoading:!0}));try{const P=await Y.delete(`/staffing/${m.assignmentId}`);((l=P.data)==null?void 0:l.status)==="success"?(O({isVisible:!0,message:"Worker unassigned successfully",type:"success"}),y({isOpen:!1,isLoading:!1}),d()):(O({isVisible:!0,message:((p=P.data)==null?void 0:p.message)||"Unable to unassign worker",type:"error"}),y({isOpen:!1,isLoading:!1}))}catch(P){console.error("Failed to unassign worker:",P),O({isVisible:!0,message:"Unable to unassign worker",type:"error"}),y({isOpen:!1,isLoading:!1})}}}const ze=l=>{J({isOpen:!0,shiftId:l})},de=()=>{J({isOpen:!1})},ve=()=>{de(),O({isVisible:!0,message:"Worker assigned",type:"success"}),d()},oe=S.filter(l=>{var p;if(B){const P=B.toLowerCase();if(!(l.title.toLowerCase().includes(P)||((p=l.venue)==null?void 0:p.name.toLowerCase().includes(P))))return!1}if(n==="active")switch(i){case"needs_workers":return l.unfilled_roles_count>0;case"partially_filled":return l.unfilled_roles_count>0&&l.assigned_workers_count>0;case"fully_staffed":return l.unfilled_roles_count===0&&l.assigned_workers_count>0;case"all":default:return!0}return!0}).sort((l,p)=>{var P,Z;switch(X){case"name":return l.title.localeCompare(p.title);case"staffing":return l.staffing_percentage-p.staffing_percentage;case"date":default:const xe=((P=l.schedule)==null?void 0:P.start_time_utc)||l.created_at,le=((Z=p.schedule)==null?void 0:Z.start_time_utc)||p.created_at;return new Date(xe).getTime()-new Date(le).getTime()}});return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-2",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-900",children:"Events"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Manage events and assign workers"})]}),e.jsxs("button",{onClick:()=>s("/events/create"),className:"w-full sm:w-auto inline-flex items-center justify-center gap-2 px-4 py-2 bg-teal-600 text-white font-medium rounded-lg hover:bg-teal-700 transition-colors shadow-sm min-h-touch",children:[e.jsx(ss,{size:20}),"Create New Event"]})]}),r.get("date")&&e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-teal-50 border border-teal-200 rounded-lg",children:[e.jsx(We,{size:16,className:"text-teal-600"}),e.jsxs("span",{className:"text-sm font-medium text-teal-900",children:["Showing events for ",ye(ge(r.get("date")),"EEEE, MMMM d, yyyy")]}),e.jsx("button",{onClick:()=>{const l=new URLSearchParams(r);l.delete("date"),a(l)},className:"ml-auto text-teal-600 hover:text-teal-700",title:"Clear date filter",children:e.jsx(be,{size:16})})]})]}),e.jsxs("div",{className:"flex gap-6 border-b border-gray-200 mb-6",children:[e.jsx("button",{onClick:()=>h("draft"),className:`pb-3 px-1 font-medium transition-colors border-b-2 ${n==="draft"?"border-teal-600 text-teal-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Draft Events"}),e.jsx("button",{onClick:()=>h("active"),className:`pb-3 px-1 font-medium transition-colors border-b-2 ${n==="active"?"border-teal-600 text-teal-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Active Events"}),e.jsx("button",{onClick:()=>h("completed"),className:`pb-3 px-1 font-medium transition-colors border-b-2 ${n==="completed"?"border-teal-600 text-teal-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Completed Events"})]}),e.jsxs("div",{className:"flex flex-col md:flex-row items-stretch md:items-center gap-3 sm:gap-4 mb-6",children:[e.jsxs("div",{className:"w-full md:flex-1 md:max-w-md relative",children:[e.jsx(Ye,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),e.jsx("input",{type:"text",placeholder:"Search events or venues...",value:_,onChange:l=>q(l.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent"})]}),e.jsxs("select",{value:X,onChange:l=>H(l.target.value),className:"w-full sm:w-auto px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500 bg-white",children:[e.jsx("option",{value:"date",children:"Sort by Date"}),e.jsx("option",{value:"name",children:"Sort by Name"}),n!=="draft"&&e.jsx("option",{value:"staffing",children:"Sort by Staffing"})]}),n==="active"&&e.jsxs("div",{className:"w-full sm:w-auto flex flex-wrap gap-2",children:[e.jsx("button",{onClick:()=>T("all"),className:`w-full sm:w-auto px-3 py-2 text-sm font-medium rounded-lg transition ${i==="all"?"bg-gray-100 text-gray-700":"bg-white text-gray-600 hover:bg-gray-50 border border-gray-300"}`,children:"All"}),e.jsx("button",{onClick:()=>T("needs_workers"),className:`w-full sm:w-auto px-3 py-2 text-sm font-medium rounded-lg transition ${i==="needs_workers"?"bg-red-100 text-red-700":"bg-white text-gray-600 hover:bg-gray-50 border border-gray-300"}`,children:"Needs Workers"}),e.jsx("button",{onClick:()=>T("fully_staffed"),className:`w-full sm:w-auto px-3 py-2 text-sm font-medium rounded-lg transition ${i==="fully_staffed"?"bg-green-100 text-green-700":"bg-white text-gray-600 hover:bg-gray-50 border border-gray-300"}`,children:"Ready"})]})]}),b?e.jsxs("div",{className:"space-y-4",children:[e.jsx(He,{}),e.jsx(He,{}),e.jsx(He,{})]}):e.jsxs(e.Fragment,{children:[n==="draft"&&e.jsx(St,{events:oe,onDelete:o,onPublish:te,onNavigate:l=>s(l),searchQuery:_}),n==="active"&&e.jsx($t,{events:oe,expandedEvents:I,onToggleEvent:R,onAssignWorker:ze,onUnassign:fe,onQuickFill:(l,p,P,Z)=>L({isOpen:!0,eventId:l,roleName:p,unfilledShiftIds:P,payRate:Z}),onPublish:te,onDelete:o,onEdit:l=>M({isOpen:!0,event:l}),searchQuery:_}),n==="completed"&&e.jsx(At,{events:oe,searchQuery:_,onApproveHours:l=>V({isOpen:!0,event:l})})]})]}),G.isOpen&&G.shiftId&&e.jsx(vt,{shiftId:G.shiftId,onClose:de,onSuccess:ve}),e.jsx(es,{isVisible:C.isVisible,message:C.message,type:C.type,action:C.action,onClose:()=>O({...C,isVisible:!1})}),e.jsx(qe,{isOpen:K.isOpen,onClose:je,onConfirm:he,title:"Publish Event",message:"Ready to publish? This will create shifts and make them available for worker assignment.",confirmText:K.isLoading?"Publishingâ€¦":"Publish",cancelText:"Cancel",isLoading:K.isLoading,isDestructive:!1}),e.jsx(qe,{isOpen:m.isOpen,onClose:()=>y({isOpen:!1,isLoading:!1}),onConfirm:ue,title:"Unassign Worker",message:`Remove ${m.workerName||"this worker"} from this shift?`,confirmText:m.isLoading?"Removingâ€¦":"Unassign",cancelText:"Cancel",isLoading:m.isLoading,isDestructive:!0}),e.jsx(qe,{isOpen:D.isOpen,onClose:se,onConfirm:E,title:"Delete Event",message:`Delete "${D.eventTitle}"? This action cannot be undone.`,confirmText:D.isLoading?"Deletingâ€¦":"Delete",cancelText:"Cancel",isLoading:D.isLoading,isDestructive:!0}),e.jsx(wt,{isOpen:A.isOpen,eventId:A.eventId||0,roleName:A.roleName||"",unfilledShiftIds:A.unfilledShiftIds,defaultPayRate:A.payRate,onClose:()=>L({isOpen:!1,unfilledShiftIds:[]}),onDone:({assigned:l,conflicts:p,details:P})=>{L({isOpen:!1,unfilledShiftIds:[]});let Z=`Assigned ${l} workers â€¢ ${p} skipped`;p>0&&P&&(Z+=`: ${P}`),O({isVisible:!0,message:Z,type:p>0?"error":"success"}),d()}}),c.event&&e.jsx(Nt,{event:c.event,isOpen:c.isOpen,onClose:()=>M({isOpen:!1,event:void 0}),onSuccess:()=>{d(),M({isOpen:!1,event:void 0})}}),z.isOpen&&z.event&&e.jsx(_t,{event:z.event,isOpen:z.isOpen,onClose:()=>{V({isOpen:!1}),d()},onSuccess:()=>{d(),V({isOpen:!1})}})]})}function St({events:s,onDelete:r,onPublish:a,onNavigate:t,searchQuery:g}){const n=i=>{if(!i)return"No date set";const u=ge(i);return ye(u,"MMM d, yyyy")},f=i=>{if(!i)return"";const u=ge(i);return ye(u,"h:mm a")};return s.length===0?e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ“…"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:g?"No draft events found":"No draft events yet"}),e.jsx("p",{className:"text-gray-600 mb-6",children:g?"Try adjusting your search query":"Create your first event to get started"}),!g&&e.jsxs("button",{onClick:()=>t("/events/create"),className:"inline-flex items-center gap-2 px-4 py-2 bg-teal-600 text-white font-medium rounded-lg hover:bg-teal-700 transition-colors",children:[e.jsx(ss,{size:20}),"Create Event"]})]}):e.jsxs("div",{className:"space-y-4",children:[s.length>0&&e.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4 mb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(De,{className:"h-5 w-5 text-gray-600"}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[s.length," Event",s.length!==1?"s":""," Today"]}),e.jsxs("p",{className:"text-xs text-gray-700",children:[s.reduce((i,u)=>i+(u.assigned_workers_count||0),0),"/",s.reduce((i,u)=>i+(u.total_workers_needed||0),0)," workers hired"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:s.reduce((i,u)=>i+(u.assigned_workers_count||0),0)}),e.jsx("p",{className:"text-xs text-gray-700",children:"hired"})]})]})}),s.map(i=>{var u;return e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 hover:shadow-md transition-shadow",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:[i.title,i.schedule&&e.jsxs("span",{className:"ml-2 text-sm font-normal text-gray-600",children:["â€¢ ",f(i.schedule.start_time_utc),"â€“",f(i.schedule.end_time_utc)]})]})}),e.jsx("span",{className:"px-2.5 py-1 bg-gray-100 text-gray-700 text-xs font-medium rounded-full",children:"Draft"})]}),i.venue&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 mb-2",children:[e.jsx(Ue,{size:16,className:"text-gray-400 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:((u=i.venue)==null?void 0:u.name)||"No venue"})]}),i.schedule&&e.jsx("div",{className:"flex items-center gap-4 text-sm text-gray-600 mb-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(We,{size:16,className:"text-gray-400 flex-shrink-0"}),e.jsx("span",{children:n(i.schedule.start_time_utc)})]})}),i.total_workers_needed>0&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(De,{size:16,className:"text-gray-400"}),e.jsxs("span",{children:[i.total_workers_needed," workers needed"]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{onClick:()=>t(`/events/${i.id}/edit`),className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition",title:"Edit",children:e.jsx(ms,{size:18})})})]})})},i.id)})]})}function $t({events:s,expandedEvents:r,onToggleEvent:a,onAssignWorker:t,onUnassign:g,onQuickFill:n,onPublish:f,onDelete:i,onEdit:u,searchQuery:_}){const q=b=>{const Q=ge(b);return ye(Q,"EEE, MMM d, yyyy")},B=b=>{const Q=ge(b);return ye(Q,"h:mm a")},X=b=>{if(!b.schedule)return!1;const S=(ge(b.schedule.start_time_utc).getTime()-new Date().getTime())/(1e3*60*60);return S>0&&S<=48},H=b=>{switch(b){case"fully_staffed":return e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 bg-green-100 text-green-700 text-xs font-medium rounded-full",children:[e.jsx(Ne,{size:14}),"Ready"]});case"partially_staffed":return e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 bg-yellow-100 text-yellow-700 text-xs font-medium rounded-full",children:[e.jsx(ke,{size:14}),"Partial"]});case"needs_workers":return e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 bg-red-100 text-red-700 text-xs font-medium rounded-full",children:[e.jsx(be,{size:14}),"Needs Workers"]});default:return null}};return s.length===0?e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ“…"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:_?"No active events found":"No active events"}),e.jsx("p",{className:"text-gray-600",children:_?"Try adjusting your search query or filters":"Publish draft events to see them here"})]}):e.jsx("div",{className:"space-y-4",children:s.map(b=>{const Q=r.has(b.id);return e.jsxs("div",{className:"border border-gray-200 rounded-lg p-5 hover:border-gray-300 hover:shadow-sm transition-all",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-1 truncate",children:b.title}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600 flex-wrap",children:[b.schedule&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(We,{className:"h-4 w-4 flex-shrink-0"}),q(b.schedule.start_time_utc)]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Me,{className:"h-4 w-4 flex-shrink-0"}),B(b.schedule.start_time_utc)," - ",B(b.schedule.end_time_utc),X(b)&&e.jsx("span",{className:"bg-red-600 text-white text-xs font-semibold px-2 py-0.5 rounded-full ml-2","aria-label":"Urgent: starts within 48 hours",children:"Urgent"})]})]}),b.venue&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ue,{className:"h-4 w-4 flex-shrink-0"}),b.venue.name]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0 ml-4",children:[H(b.staffing_status),u&&b.status==="published"&&e.jsx("button",{onClick:S=>{S.stopPropagation(),u(b)},title:"Edit Event",className:"p-1.5 text-teal-600 hover:text-teal-700 hover:bg-teal-50 rounded transition-colors",children:e.jsx(Ds,{size:14})}),i&&e.jsx("button",{onClick:S=>{S.stopPropagation(),i(b.id)},title:"Delete",className:"p-1.5 text-red-600 hover:text-red-700 hover:bg-red-50 rounded transition-colors",children:e.jsx(Ie,{size:14})}),e.jsx("button",{onClick:()=>a(b.id),className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:Q?e.jsx(Cs,{size:20,className:"text-gray-600"}):e.jsx(Rs,{size:20,className:"text-gray-600"})})]})]}),e.jsx("div",{className:"py-3 border-y border-gray-100 space-y-2",children:(()=>{const S=b.assigned_workers_count||0,$=b.total_workers_needed||0,I=$>0?Math.round(S/$*100):0,x=b.unfilled_roles_count||0,z=(()=>{if(b.total_pay_amount!==void 0&&b.total_pay_amount>0)return ee(b.total_pay_amount,2,"0.00");let J=0;return b.shifts_by_role&&b.shifts_by_role.length>0&&b.shifts_by_role.forEach(C=>{var O;(O=C.shifts)==null||O.forEach(K=>{var w;(w=K.assignments)==null||w.forEach(m=>{const y=Ve(m.effective_pay);J+=y})})}),ee(J,2,"0.00")})(),V=()=>I>=100?"bg-green-500":I>=75?"bg-amber-500":I>=50?"bg-orange-500":"bg-red-500",G=()=>I>=100?"text-green-600":I>=75?"text-amber-600":"text-red-600";return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700 whitespace-nowrap",children:[S," of ",$," roles filled"]}),e.jsx("div",{className:"flex-1 h-2 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:Ae("h-full rounded-full transition-all duration-300",V()),style:{width:`${I}%`}})}),e.jsxs("span",{className:"text-sm font-semibold text-gray-900 whitespace-nowrap",children:[I,"%"]})]}),x>0&&e.jsxs("div",{className:Ae("flex items-center gap-2 text-sm font-medium",G()),children:[e.jsx(ke,{className:"h-4 w-4"}),x," ",x===1?"role":"roles"," still need workers"]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("span",{children:"Est. Cost: "}),e.jsxs("span",{className:"font-semibold text-gray-900",children:["$",z]})]})]})})()}),Q&&e.jsx("div",{className:"border-t border-gray-200 bg-gray-50 px-6 py-4",children:b.shifts_by_role&&b.shifts_by_role.length>0?e.jsx("div",{className:"space-y-4",children:b.shifts_by_role.map(S=>e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:S.role_name}),e.jsxs("span",{className:"text-sm text-gray-600",children:[S.filled_shifts,"/",S.total_shifts," hired"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[S.filled_shifts<S.total_shifts&&e.jsxs("span",{className:"px-2.5 py-1 bg-red-100 text-red-700 text-xs font-medium rounded-full",children:[S.total_shifts-S.filled_shifts," needed"]}),S.filled_shifts<S.total_shifts&&e.jsx("button",{onClick:$=>{var z;$.stopPropagation();const I=S.shifts.filter(V=>V.staffing_progress.percentage<100).sort((V,G)=>new Date(V.start_time_utc).getTime()-new Date(G.start_time_utc).getTime()).map(V=>V.id),x=(z=S.shifts[0])==null?void 0:z.pay_rate;n(b.id,S.role_name,I,x)},className:"px-2.5 py-1 text-xs font-semibold bg-teal-600 text-white rounded hover:bg-teal-700",title:"Quick Fill by Skill",children:"Quick Fill by Skill"})]})]}),e.jsx("div",{className:"space-y-2",children:S.shifts.map(($,I)=>e.jsxs("div",{className:"flex items-center justify-between py-2 px-3 bg-gray-50 rounded border border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-6 h-6 bg-gray-200 text-gray-700 rounded-md flex items-center justify-center text-xs font-medium",children:I+1}),e.jsxs("span",{className:"text-sm text-gray-700",children:[B($.start_time_utc)," - ",B($.end_time_utc)]}),$.assignments.length>0&&e.jsx("div",{className:"flex items-center gap-1 flex-wrap",children:$.assignments.map(x=>{const z=`${x.worker.first_name} ${x.worker.last_name}`,V=Number(x.hourly_rate||$.pay_rate||0);return e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"bg-white text-black border border-gray-200 rounded-full px-2.5 py-1 text-sm font-medium shadow-sm max-w-[140px] truncate",title:`${z} â€¢ $${ee(V,0,"0")}/hr`,children:z}),e.jsx("button",{onClick:G=>{G.stopPropagation(),g(x.id,z)},className:"w-5 h-5 flex items-center justify-center text-red-600 hover:text-red-700 hover:bg-red-50 rounded",title:"Unassign worker",children:e.jsx(be,{size:12})})]},x.id)})})]}),$.staffing_progress.percentage===100?e.jsxs("span",{className:"flex items-center gap-1.5 text-sm font-medium text-green-600",children:[e.jsx(Ne,{size:16}),"Assigned"]}):e.jsx("button",{onClick:x=>{x.stopPropagation(),t($.id)},className:"px-3 py-1.5 bg-teal-600 text-white text-sm font-medium rounded-lg hover:bg-teal-700 transition-colors",children:"Assign Worker"})]},$.id))})]},S.role_name))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-gray-500 mb-4",children:b.status==="draft"?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"font-medium",children:"This event is still in draft status"}),e.jsx("p",{className:"text-sm",children:"Publish the event to generate shifts and assign workers"})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"font-medium",children:"No shifts available"}),e.jsx("p",{className:"text-sm",children:"This event may not have any shifts generated yet"})]})}),e.jsx("div",{className:"flex items-center justify-center gap-3",children:b.status==="draft"&&e.jsx("button",{onClick:()=>f(b.id),className:"px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-colors",children:"Publish Event"})})]})})]},b.id)})})}function At({events:s,searchQuery:r,onApproveHours:a}){const t=n=>{const f=ge(n);return ye(f,"MMM d, yyyy")},g=n=>{const f=ge(n);return ye(f,"h:mm a")};return s.length===0?e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ“‹"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:r?"No past events found":"No past events yet"}),e.jsx("p",{className:"text-gray-600",children:r?"Try adjusting your search query":"Completed events will appear here"})]}):e.jsx("div",{className:"space-y-4",children:s.map(n=>{var i;let f=Ve(n.total_hours_worked);return f===0&&n.shifts_by_role&&n.shifts_by_role.length>0&&n.shifts_by_role.forEach(u=>{var _;(_=u.shifts)==null||_.forEach(q=>{var B;(B=q.assignments)==null||B.forEach(X=>{const H=Ve(X.effective_hours);f+=H})})}),e.jsxs("div",{className:"border border-gray-200 rounded-lg p-5 hover:border-gray-300 hover:shadow-sm transition-all",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-1 truncate",children:n.title}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600 flex-wrap",children:[n.schedule&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(We,{className:"h-4 w-4 flex-shrink-0"}),t(n.schedule.start_time_utc)]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Me,{className:"h-4 w-4 flex-shrink-0"}),g(n.schedule.start_time_utc)," - ",g(n.schedule.end_time_utc)]})]}),n.venue&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ue,{className:"h-4 w-4 flex-shrink-0"}),n.venue.name]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0 ml-4",children:[e.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-gray-100 text-gray-700 rounded",children:"Completed"}),n.approval_status&&n.approval_status.pending>0&&e.jsxs("span",{className:"px-2 py-1 text-xs font-medium bg-amber-100 text-amber-700 rounded",children:[n.approval_status.pending," Pending"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4 py-3 border-y border-gray-100",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Workers"}),e.jsx("div",{className:"text-lg font-semibold text-gray-900",children:n.assigned_workers_count||0})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Hours"}),e.jsx("div",{className:"text-lg font-semibold text-gray-900",children:ee(f,2,"0.00")})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Cost"}),e.jsxs("div",{className:"text-lg font-semibold text-gray-900",children:["$",(i=n.cost_summary)!=null&&i.total_estimated_cost?ee(n.cost_summary.total_estimated_cost,2,"0.00"):n.total_pay_amount?ee(n.total_pay_amount,2,"0.00"):"0.00"]}),n.approval_status&&n.approval_status.pending>0&&n.cost_summary&&e.jsxs("div",{className:"text-xs text-amber-600 font-medium mt-0.5",children:["$",ee(n.cost_summary.pending_cost,2,"0.00")," pending"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Staffing"}),e.jsxs("div",{className:"text-lg font-semibold text-green-600",children:[n.staffing_percentage||100,"%"]})]})]}),e.jsx("div",{className:"mt-4 flex justify-end",children:a&&e.jsxs("button",{onClick:()=>a(n),className:Ae("px-4 py-2 text-sm font-medium rounded-lg flex items-center gap-2 transition-colors shadow-sm",n.approval_status&&n.approval_status.pending>0?"bg-amber-600 hover:bg-amber-700 text-white":(n.approval_status&&n.approval_status.approved===n.approval_status.total,"bg-green-600 hover:bg-green-700 text-white")),children:[n.approval_status&&n.approval_status.pending>0?e.jsxs(e.Fragment,{children:[e.jsx(Me,{className:"h-4 w-4"}),"Approve Hours (",n.approval_status.pending,")"]}):e.jsxs(e.Fragment,{children:[e.jsx(Ne,{className:"h-4 w-4"}),"Approved"]}),e.jsx(Ts,{className:"h-4 w-4"})]})})]},n.id)})})}export{Jt as EventsPage};
