import{c as Ie,j as e,X as Ne,a as K,A as Ce,b as ws,C as Ns}from"./index-8FhKG6Wu.js";import{r as j,b as is,f as ks}from"./vendor-79DyBOV9.js";import{f as _s,a as es}from"./dateUtils-CHmZs4Ub.js";import{C as Pe}from"./clock-Csa_lnfD.js";import{M as De}from"./map-pin-BV4vtpq9.js";import{U as Re}from"./users-DjnMOA4c.js";import{S as Je,T as Xe,C as Ve}from"./ConfirmationModal-CyJwCuFT.js";import{D as ls}from"./dollar-sign-Cb3cRpZv.js";import{T as Ze}from"./Toast-xHE_46Ny.js";import{C as Ss}from"./x-circle-CoKAdhKP.js";import{b as Cs,a as Es,c as $s,e as Ms,p as As}from"./Prep Cook-CE8OFMb5.js";import{P as os}from"./pen-square-BudtK_J8.js";import{P as Ke}from"./plus-hSda8aur.js";import{f as be}from"./index-C_slYh2M.js";import{p as xe}from"./index-BK_MyBzW.js";import{U as zs}from"./user-k7scssrj.js";import{C as Oe}from"./calendar-eMRkJqEi.js";import{C as Fs}from"./chevron-down-DyI5BVmd.js";import{C as Ls}from"./chevron-right-B-zL8UUa.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ps=Ie("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=Ie("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ss=Ie("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rs=Ie("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);function Te(s,n=0){const a=typeof s=="string"?Number(s):s;return Number.isFinite(a)?a:n}function te(s,n=2,a="0"){const t=Te(s,NaN);if(!Number.isFinite(t))return a;try{return t.toFixed(n)}catch{return a}}function cs(s){var n,a,t="";if(typeof s=="string"||typeof s=="number")t+=s;else if(typeof s=="object")if(Array.isArray(s)){var f=s.length;for(n=0;n<f;n++)s[n]&&(a=cs(s[n]))&&(t&&(t+=" "),t+=a)}else for(a in s)s[a]&&(t&&(t+=" "),t+=a);return t}function Ts(){for(var s,n,a=0,t="",f=arguments.length;a<f;a++)(s=arguments[a])&&(n=cs(s))&&(t&&(t+=" "),t+=n);return t}const Ye="-",Is=s=>{const n=Os(s),{conflictingClassGroups:a,conflictingClassGroupModifiers:t}=s;return{getClassGroupId:h=>{const c=h.split(Ye);return c[0]===""&&c.length!==1&&c.shift(),ds(c,n)||Ds(h)},getConflictingClassGroupIds:(h,c)=>{const g=a[h]||[];return c&&t[h]?[...g,...t[h]]:g}}},ds=(s,n)=>{var h;if(s.length===0)return n.classGroupId;const a=s[0],t=n.nextPart.get(a),f=t?ds(s.slice(1),t):void 0;if(f)return f;if(n.validators.length===0)return;const i=s.join(Ye);return(h=n.validators.find(({validator:c})=>c(i)))==null?void 0:h.classGroupId},ts=/^\[(.+)\]$/,Ds=s=>{if(ts.test(s)){const n=ts.exec(s)[1],a=n==null?void 0:n.substring(0,n.indexOf(":"));if(a)return"arbitrary.."+a}},Os=s=>{const{theme:n,classGroups:a}=s,t={nextPart:new Map,validators:[]};for(const f in a)Be(a[f],t,f,n);return t},Be=(s,n,a,t)=>{s.forEach(f=>{if(typeof f=="string"){const i=f===""?n:rs(n,f);i.classGroupId=a;return}if(typeof f=="function"){if(Vs(f)){Be(f(t),n,a,t);return}n.validators.push({validator:f,classGroupId:a});return}Object.entries(f).forEach(([i,h])=>{Be(h,rs(n,i),a,t)})})},rs=(s,n)=>{let a=s;return n.split(Ye).forEach(t=>{a.nextPart.has(t)||a.nextPart.set(t,{nextPart:new Map,validators:[]}),a=a.nextPart.get(t)}),a},Vs=s=>s.isThemeGetter,Us=s=>{if(s<1)return{get:()=>{},set:()=>{}};let n=0,a=new Map,t=new Map;const f=(i,h)=>{a.set(i,h),n++,n>s&&(n=0,t=a,a=new Map)};return{get(i){let h=a.get(i);if(h!==void 0)return h;if((h=t.get(i))!==void 0)return f(i,h),h},set(i,h){a.has(i)?a.set(i,h):f(i,h)}}},He="!",Qe=":",Ws=Qe.length,qs=s=>{const{prefix:n,experimentalParseClassName:a}=s;let t=f=>{const i=[];let h=0,c=0,g=0,k;for(let u=0;u<f.length;u++){let U=f[u];if(h===0&&c===0){if(U===Qe){i.push(f.slice(g,u)),g=u+Ws;continue}if(U==="/"){k=u;continue}}U==="["?h++:U==="]"?h--:U==="("?c++:U===")"&&c--}const O=i.length===0?f:f.substring(g),T=Bs(O),J=T!==O,P=k&&k>g?k-g:void 0;return{modifiers:i,hasImportantModifier:J,baseClassName:T,maybePostfixModifierPosition:P}};if(n){const f=n+Qe,i=t;t=h=>h.startsWith(f)?i(h.substring(f.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:h,maybePostfixModifierPosition:void 0}}if(a){const f=t;t=i=>a({className:i,parseClassName:f})}return t},Bs=s=>s.endsWith(He)?s.substring(0,s.length-1):s.startsWith(He)?s.substring(1):s,Hs=s=>{const n=Object.fromEntries(s.orderSensitiveModifiers.map(t=>[t,!0]));return t=>{if(t.length<=1)return t;const f=[];let i=[];return t.forEach(h=>{h[0]==="["||n[h]?(f.push(...i.sort(),h),i=[]):i.push(h)}),f.push(...i.sort()),f}},Qs=s=>({cache:Us(s.cacheSize),parseClassName:qs(s),sortModifiers:Hs(s),...Is(s)}),Gs=/\s+/,Js=(s,n)=>{const{parseClassName:a,getClassGroupId:t,getConflictingClassGroupIds:f,sortModifiers:i}=n,h=[],c=s.trim().split(Gs);let g="";for(let k=c.length-1;k>=0;k-=1){const O=c[k],{isExternal:T,modifiers:J,hasImportantModifier:P,baseClassName:u,maybePostfixModifierPosition:U}=a(O);if(T){g=O+(g.length>0?" "+g:g);continue}let W=!!U,_=t(W?u.substring(0,U):u);if(!_){if(!W){g=O+(g.length>0?" "+g:g);continue}if(_=t(u),!_){g=O+(g.length>0?" "+g:g);continue}W=!1}const E=i(J).join(":"),v=P?E+He:E,F=v+_;if(h.includes(F))continue;h.push(F);const H=f(_,W);for(let Q=0;Q<H.length;++Q){const B=H[Q];h.push(v+B)}g=O+(g.length>0?" "+g:g)}return g};function Xs(){let s=0,n,a,t="";for(;s<arguments.length;)(n=arguments[s++])&&(a=ms(n))&&(t&&(t+=" "),t+=a);return t}const ms=s=>{if(typeof s=="string")return s;let n,a="";for(let t=0;t<s.length;t++)s[t]&&(n=ms(s[t]))&&(a&&(a+=" "),a+=n);return a};function Zs(s,...n){let a,t,f,i=h;function h(g){const k=n.reduce((O,T)=>T(O),s());return a=Qs(k),t=a.cache.get,f=a.cache.set,i=c,c(g)}function c(g){const k=t(g);if(k)return k;const O=Js(g,a);return f(g,O),O}return function(){return i(Xs.apply(null,arguments))}}const se=s=>{const n=a=>a[s]||[];return n.isThemeGetter=!0,n},us=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,xs=/^\((?:(\w[\w-]*):)?(.+)\)$/i,Ks=/^\d+\/\d+$/,Ys=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,et=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,st=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,tt=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,rt=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Se=s=>Ks.test(s),D=s=>!!s&&!Number.isNaN(Number(s)),je=s=>!!s&&Number.isInteger(Number(s)),Ue=s=>s.endsWith("%")&&D(s.slice(0,-1)),pe=s=>Ys.test(s),at=()=>!0,nt=s=>et.test(s)&&!st.test(s),gs=()=>!1,it=s=>tt.test(s),lt=s=>rt.test(s),ot=s=>!w(s)&&!N(s),ct=s=>Ee(s,ps,gs),w=s=>us.test(s),we=s=>Ee(s,bs,nt),We=s=>Ee(s,gt,D),as=s=>Ee(s,fs,gs),dt=s=>Ee(s,hs,lt),Fe=s=>Ee(s,ys,it),N=s=>xs.test(s),Ae=s=>$e(s,bs),mt=s=>$e(s,ft),ns=s=>$e(s,fs),ut=s=>$e(s,ps),xt=s=>$e(s,hs),Le=s=>$e(s,ys,!0),Ee=(s,n,a)=>{const t=us.exec(s);return t?t[1]?n(t[1]):a(t[2]):!1},$e=(s,n,a=!1)=>{const t=xs.exec(s);return t?t[1]?n(t[1]):a:!1},fs=s=>s==="position"||s==="percentage",hs=s=>s==="image"||s==="url",ps=s=>s==="length"||s==="size"||s==="bg-size",bs=s=>s==="length",gt=s=>s==="number",ft=s=>s==="family-name",ys=s=>s==="shadow",ht=()=>{const s=se("color"),n=se("font"),a=se("text"),t=se("font-weight"),f=se("tracking"),i=se("leading"),h=se("breakpoint"),c=se("container"),g=se("spacing"),k=se("radius"),O=se("shadow"),T=se("inset-shadow"),J=se("text-shadow"),P=se("drop-shadow"),u=se("blur"),U=se("perspective"),W=se("aspect"),_=se("ease"),E=se("animate"),v=()=>["auto","avoid","all","avoid-page","page","left","right","column"],F=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],H=()=>[...F(),N,w],Q=()=>["auto","hidden","clip","visible","scroll"],B=()=>["auto","contain","none"],C=()=>[N,w,g],V=()=>[Se,"full","auto",...C()],X=()=>[je,"none","subgrid",N,w],y=()=>["auto",{span:["full",je,N,w]},je,N,w],d=()=>[je,"auto",N,w],b=()=>["auto","min","max","fr",N,w],L=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],R=()=>["start","end","center","stretch","center-safe","end-safe"],A=()=>["auto",...C()],I=()=>[Se,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...C()],m=()=>[s,N,w],$=()=>[...F(),ns,as,{position:[N,w]}],r=()=>["no-repeat",{repeat:["","x","y","space","round"]}],l=()=>["auto","cover","contain",ut,ct,{size:[N,w]}],S=()=>[Ue,Ae,we],x=()=>["","none","full",k,N,w],M=()=>["",D,Ae,we],q=()=>["solid","dashed","dotted","double"],Y=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],G=()=>[D,Ue,ns,as],ge=()=>["","none",u,N,w],ie=()=>["none",D,N,w],fe=()=>["none",D,N,w],ye=()=>[D,N,w],he=()=>[Se,"full",...C()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[pe],breakpoint:[pe],color:[at],container:[pe],"drop-shadow":[pe],ease:["in","out","in-out"],font:[ot],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[pe],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[pe],shadow:[pe],spacing:["px",D],text:[pe],"text-shadow":[pe],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",Se,w,N,W]}],container:["container"],columns:[{columns:[D,w,N,c]}],"break-after":[{"break-after":v()}],"break-before":[{"break-before":v()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:H()}],overflow:[{overflow:Q()}],"overflow-x":[{"overflow-x":Q()}],"overflow-y":[{"overflow-y":Q()}],overscroll:[{overscroll:B()}],"overscroll-x":[{"overscroll-x":B()}],"overscroll-y":[{"overscroll-y":B()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:V()}],"inset-x":[{"inset-x":V()}],"inset-y":[{"inset-y":V()}],start:[{start:V()}],end:[{end:V()}],top:[{top:V()}],right:[{right:V()}],bottom:[{bottom:V()}],left:[{left:V()}],visibility:["visible","invisible","collapse"],z:[{z:[je,"auto",N,w]}],basis:[{basis:[Se,"full","auto",c,...C()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[D,Se,"auto","initial","none",w]}],grow:[{grow:["",D,N,w]}],shrink:[{shrink:["",D,N,w]}],order:[{order:[je,"first","last","none",N,w]}],"grid-cols":[{"grid-cols":X()}],"col-start-end":[{col:y()}],"col-start":[{"col-start":d()}],"col-end":[{"col-end":d()}],"grid-rows":[{"grid-rows":X()}],"row-start-end":[{row:y()}],"row-start":[{"row-start":d()}],"row-end":[{"row-end":d()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":b()}],"auto-rows":[{"auto-rows":b()}],gap:[{gap:C()}],"gap-x":[{"gap-x":C()}],"gap-y":[{"gap-y":C()}],"justify-content":[{justify:[...L(),"normal"]}],"justify-items":[{"justify-items":[...R(),"normal"]}],"justify-self":[{"justify-self":["auto",...R()]}],"align-content":[{content:["normal",...L()]}],"align-items":[{items:[...R(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...R(),{baseline:["","last"]}]}],"place-content":[{"place-content":L()}],"place-items":[{"place-items":[...R(),"baseline"]}],"place-self":[{"place-self":["auto",...R()]}],p:[{p:C()}],px:[{px:C()}],py:[{py:C()}],ps:[{ps:C()}],pe:[{pe:C()}],pt:[{pt:C()}],pr:[{pr:C()}],pb:[{pb:C()}],pl:[{pl:C()}],m:[{m:A()}],mx:[{mx:A()}],my:[{my:A()}],ms:[{ms:A()}],me:[{me:A()}],mt:[{mt:A()}],mr:[{mr:A()}],mb:[{mb:A()}],ml:[{ml:A()}],"space-x":[{"space-x":C()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":C()}],"space-y-reverse":["space-y-reverse"],size:[{size:I()}],w:[{w:[c,"screen",...I()]}],"min-w":[{"min-w":[c,"screen","none",...I()]}],"max-w":[{"max-w":[c,"screen","none","prose",{screen:[h]},...I()]}],h:[{h:["screen","lh",...I()]}],"min-h":[{"min-h":["screen","lh","none",...I()]}],"max-h":[{"max-h":["screen","lh",...I()]}],"font-size":[{text:["base",a,Ae,we]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[t,N,We]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",Ue,w]}],"font-family":[{font:[mt,w,n]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[f,N,w]}],"line-clamp":[{"line-clamp":[D,"none",N,We]}],leading:[{leading:[i,...C()]}],"list-image":[{"list-image":["none",N,w]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",N,w]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:m()}],"text-color":[{text:m()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...q(),"wavy"]}],"text-decoration-thickness":[{decoration:[D,"from-font","auto",N,we]}],"text-decoration-color":[{decoration:m()}],"underline-offset":[{"underline-offset":[D,"auto",N,w]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:C()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",N,w]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",N,w]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:$()}],"bg-repeat":[{bg:r()}],"bg-size":[{bg:l()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},je,N,w],radial:["",N,w],conic:[je,N,w]},xt,dt]}],"bg-color":[{bg:m()}],"gradient-from-pos":[{from:S()}],"gradient-via-pos":[{via:S()}],"gradient-to-pos":[{to:S()}],"gradient-from":[{from:m()}],"gradient-via":[{via:m()}],"gradient-to":[{to:m()}],rounded:[{rounded:x()}],"rounded-s":[{"rounded-s":x()}],"rounded-e":[{"rounded-e":x()}],"rounded-t":[{"rounded-t":x()}],"rounded-r":[{"rounded-r":x()}],"rounded-b":[{"rounded-b":x()}],"rounded-l":[{"rounded-l":x()}],"rounded-ss":[{"rounded-ss":x()}],"rounded-se":[{"rounded-se":x()}],"rounded-ee":[{"rounded-ee":x()}],"rounded-es":[{"rounded-es":x()}],"rounded-tl":[{"rounded-tl":x()}],"rounded-tr":[{"rounded-tr":x()}],"rounded-br":[{"rounded-br":x()}],"rounded-bl":[{"rounded-bl":x()}],"border-w":[{border:M()}],"border-w-x":[{"border-x":M()}],"border-w-y":[{"border-y":M()}],"border-w-s":[{"border-s":M()}],"border-w-e":[{"border-e":M()}],"border-w-t":[{"border-t":M()}],"border-w-r":[{"border-r":M()}],"border-w-b":[{"border-b":M()}],"border-w-l":[{"border-l":M()}],"divide-x":[{"divide-x":M()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":M()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...q(),"hidden","none"]}],"divide-style":[{divide:[...q(),"hidden","none"]}],"border-color":[{border:m()}],"border-color-x":[{"border-x":m()}],"border-color-y":[{"border-y":m()}],"border-color-s":[{"border-s":m()}],"border-color-e":[{"border-e":m()}],"border-color-t":[{"border-t":m()}],"border-color-r":[{"border-r":m()}],"border-color-b":[{"border-b":m()}],"border-color-l":[{"border-l":m()}],"divide-color":[{divide:m()}],"outline-style":[{outline:[...q(),"none","hidden"]}],"outline-offset":[{"outline-offset":[D,N,w]}],"outline-w":[{outline:["",D,Ae,we]}],"outline-color":[{outline:m()}],shadow:[{shadow:["","none",O,Le,Fe]}],"shadow-color":[{shadow:m()}],"inset-shadow":[{"inset-shadow":["none",T,Le,Fe]}],"inset-shadow-color":[{"inset-shadow":m()}],"ring-w":[{ring:M()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:m()}],"ring-offset-w":[{"ring-offset":[D,we]}],"ring-offset-color":[{"ring-offset":m()}],"inset-ring-w":[{"inset-ring":M()}],"inset-ring-color":[{"inset-ring":m()}],"text-shadow":[{"text-shadow":["none",J,Le,Fe]}],"text-shadow-color":[{"text-shadow":m()}],opacity:[{opacity:[D,N,w]}],"mix-blend":[{"mix-blend":[...Y(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":Y()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[D]}],"mask-image-linear-from-pos":[{"mask-linear-from":G()}],"mask-image-linear-to-pos":[{"mask-linear-to":G()}],"mask-image-linear-from-color":[{"mask-linear-from":m()}],"mask-image-linear-to-color":[{"mask-linear-to":m()}],"mask-image-t-from-pos":[{"mask-t-from":G()}],"mask-image-t-to-pos":[{"mask-t-to":G()}],"mask-image-t-from-color":[{"mask-t-from":m()}],"mask-image-t-to-color":[{"mask-t-to":m()}],"mask-image-r-from-pos":[{"mask-r-from":G()}],"mask-image-r-to-pos":[{"mask-r-to":G()}],"mask-image-r-from-color":[{"mask-r-from":m()}],"mask-image-r-to-color":[{"mask-r-to":m()}],"mask-image-b-from-pos":[{"mask-b-from":G()}],"mask-image-b-to-pos":[{"mask-b-to":G()}],"mask-image-b-from-color":[{"mask-b-from":m()}],"mask-image-b-to-color":[{"mask-b-to":m()}],"mask-image-l-from-pos":[{"mask-l-from":G()}],"mask-image-l-to-pos":[{"mask-l-to":G()}],"mask-image-l-from-color":[{"mask-l-from":m()}],"mask-image-l-to-color":[{"mask-l-to":m()}],"mask-image-x-from-pos":[{"mask-x-from":G()}],"mask-image-x-to-pos":[{"mask-x-to":G()}],"mask-image-x-from-color":[{"mask-x-from":m()}],"mask-image-x-to-color":[{"mask-x-to":m()}],"mask-image-y-from-pos":[{"mask-y-from":G()}],"mask-image-y-to-pos":[{"mask-y-to":G()}],"mask-image-y-from-color":[{"mask-y-from":m()}],"mask-image-y-to-color":[{"mask-y-to":m()}],"mask-image-radial":[{"mask-radial":[N,w]}],"mask-image-radial-from-pos":[{"mask-radial-from":G()}],"mask-image-radial-to-pos":[{"mask-radial-to":G()}],"mask-image-radial-from-color":[{"mask-radial-from":m()}],"mask-image-radial-to-color":[{"mask-radial-to":m()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":F()}],"mask-image-conic-pos":[{"mask-conic":[D]}],"mask-image-conic-from-pos":[{"mask-conic-from":G()}],"mask-image-conic-to-pos":[{"mask-conic-to":G()}],"mask-image-conic-from-color":[{"mask-conic-from":m()}],"mask-image-conic-to-color":[{"mask-conic-to":m()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:$()}],"mask-repeat":[{mask:r()}],"mask-size":[{mask:l()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",N,w]}],filter:[{filter:["","none",N,w]}],blur:[{blur:ge()}],brightness:[{brightness:[D,N,w]}],contrast:[{contrast:[D,N,w]}],"drop-shadow":[{"drop-shadow":["","none",P,Le,Fe]}],"drop-shadow-color":[{"drop-shadow":m()}],grayscale:[{grayscale:["",D,N,w]}],"hue-rotate":[{"hue-rotate":[D,N,w]}],invert:[{invert:["",D,N,w]}],saturate:[{saturate:[D,N,w]}],sepia:[{sepia:["",D,N,w]}],"backdrop-filter":[{"backdrop-filter":["","none",N,w]}],"backdrop-blur":[{"backdrop-blur":ge()}],"backdrop-brightness":[{"backdrop-brightness":[D,N,w]}],"backdrop-contrast":[{"backdrop-contrast":[D,N,w]}],"backdrop-grayscale":[{"backdrop-grayscale":["",D,N,w]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[D,N,w]}],"backdrop-invert":[{"backdrop-invert":["",D,N,w]}],"backdrop-opacity":[{"backdrop-opacity":[D,N,w]}],"backdrop-saturate":[{"backdrop-saturate":[D,N,w]}],"backdrop-sepia":[{"backdrop-sepia":["",D,N,w]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":C()}],"border-spacing-x":[{"border-spacing-x":C()}],"border-spacing-y":[{"border-spacing-y":C()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",N,w]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[D,"initial",N,w]}],ease:[{ease:["linear","initial",_,N,w]}],delay:[{delay:[D,N,w]}],animate:[{animate:["none",E,N,w]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[U,N,w]}],"perspective-origin":[{"perspective-origin":H()}],rotate:[{rotate:ie()}],"rotate-x":[{"rotate-x":ie()}],"rotate-y":[{"rotate-y":ie()}],"rotate-z":[{"rotate-z":ie()}],scale:[{scale:fe()}],"scale-x":[{"scale-x":fe()}],"scale-y":[{"scale-y":fe()}],"scale-z":[{"scale-z":fe()}],"scale-3d":["scale-3d"],skew:[{skew:ye()}],"skew-x":[{"skew-x":ye()}],"skew-y":[{"skew-y":ye()}],transform:[{transform:[N,w,"","none","gpu","cpu"]}],"transform-origin":[{origin:H()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:he()}],"translate-x":[{"translate-x":he()}],"translate-y":[{"translate-y":he()}],"translate-z":[{"translate-z":he()}],"translate-none":["translate-none"],accent:[{accent:m()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:m()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",N,w]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":C()}],"scroll-mx":[{"scroll-mx":C()}],"scroll-my":[{"scroll-my":C()}],"scroll-ms":[{"scroll-ms":C()}],"scroll-me":[{"scroll-me":C()}],"scroll-mt":[{"scroll-mt":C()}],"scroll-mr":[{"scroll-mr":C()}],"scroll-mb":[{"scroll-mb":C()}],"scroll-ml":[{"scroll-ml":C()}],"scroll-p":[{"scroll-p":C()}],"scroll-px":[{"scroll-px":C()}],"scroll-py":[{"scroll-py":C()}],"scroll-ps":[{"scroll-ps":C()}],"scroll-pe":[{"scroll-pe":C()}],"scroll-pt":[{"scroll-pt":C()}],"scroll-pr":[{"scroll-pr":C()}],"scroll-pb":[{"scroll-pb":C()}],"scroll-pl":[{"scroll-pl":C()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",N,w]}],fill:[{fill:["none",...m()]}],"stroke-w":[{stroke:[D,Ae,we,We]}],stroke:[{stroke:["none",...m()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},pt=Zs(ht);function bt(...s){return pt(Ts(s))}const yt={sm:"max-w-md",md:"max-w-2xl",lg:"max-w-4xl",xl:"max-w-6xl"},Ge=({isOpen:s,onClose:n,title:a,subtitle:t,children:f,footer:i,size:h="md",closeOnOverlayClick:c=!0})=>{if(j.useEffect(()=>(s?document.body.classList.add("modal-open"):document.body.classList.remove("modal-open"),()=>{document.body.classList.remove("modal-open")}),[s]),j.useEffect(()=>{const k=O=>{O.key==="Escape"&&s&&n()};return document.addEventListener("keydown",k),()=>document.removeEventListener("keydown",k)},[s,n]),!s)return null;const g=k=>{k.target===k.currentTarget&&c&&n()};return e.jsx("div",{className:"modal-overlay",onClick:g,role:"dialog","aria-modal":"true","aria-labelledby":"modal-title",children:e.jsxs("div",{className:`modal-container ${yt[h]}`,children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{id:"modal-title",className:"text-xl font-semibold text-gray-900 font-manrope",children:a}),t&&e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:t})]}),e.jsx("button",{onClick:n,className:"p-1.5 rounded-lg bg-gray-100 hover:bg-gray-200 transition-colors","aria-label":"Close modal",children:e.jsx(Ne,{size:20,className:"text-gray-600"})})]}),e.jsx("div",{className:"modal-body",children:f}),i&&e.jsx("div",{className:"modal-footer",children:i})]})})};function vt({shiftId:s,onClose:n,onSuccess:a}){var X,y;const[t,f]=j.useState(null),[i,h]=j.useState([]),[c,g]=j.useState([]),[k,O]=j.useState(""),[T,J]=j.useState(null),[P,u]=j.useState({}),[U,W]=j.useState(!0),[_,E]=j.useState(!1),[v,F]=j.useState(null),H=(d,b)=>{u(L=>({...L,[d]:b}))};j.useEffect(()=>{Q()},[s]),j.useEffect(()=>{t&&B()},[t]),j.useEffect(()=>{if(!k)g(i);else{const d=k.toLowerCase();g(i.filter(b=>{var L;return b.first_name.toLowerCase().includes(d)||b.last_name.toLowerCase().includes(d)||b.email.toLowerCase().includes(d)||((L=b.skills_json)==null?void 0:L.some(R=>R.toLowerCase().includes(d)))}))}},[k,i]);async function Q(){try{const d=await K.get(`/shifts/${s}`);d.data.status==="success"?f(d.data.data):F("Failed to load shift details")}catch(d){console.error("Failed to load shift details:",d),F("Failed to load shift details")}}async function B(){var d;try{const b=new Set;if(t!=null&&t.event_id)try{const A=((d=(await K.get(`/events/${t.event_id}`)).data)==null?void 0:d.data)||{};if(A.shifts_by_role){const I=A.shifts_by_role.find(m=>m.skill_name===t.role_needed||m.role_name===t.role_needed);I!=null&&I.shifts&&I.shifts.forEach(m=>{m.assignments&&m.assignments.forEach($=>{var S;const r=$.worker_id||((S=$.worker)==null?void 0:S.id),l=$.status;r&&l!=="cancelled"&&l!=="no_show"&&b.add(r)})})}}catch(R){console.log("Could not fetch event to filter assigned workers:",R)}console.log(`AssignmentModal: Found ${b.size} already assigned workers for "${t==null?void 0:t.role_needed}"`);const L=await K.get("/workers?active=true");if(L.data.status==="success"){const R=L.data.data.workers||L.data.data;if(t!=null&&t.role_needed){const A=R.filter(I=>{var m;return((m=I.skills_json)==null?void 0:m.includes(t.role_needed))&&!b.has(I.id)});console.log(`AssignmentModal: Showing ${A.length} eligible workers`),h(A)}else{const A=R.filter(I=>!b.has(I.id));h(A)}}else F("Failed to load workers")}catch(b){console.error("Failed to load workers:",b),F("Failed to load workers")}finally{W(!1)}}async function C(){var d,b,L,R,A,I;if(!(!T||!t)){E(!0),F(null);try{const $=(await K.post("/staffing",{assignment:{shift_id:t.id,worker_id:T.id,status:"assigned",assigned_at_utc:new Date().toISOString(),hourly_rate:P[T.id]||Number(t.pay_rate)||0}})).data;if($.status==="success")a();else{let r=$.message||"Failed to assign worker";$.details&&$.details.length>0?r+=`

Details:
â€¢ `+$.details.join(`
â€¢ `):$.errors&&(r+=`

Details:
â€¢ `+$.errors.join(`
â€¢ `)),F(r)}}catch(m){console.error("Failed to assign worker:",m);let $="Failed to assign worker";if((b=(d=m.response)==null?void 0:d.data)!=null&&b.details&&m.response.data.details.length>0){const r=m.response.data.details.map(l=>(l.includes("conflicting shift"),l));$+=`

`+r.join(`
`)}else(R=(L=m.response)==null?void 0:L.data)!=null&&R.errors?$+=`

`+m.response.data.errors.join(`
`):(I=(A=m.response)==null?void 0:A.data)!=null&&I.message?$=m.response.data.message:m.message&&($=m.message);F($)}finally{E(!1)}}}if(U)return e.jsx(Ge,{isOpen:!0,onClose:n,title:"Assign Worker",size:"lg",children:e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-teal-600"})})});const V=e.jsxs(e.Fragment,{children:[v&&e.jsxs("div",{className:"mb-4 p-3 bg-gradient-to-r from-red-50 to-amber-50 border-l-4 border-red-500 rounded-r-lg shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-6 h-6 bg-red-500 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-white text-xs font-bold",children:"!"})}),e.jsx("h4",{className:"text-sm font-semibold text-red-900",children:"âš ï¸ Scheduling Conflict Detected"})]}),e.jsx("p",{className:"text-xs text-gray-600 ml-8",children:"Please resolve the conflict before attempting to assign this worker"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:n,disabled:_,className:"btn-secondary",children:"Cancel"}),e.jsx("button",{onClick:C,disabled:!T||_||!!v,className:`btn-primary ${v?"opacity-50 cursor-not-allowed":""}`,title:v?"Cannot assign due to scheduling conflict":"",children:_?"Assigning Worker...":"Assign Worker"})]})]});return e.jsx(Ge,{isOpen:!0,onClose:n,title:t?`${t.client_name} â€¢ ${t.role_needed}`:"Assign Worker",size:"xl",footer:V,children:e.jsxs("div",{className:"flex h-[600px]",children:[e.jsx("div",{className:"w-1/3 border-r border-gray-200 p-6 bg-gray-50",children:t?e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Shift Details"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Pe,{size:16,className:"text-gray-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:_s(t.start_time_utc)}),e.jsxs("div",{className:"text-sm text-gray-600",children:[es(t.start_time_utc)," - ",es(t.end_time_utc)]})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(De,{size:16,className:"text-gray-400 mt-0.5 flex-shrink-0"}),e.jsx("div",{className:"text-sm text-gray-900",children:t.location||((y=(X=t.event)==null?void 0:X.venue)==null?void 0:y.formatted_address)||"Location not specified"})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Re,{size:16,className:"text-gray-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-900",children:t.role_needed}),t.required_skill&&e.jsxs("div",{className:"text-sm text-gray-600",children:["Requires: ",t.required_skill]})]})]}),e.jsxs("div",{className:"pt-2 border-t border-gray-200",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Pay Rate:"})," $",(Number(t.pay_rate)||0).toFixed(2),"/hour"]}),t.uniform_name&&e.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[e.jsx("span",{className:"font-medium",children:"Uniform:"})," ",t.uniform_name]})]}),t.notes&&e.jsx("div",{className:"pt-2 border-t border-gray-200",children:e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Notes:"}),e.jsx("div",{className:"mt-1 whitespace-pre-line",children:t.notes.split("Uniform:").map((d,b)=>b===0?d.trim():e.jsxs("div",{children:[e.jsx("br",{}),e.jsx("span",{className:"font-medium",children:"Uniform:"})," ",d.trim()]},b))})]})})]})]})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ce,{size:32,className:"text-gray-400 mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Failed to load shift details"})]})}),e.jsxs("div",{className:"flex-1 flex flex-col",children:[e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsxs("div",{className:"relative",children:[e.jsx(Je,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:16}),e.jsx("input",{type:"text",placeholder:"Search workers...",value:k,onChange:d=>O(d.target.value),className:"w-full pl-9 pr-4 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-1 focus:ring-teal-500 focus:border-teal-500"})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:v?e.jsx("div",{className:"p-6 flex items-center justify-center h-full",children:e.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 rounded-lg p-5 shadow-sm w-full max-w-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx(Ce,{size:20,className:"text-red-600"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-lg font-semibold text-red-900 mb-1",children:"âš ï¸ Scheduling Conflict"}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"This worker cannot be assigned due to a scheduling conflict"}),e.jsx("div",{className:"bg-white border border-red-200 rounded p-3 mt-3",children:e.jsx("div",{className:"text-sm text-red-800 font-mono",children:v.split(`
`).map((d,b)=>d.trim()===""?null:d.startsWith("â€¢")?e.jsxs("div",{className:"mt-1 flex items-start gap-2",children:[e.jsx("span",{className:"text-red-500",children:"â—"}),e.jsx("span",{className:"flex-1",children:d.replace("â€¢","").trim()})]},b):d.startsWith("Details:")?null:d.includes("conflicting shift")?e.jsx("div",{className:"mt-1 text-red-700 font-medium",children:d},b):e.jsx("div",{className:"text-gray-700",children:d},b))})})]})]})})}):c.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Re,{size:32,className:"text-gray-400 mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-gray-600",children:k?"No workers found matching your search":t!=null&&t.role_needed?`No workers found with "${t.role_needed}" skill`:"No available workers"}),(t==null?void 0:t.role_needed)&&!k&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:['Try adding "',t.role_needed,'" skill to workers or select a different shift.']})]}):e.jsx("ul",{children:c.map(d=>{const b=(T==null?void 0:T.id)===d.id,L=P[d.id]||Number(t.pay_rate)||0,R=P[d.id]&&P[d.id]!==(Number(t.pay_rate)||0);return e.jsxs("li",{className:`flex items-center justify-between px-4 py-3 border-b last:border-b-0 ${b?"bg-teal-50":"bg-white"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"w-8 h-8 rounded-full bg-teal-100 flex items-center justify-center text-teal-700 text-xs font-semibold",children:[d.first_name[0],d.last_name[0]]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[d.first_name," ",d.last_name]}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:(d.skills_json||[]).map((A,I)=>{const m=A===(t==null?void 0:t.role_needed);return e.jsx("span",{className:`px-2 py-0.5 text-xs rounded ${m?"bg-teal-100 text-teal-700 font-medium":"bg-gray-100 text-gray-600"}`,children:A},I)})})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[R&&e.jsx("span",{className:"text-xs text-amber-600 font-medium",children:"Custom"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ls,{className:"h-4 w-4 text-gray-400"}),e.jsx("input",{type:"number",step:"1",min:"0",placeholder:(Number(t.pay_rate)||0).toString(),value:L||"",onChange:A=>{const I=A.target.value;(I===""||/^\d*\.?\d*$/.test(I))&&H(d.id,parseFloat(I)||0)},className:"w-20 px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent",onMouseDown:A=>A.stopPropagation(),onFocus:A=>A.stopPropagation()}),e.jsx("span",{className:"text-xs text-gray-600",children:"/hr"})]}),e.jsx("button",{onClick:()=>J(d),className:`px-3 py-1.5 rounded-lg text-sm font-medium border ${b?"bg-teal-600 text-white border-teal-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:b?"Selected":"Select"})]})]},d.id)})})})]})]})})}function jt({isOpen:s,eventId:n,roleName:a,unfilledShiftIds:t,defaultPayRate:f,onClose:i,onDone:h}){const[c,g]=j.useState([]),[k,O]=j.useState([]),[T,J]=j.useState(""),[P,u]=j.useState(!1),[U,W]=j.useState(!1),[_,E]=j.useState({}),[v,F]=j.useState(0),H=(y,d)=>{E(b=>({...b,[y]:d}))};j.useEffect(()=>{s&&(g([]),O([]),J(""),E({}),u(!0),(async()=>{var y,d;try{const L=((y=(await K.get(`/events/${n}`)).data)==null?void 0:y.data)||{};console.log("QuickFill: Full event data:",JSON.stringify(L,null,2)),console.log("QuickFill: Looking for role:",a),console.log("QuickFill: shifts_by_role:",L.shifts_by_role);const R=new Set;if(L.shifts_by_role){const $=L.shifts_by_role.find(r=>(console.log("QuickFill: Checking role:",r.skill_name,r.role_name,"vs",a),r.skill_name===a||r.role_name===a));$?(console.log("QuickFill: Found role shifts:",$),$.shifts&&$.shifts.forEach(r=>{r.assignments&&(console.log("QuickFill: Shift has assignments:",r.assignments),r.assignments.forEach(l=>{var M;const S=l.worker_id||((M=l.worker)==null?void 0:M.id),x=l.status;S&&x!=="cancelled"&&(R.add(S),console.log("QuickFill: Adding worker_id to exclude:",S,"status:",x))}))})):console.log("QuickFill: No role shifts found for:",a)}console.log(`QuickFill: Found ${R.size} already assigned worker IDs:`,Array.from(R));const A=await K.get("/workers?active=true"),m=(((d=A.data)==null?void 0:d.data)||A.data||[]).filter($=>{const r=($.skills_json||[]).includes(a),l=R.has($.id);return l&&console.log(`QuickFill: Excluding ${$.first_name} ${$.last_name} (ID: ${$.id}) - already assigned`),r&&!l});if(console.log(`QuickFill: Found ${m.length} eligible workers for "${a}"`),console.log("QuickFill: Eligible workers:",m.map($=>`${$.first_name} ${$.last_name}`)),g(m),f){const $=Number(f)||0;F($),console.log(`QuickFill: Default pay rate for ${a}: $${$}/hr`)}else console.log(`QuickFill: No default pay rate provided for ${a}`)}catch(b){console.error("Error loading workers:",b)}finally{u(!1)}})())},[s,n,a,f]);const Q=j.useMemo(()=>{const y=T.trim().toLowerCase(),d=c;return y?d.filter(b=>`${b.first_name} ${b.last_name}`.toLowerCase().includes(y)||(b.email||"").toLowerCase().includes(y)):d},[c,T]),B=t.length,C=y=>{O(d=>d.includes(y)?d.filter(b=>b!==y):d.length>=B?d:[...d,y])},V=async()=>{var L,R,A,I,m,$,r,l,S,x,M,q,Y,G,ge;if(k.length===0||B===0)return;W(!0);let y=0,d=0;const b=[];try{const ie=k.map(me=>c.find(Me=>Me.id===me)).filter(Boolean),fe=[...t];let ye=0;for(;fe.length>0&&ie.length>0;){const me=ie[ye%ie.length],Me=fe.shift();try{const ce=_[me.id]||Number(v)||0||0,ve=await K.post("/staffing",{assignment:{shift_id:Me,worker_id:me.id,status:"assigned",assigned_at_utc:new Date().toISOString(),hourly_rate:ce}});if(((L=ve.data)==null?void 0:L.status)==="success")y+=1;else{d+=1;const ne=`${me.first_name} ${me.last_name}`,o=((R=ve.data)==null?void 0:R.message)||((I=(A=ve.data)==null?void 0:A.error)==null?void 0:I.message)||(($=(m=ve.data)==null?void 0:m.errors)==null?void 0:$.join(", "))||"Unknown error";let p="Unable to assign";const z=String(o).toLowerCase();z.includes("overlapping")||z.includes("conflict")?p="Has overlapping shift":z.includes("capacity")||z.includes("full")?p="Shift is full":z.includes("skill")||z.includes("certification")||z.includes("requirement")?p="Missing required skill":z.includes("status")?p="Cannot be assigned":p="Unable to assign",b.push(`${ne}: ${p}`)}}catch(ce){d+=1;const ve=`${me.first_name} ${me.last_name}`;let ne="Unable to assign";const o=((l=(r=ce.response)==null?void 0:r.data)==null?void 0:l.message)||((M=(x=(S=ce.response)==null?void 0:S.data)==null?void 0:x.error)==null?void 0:M.message)||((G=(Y=(q=ce.response)==null?void 0:q.data)==null?void 0:Y.errors)==null?void 0:G.join(", "))||null;if(o){const p=String(o).toLowerCase();p.includes("overlapping")||p.includes("conflict")?ne="Has overlapping shift":p.includes("capacity")||p.includes("full")?ne="Shift is full":p.includes("skill")||p.includes("certification")||p.includes("requirement")?ne="Missing required skill":p.includes("status")?ne="Cannot be assigned":ne="Unable to assign"}else((ge=ce.response)==null?void 0:ge.status)===422?ne="Unable to assign":ce.message&&!ce.message.includes("status code")&&(ne=ce.message);b.push(`${ve}: ${ne}`)}ye+=1}let he="";d>0&&b.length>0&&(he=b.join(", ")),h({assigned:y,conflicts:d,details:he})}finally{W(!1)}};if(!s)return null;const X=e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:i,disabled:U,className:"btn-secondary",children:"Cancel"}),e.jsx("button",{onClick:V,disabled:U||k.length===0||B===0,className:"btn-primary",children:U?"Filling Shifts...":k.length===1?`Assign worker to ${B} shift${B!==1?"s":""}`:`Assign ${k.length} workers to ${B} shifts`})]});return e.jsxs(Ge,{isOpen:s,onClose:i,title:`Quick Fill â€” ${a}`,subtitle:`Unfilled shifts: ${B}`,size:"lg",footer:X,children:[e.jsxs("div",{className:"relative",children:[e.jsx(Je,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx("input",{value:T,onChange:y=>J(y.target.value),placeholder:"Search eligible workersâ€¦",className:"w-full pl-9 pr-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500"})]}),e.jsx("div",{className:"max-h-[340px] overflow-y-auto border border-gray-200 rounded-lg",children:P?e.jsx("div",{className:"p-6 text-center text-gray-500",children:"Loadingâ€¦"}):Q.length===0?e.jsx("div",{className:"p-6 text-center text-gray-500",children:"No eligible workers"}):e.jsx("ul",{children:Q.map(y=>{const d=k.includes(y.id);return e.jsxs("li",{className:`flex items-center justify-between px-4 py-3 border-b last:border-b-0 ${d?"bg-teal-50":"bg-white"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"w-8 h-8 rounded-full bg-teal-100 flex items-center justify-center text-teal-700 text-xs font-semibold",children:[y.first_name[0],y.last_name[0]]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[y.first_name," ",y.last_name]}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:(y.skills_json||[]).map((b,L)=>{const R=b===a;return e.jsx("span",{className:`px-2 py-0.5 text-xs rounded ${R?"bg-teal-100 text-teal-700 font-medium":"bg-gray-100 text-gray-600"}`,children:b},L)})})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[_[y.id]&&_[y.id]!==(Number(v)||0)&&e.jsx("span",{className:"text-xs text-amber-600 font-medium",children:"Custom"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ls,{className:"h-4 w-4 text-gray-400"}),e.jsx("input",{type:"number",step:"1",min:"0",placeholder:Number(v)?(Number(v)||0).toString():"Rate",value:_[y.id]||Number(v)||0||"",onChange:b=>{const L=b.target.value;(L===""||/^\d*\.?\d*$/.test(L))&&H(y.id,parseFloat(L)||0)},className:"w-20 px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent",onMouseDown:b=>b.stopPropagation(),onFocus:b=>b.stopPropagation()}),e.jsx("span",{className:"text-xs text-gray-600",children:"/hr"})]}),e.jsx("button",{onClick:()=>C(y.id),disabled:!d&&k.length>=B,className:`px-3 py-1.5 rounded-lg text-sm font-medium border ${d?"bg-teal-600 text-white border-teal-600":k.length>=B?"bg-gray-100 text-gray-400 border-gray-200 cursor-not-allowed":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:d?"Selected":"Select"})]})]},y.id)})})}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[e.jsx(Ss,{size:16,className:"text-teal-600"}),e.jsxs("span",{children:["Will assign ",e.jsx("strong",{children:k.length})," worker",k.length!==1?"s":""," to ",e.jsx("strong",{children:B})," shift",B!==1?"s":"","."]})]}),(Number(v)||0)>0&&e.jsxs("div",{className:"border-t pt-4 mt-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-gray-600",children:["Default rate for ",a,":"]}),e.jsxs("span",{className:"font-medium",children:["$",(Number(v)||0).toFixed(2),"/hr"]})]}),Object.keys(_).length>0&&e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["ðŸ’¡ Empty fields will use default rate ($",(Number(v)||0).toFixed(2),"/hr)"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[e.jsx(ws,{size:14,className:"text-yellow-600"}),"Conflicts and already-filled shifts will be skipped automatically."]})]})}function wt({event:s,isOpen:n,onClose:a,onSuccess:t}){var m,$;const f=is(),[i,h]=j.useState(!1),[c,g]=j.useState([]),[k,O]=j.useState(!1),[T,J]=j.useState(!1),[P,u]=j.useState(null),[U,W]=j.useState(null),[_,E]=j.useState({isVisible:!1,message:"",type:"error"}),[v,F]=j.useState(null),[H,Q]=j.useState(!1);j.useEffect(()=>{n&&s.id&&B()},[n,s.id]);const B=async()=>{J(!0);try{const r=await K.get(`/events/${s.id}`);r.data.status==="success"&&u(r.data.data)}catch(r){console.error("Failed to load full event details:",r),u(s)}finally{J(!1)}},C=()=>{a(),f(`/events/${s.id}/edit`)},V=[{name:"Bartender",icon:Cs},{name:"Banquet Server/Runner",icon:Es},{name:"Captain",icon:$s},{name:"Event Helper",icon:Ms},{name:"Prep Cook",icon:As}],X=P||s,y=P||s;j.useEffect(()=>{if(X){if(X.skill_requirements&&Array.isArray(X.skill_requirements)){const r=X.skill_requirements.map(l=>{var M,q;const S=(M=X.shifts_by_role)==null?void 0:M.find(Y=>(Y.skill_name||Y.role_name)===l.skill_name),x=((q=S==null?void 0:S.shifts)==null?void 0:q.length)||(S==null?void 0:S.total_shifts)||l.needed_workers||1;return{skill_name:l.skill_name,needed_workers:x,pay_rate:l.pay_rate||15,description:l.description||"",uniform_id:void 0,cert_id:void 0}});g(r)}else if(X.shifts_by_role&&Array.isArray(X.shifts_by_role)){const r=X.shifts_by_role.map(l=>{const S=l.shifts?l.shifts.length:l.total_shifts||1;return{skill_name:l.skill_name||l.role_name||"",needed_workers:S,pay_rate:l.pay_rate||15,description:"",uniform_id:void 0,cert_id:void 0}});g(r)}}},[X]),j.useEffect(()=>{const r=P||s;r!=null&&r.schedule&&F({start_time_utc:r.schedule.start_time_utc,end_time_utc:r.schedule.end_time_utc,break_minutes:r.schedule.break_minutes||0})},[P,s]);const d=(r,l,S)=>{if(r<0||r>=c.length)return;const x=[...c];x[r]={...x[r],[l]:S},g(x)},b=()=>{g([...c,{skill_name:"",needed_workers:1,pay_rate:15,description:"",uniform_id:void 0,cert_id:void 0}])},L=r=>{var S;if(r<0||r>=c.length)return;const l=c[r];if((l==null?void 0:l.needed_workers)>0){const x=(S=y==null?void 0:y.shifts_by_role)==null?void 0:S[r];if(((x==null?void 0:x.assigned_workers)||(x==null?void 0:x.filled_shifts)||0)>0){E({isVisible:!0,message:"Cannot remove role with assigned workers. Please unassign workers first.",type:"error"});return}}g(c.filter((x,M)=>M!==r))},R=(r,l)=>{if(r<0||r>=c.length)return;V.find(x=>x.name===l);const S=[...c];S[r]={...S[r],skill_name:l},g(S),W(null)},A=async()=>{var l,S,x;const r=P||s;if(r.schedule&&new Date(r.schedule.start_time_utc)<=new Date){E({isVisible:!0,message:"Cannot edit event that has already started",type:"error"});return}O(!0);try{const M=P||s,q=await K.patch(`/events/${M.id}`,{event:{roles:c.map(Y=>({skill_name:Y.skill_name,needed:Y.needed_workers,pay_rate:Y.pay_rate,description:Y.description,uniform_id:Y.uniform_id,cert_id:Y.cert_id})),schedule:v?{start_time_utc:v.start_time_utc,end_time_utc:v.end_time_utc,break_minutes:v.break_minutes}:M.schedule?{start_time_utc:M.schedule.start_time_utc,end_time_utc:M.schedule.end_time_utc,break_minutes:M.schedule.break_minutes||0}:void 0}});q.data.status==="success"?(E({isVisible:!0,message:q.data.message||"Event updated successfully",type:"success"}),t(),a()):E({isVisible:!0,message:q.data.message||"Failed to update event",type:"error"})}catch(M){console.error("Failed to update event:",M);const q=(l=M==null?void 0:M.response)==null?void 0:l.data;if((q==null?void 0:q.status)==="validation_error"&&((x=(S=q==null?void 0:q.data)==null?void 0:S.conflicts)!=null&&x.length)){const Y=q.data.conflicts.map(G=>{const ge=new Date(G.conflicting_shift_start_time_utc).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"}),ie=new Date(G.conflicting_shift_end_time_utc).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"});return`${G.worker_name} conflicts with ${G.conflicting_event_title} (${ge} â€“ ${ie})`});E({isVisible:!0,message:`Can't save changes: ${Y.length} worker${Y.length!==1?"s":""} would be double-booked
â€¢ `+Y.join(`
â€¢ `),type:"error"})}else E({isVisible:!0,message:(q==null?void 0:q.message)||"Failed to update event",type:"error"})}finally{O(!1)}},I=e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:a,disabled:k,className:"btn-secondary",children:"Cancel"}),e.jsx("button",{onClick:A,disabled:k,className:"btn-primary",children:k?"Saving...":"Save Changes"})]});return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-0 sm:p-4 overflow-y-auto",children:e.jsxs("div",{className:"bg-white w-full h-full sm:h-auto sm:max-w-4xl sm:rounded-lg shadow-xl overflow-hidden flex flex-col sm:max-h-[90vh]",children:[e.jsxs("div",{className:"sticky top-0 bg-white px-4 sm:px-6 py-4 border-b border-gray-200 flex items-center justify-between z-10",children:[e.jsxs("h2",{className:"text-lg sm:text-xl md:text-2xl font-bold text-gray-900 truncate",children:["Edit Event: ",y.title]}),e.jsx("button",{onClick:a,className:"p-2 text-gray-400 hover:text-gray-600 min-h-touch min-w-touch","aria-label":"Close",children:e.jsx(Ne,{className:"h-5 w-5 sm:h-6 sm:w-6"})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto px-4 sm:px-6 py-4 space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 p-6 rounded-xl border border-gray-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-5",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"Event Details"}),e.jsxs("button",{onClick:C,className:"inline-flex items-center gap-1.5 px-3 py-1.5 bg-white border border-gray-300 text-sm font-medium text-gray-700 rounded-lg hover:bg-gray-50 hover:border-gray-400 transition-all shadow-sm",children:[e.jsx(os,{size:14}),"Edit"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:"Venue"}),e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:(m=y.venue)==null?void 0:m.name})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:"Date"}),e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:y.schedule&&new Date(y.schedule.start_time_utc).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric"})})]}),e.jsxs("div",{className:"space-y-1 md:col-span-2",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:"Location"}),e.jsx("p",{className:"text-sm font-semibold text-gray-900 leading-relaxed",children:($=y.venue)==null?void 0:$.formatted_address})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:"Time"}),e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:y.schedule&&e.jsxs(e.Fragment,{children:[new Date(y.schedule.start_time_utc).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})," - ",new Date(y.schedule.end_time_utc).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})]})})]}),e.jsx("div",{})]})]}),e.jsxs("div",{className:"col-span-2 bg-gray-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 uppercase tracking-wide",children:"Event Schedule"}),e.jsx("button",{type:"button",onClick:()=>Q(!H),className:"text-sm text-blue-600 hover:text-blue-800 font-medium",children:H?"Cancel":"Edit Schedule"})]}),H?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Start Time"}),e.jsx("input",{type:"datetime-local",value:v!=null&&v.start_time_utc?new Date(v.start_time_utc).toISOString().slice(0,16):"",onChange:r=>F(l=>l?{...l,start_time_utc:new Date(r.target.value).toISOString()}:null),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"End Time"}),e.jsx("input",{type:"datetime-local",value:v!=null&&v.end_time_utc?new Date(v.end_time_utc).toISOString().slice(0,16):"",onChange:r=>F(l=>l?{...l,end_time_utc:new Date(r.target.value).toISOString()}:null),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Break Minutes"}),e.jsx("input",{type:"number",min:"0",value:(v==null?void 0:v.break_minutes)||0,onChange:r=>F(l=>l?{...l,break_minutes:parseInt(r.target.value)||0}:null),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm"})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-3",children:e.jsx("p",{className:"text-xs text-blue-800",children:"âš ï¸ Changing schedule times will update ALL shifts and worker schedules for this event."})})]}):e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Date"}),e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:y.schedule&&new Date(y.schedule.start_time_utc).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric"})})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Time"}),e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:v&&e.jsxs(e.Fragment,{children:[new Date(v.start_time_utc).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})," -",new Date(v.end_time_utc).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})]})})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Break"}),e.jsxs("p",{className:"text-sm font-semibold text-gray-900",children:[(v==null?void 0:v.break_minutes)||0," minutes"]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-base font-semibold text-gray-900",children:"Roles"}),e.jsxs("button",{onClick:b,className:"inline-flex items-center gap-2 px-4 py-2 bg-teal-600 text-white text-sm font-semibold rounded-lg hover:bg-teal-700 transition-colors shadow-sm",children:[e.jsx(Ke,{size:16}),"Add Role"]})]}),c.map((r,l)=>{var S;return e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start gap-4 mb-3",children:[e.jsxs("div",{className:"flex-1 relative overflow-visible",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Role Name *"}),e.jsxs("div",{className:"relative",style:{zIndex:U===l?1e3:1},children:[e.jsxs("button",{type:"button",onClick:()=>W(U===l?null:l),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500 bg-white text-left flex items-center justify-between",children:[r.skill_name?e.jsxs("div",{className:"flex items-center gap-2",children:[((S=V.find(x=>x.name===r.skill_name))==null?void 0:S.icon)&&e.jsx("img",{src:V.find(x=>x.name===r.skill_name).icon,alt:r.skill_name,className:"w-5 h-5"}),e.jsx("span",{className:"text-gray-900",children:r.skill_name})]}):e.jsx("span",{className:"text-gray-400",children:"Pick the Skills the Worker Has"}),e.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{d:"M19 9l-7 7-7-7"})})]}),U===l&&e.jsx("div",{className:"absolute top-full left-0 right-0 mt-2 bg-white border-2 border-gray-200 rounded-xl shadow-2xl z-[9999] max-h-[300px] overflow-y-auto w-full min-w-max",children:V.filter(x=>!c.some((M,q)=>q!==l&&M.skill_name===x.name)).map(x=>e.jsxs("div",{onClick:()=>R(l,x.name),className:"flex items-center gap-3 px-4 py-3 cursor-pointer hover:bg-teal-50 border-b border-gray-100 last:border-0",children:[e.jsx("img",{src:x.icon,width:"24",height:"24",alt:x.name,className:"flex-shrink-0"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:x.name})]},x.name))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Needed Workers *"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>d(l,"needed_workers",Math.max(1,r.needed_workers-1)),className:"w-8 h-8 flex items-center justify-center border border-gray-300 bg-white hover:bg-gray-50 rounded-lg transition-colors font-semibold text-gray-700",children:"-"}),e.jsx("input",{type:"number",value:r.needed_workers,onChange:x=>d(l,"needed_workers",parseInt(x.target.value)||1),min:"1",className:"w-16 px-2 py-2 border border-gray-300 rounded-lg text-center focus:outline-none focus:ring-2 focus:ring-teal-500 font-medium"}),e.jsx("button",{onClick:()=>d(l,"needed_workers",r.needed_workers+1),className:"w-8 h-8 flex items-center justify-center border border-gray-300 bg-white hover:bg-gray-50 rounded-lg transition-colors font-semibold text-gray-700",children:"+"}),e.jsx("button",{onClick:()=>L(l),className:"ml-2 w-8 h-8 flex items-center justify-center text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Remove role",children:e.jsx(Xe,{size:18})})]})]})]}),(()=>{var q;const x=(q=y==null?void 0:y.shifts_by_role)==null?void 0:q[l],M=(x==null?void 0:x.assigned_workers)||(x==null?void 0:x.filled_shifts)||0;return M>0?e.jsxs("div",{className:"text-sm text-amber-600 font-semibold bg-amber-50 px-3 py-2 rounded-lg",children:[M," worker(s) assigned"]}):null})()]},l)})]})]}),e.jsx("div",{className:"sticky bottom-0 bg-white px-4 sm:px-6 py-4 border-t border-gray-200 flex flex-col sm:flex-row gap-3 sm:justify-end z-10",children:I})]})}),e.jsx(Ze,{isVisible:_.isVisible,message:_.message,type:_.type,onClose:()=>E({..._,isVisible:!1})})]})}function Nt({assignment:s,isEditing:n,editData:a,onEdit:t,onSave:f,onCancel:i,onEditDataChange:h,onNoShow:c,onRemove:g,onReEdit:k}){const[O,T]=j.useState(!1),J=P=>{if(!P)return"";try{const u=xe(P);return be(u,"MMM d, yyyy h:mm a")}catch{return new Date(P).toLocaleString()}};return n?e.jsx("tr",{className:"bg-blue-50",children:e.jsx("td",{colSpan:6,className:"py-4 px-6",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-sm font-medium text-blue-900",children:"Edit Hours Worked"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Hours Worked"}),e.jsx("input",{type:"number",step:"0.25",min:"0",value:a.hours_worked||"",onChange:P=>h({...a,hours_worked:parseFloat(P.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Actual Start Time"}),e.jsx("input",{type:"datetime-local",value:a.actual_start_time_utc?new Date(a.actual_start_time_utc).toISOString().slice(0,16):"",onChange:P=>h({...a,actual_start_time_utc:new Date(P.target.value).toISOString()}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Actual End Time"}),e.jsx("input",{type:"datetime-local",value:a.actual_end_time_utc?new Date(a.actual_end_time_utc).toISOString().slice(0,16):"",onChange:P=>h({...a,actual_end_time_utc:new Date(P.target.value).toISOString()}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>f(s.id),className:"px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700 transition-colors",children:"Save Changes"}),e.jsx("button",{onClick:i,className:"px-4 py-2 bg-gray-200 text-gray-700 text-sm font-medium rounded-md hover:bg-gray-300 transition-colors",children:"Cancel"})]})]})})}):e.jsxs("tr",{className:`group transition-colors ${s.approved?"bg-green-50/30":s.status==="no_show"?"bg-red-50/30":s.status==="cancelled"?"bg-gray-50/30":"hover:bg-gray-50"}`,onMouseEnter:()=>T(!0),onMouseLeave:()=>T(!1),children:[e.jsxs("td",{className:"py-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-8 w-8 rounded-full bg-gray-100 flex items-center justify-center flex-shrink-0",children:e.jsx(zs,{className:"h-4 w-4 text-gray-600"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"font-medium text-gray-900 truncate",children:s.worker_name}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Scheduled: ",te(s.scheduled_hours,2,"0.00"),"h"]})]})]}),s.approved&&s.approved_by_name&&e.jsxs("div",{className:"mt-2 text-xs text-gray-500 ml-11",children:["Approved by ",s.approved_by_name," on ",J(s.approved_at)]})]}),e.jsx("td",{className:"py-4 text-sm text-gray-700",children:s.shift_role||"N/A"}),e.jsx("td",{className:"py-4 text-right",children:e.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[te(s.effective_hours,2,"0.00"),"h",s.edited_at&&e.jsx("span",{className:"ml-1 text-xs text-orange-600",title:"Edited",children:e.jsx(ss,{className:"h-3 w-3 inline"})})]})}),e.jsxs("td",{className:"py-4 text-right text-sm text-gray-700",children:["$",te(s.effective_hourly_rate,2,"0.00"),"/h"]}),e.jsx("td",{className:"py-4 text-right",children:e.jsxs("span",{className:"text-sm font-semibold text-gray-900",children:["$",te(s.effective_pay,2,"0.00")]})}),e.jsx("td",{className:"py-4 text-right",children:e.jsx("div",{className:"flex items-center justify-end gap-2",children:s.status==="no_show"?e.jsx(e.Fragment,{children:e.jsxs("span",{className:"inline-flex items-center gap-1 text-xs font-medium text-red-700",children:[e.jsx(Ps,{className:"h-3.5 w-3.5"}),"No-Show"]})}):s.status==="cancelled"?e.jsx(e.Fragment,{children:e.jsxs("span",{className:"inline-flex items-center gap-1 text-xs font-medium text-gray-700",children:[e.jsx(Ne,{className:"h-3.5 w-3.5"}),"Cancelled"]})}):s.approved?e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"inline-flex items-center gap-1 text-xs font-medium text-green-700",children:[e.jsx(ze,{className:"h-3.5 w-3.5"}),"Approved"]}),s.can_edit_hours&&e.jsx("button",{onClick:()=>k(s),className:`text-xs text-gray-600 hover:text-gray-900 transition-all ${O?"opacity-100":"opacity-0"}`,title:"Re-edit approved hours",children:"Re-edit"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium text-amber-700 bg-amber-50 rounded",children:[e.jsx(Pe,{className:"h-3.5 w-3.5"}),"Pending"]}),s.can_edit_hours&&e.jsxs("div",{className:`flex items-center gap-1 transition-all ${O?"opacity-100":"opacity-0"}`,children:[e.jsx("button",{onClick:()=>t(s),className:"p-1.5 text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors",title:"Edit hours",children:e.jsx(ss,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>c(s),className:"p-1.5 text-gray-600 hover:text-orange-600 hover:bg-orange-50 rounded transition-colors",title:"Mark no-show",children:e.jsx(Ce,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>g(s),className:"p-1.5 text-gray-600 hover:text-red-600 hover:bg-red-50 rounded transition-colors",title:"Remove worker",children:e.jsx(Xe,{className:"h-4 w-4"})})]})]})})})]})}function kt({event:s,isOpen:n,onClose:a,onSuccess:t}){const[f,i]=j.useState([]),[h,c]=j.useState(null),[g,k]=j.useState(!1),[O,T]=j.useState(null),[J,P]=j.useState({}),[u,U]=j.useState(!1),[W,_]=j.useState({isVisible:!1,message:"",type:"success"}),[E,v]=j.useState({open:!1,title:"",variant:"default"});j.useEffect(()=>{n&&s&&F()},[n,s]);const F=async()=>{var r,l;if(s!=null&&s.id){k(!0);try{const S=await K.get(`/events/${s.id}/approvals`);i(S.data.data.assignments||[]),c(S.data.data.cost_summary||null)}catch(S){console.error("Error loading assignments:",S),_({isVisible:!0,type:"error",message:((l=(r=S.response)==null?void 0:r.data)==null?void 0:l.error)||S.message||"Unable to load assignments for approval"}),i([]),c(null)}finally{k(!1)}}},H=r=>{T(r.id),P({hours_worked:r.hours_worked||r.scheduled_hours,actual_start_time_utc:r.actual_start||r.scheduled_start,actual_end_time_utc:r.actual_end||r.scheduled_end,hourly_rate:r.hourly_rate})},Q=r=>{v({open:!0,title:"Re-Edit Approved Hours",message:"Re-editing will un-approve this assignment. The assignment will need to be re-approved after you make changes. Continue?",variant:"warning",onConfirm:async()=>{v({open:!1,title:""}),H(r)}})},B=async r=>{var l,S,x;try{const M=await K.patch(`/approvals/${r}/update_hours`,J);await F(),T(null),P({}),(l=M.data)!=null&&l.message?_({isVisible:!0,type:"success",message:M.data.message}):_({isVisible:!0,type:"success",message:"Hours updated successfully"})}catch(M){console.error("Error updating hours:",M),_({isVisible:!0,type:"error",message:((x=(S=M.response)==null?void 0:S.data)==null?void 0:x.message)||"Failed to update hours"})}},C=async r=>{v({open:!0,title:"Mark No-Show",message:`Mark ${r.worker_name} as no-show? This will set hours to 0.`,requireNote:!0,note:"",variant:"warning",onConfirm:async()=>{var l,S;try{await K.post(`/approvals/${r.id}/mark_no_show`,{notes:E.note}),await F(),_({isVisible:!0,type:"success",message:"Marked as no-show"})}catch(x){console.error("Error marking no-show:",x),_({isVisible:!0,type:"error",message:((S=(l=x.response)==null?void 0:l.data)==null?void 0:S.message)||"Failed to mark no-show"})}finally{v({open:!1,title:""})}}})},V=async r=>{v({open:!0,title:"Remove from Job",message:`Remove ${r.worker_name} from this job? This cannot be undone.`,requireNote:!0,note:"",variant:"danger",onConfirm:async()=>{var l,S;try{await K.delete(`/approvals/${r.id}/remove`,{data:{notes:E.note}}),await F(),_({isVisible:!0,type:"success",message:"Assignment removed"})}catch(x){console.error("Error removing assignment:",x),_({isVisible:!0,type:"error",message:((S=(l=x.response)==null?void 0:l.data)==null?void 0:S.message)||"Failed to remove assignment"})}finally{v({open:!1,title:""})}}})},X=async()=>{const r=f.filter(l=>!l.approved&&l.can_approve&&l.status!=="no_show").length;v({open:!0,title:"Approve All Hours",message:`Approve hours for all ${r} eligible workers?`,onConfirm:async()=>{var l,S;U(!0);try{await K.post(`/events/${s.id}/approve_all`),await F(),t(),_({isVisible:!0,type:"success",message:`Approved ${r} assignments`})}catch(x){console.error("Error approving all:",x),_({isVisible:!0,type:"error",message:((S=(l=x.response)==null?void 0:l.data)==null?void 0:S.message)||"Failed to approve all hours"})}finally{U(!1),v({open:!1,title:""})}}})};if(!n)return null;const y=f.filter(r=>r.status!=="no_show"&&r.status!=="cancelled"),d=y.filter(r=>!r.approved).length,b=y.filter(r=>r.approved).length,L=y.length,R=y.filter(r=>!r.approved).reduce((r,l)=>r+Number(l.effective_pay||0),0),A=y.filter(r=>r.approved).reduce((r,l)=>r+Number(l.effective_pay||0),0),I=R+A,m=y.reduce((r,l)=>r+Number(l.effective_hours||0),0),$=r=>{if(!r)return"";try{return be(xe(r),"MMM d, yyyy")}catch{return new Date(r).toLocaleDateString()}};return e.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-0 sm:p-4 overflow-y-auto",children:[e.jsx(Ze,{isVisible:W.isVisible,message:W.message,type:W.type,onClose:()=>_({...W,isVisible:!1})}),e.jsxs("div",{className:"bg-white w-full h-full sm:h-auto sm:max-w-6xl sm:rounded-lg shadow-xl overflow-hidden flex flex-col sm:max-h-[90vh] my-0 sm:my-4",children:[e.jsx("header",{className:"border-b px-6 py-4 bg-white flex-shrink-0",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Approve Hours"}),e.jsxs("p",{className:"text-sm text-gray-500 mt-0.5",children:[s==null?void 0:s.title," Â· ",s!=null&&s.event_date?$(s.event_date):""]})]}),e.jsx("button",{onClick:a,className:"text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Close modal",children:e.jsx(Ne,{className:"h-5 w-5"})})]})}),d>0&&e.jsx("div",{className:"bg-amber-50 border-l-4 border-amber-400 px-6 py-3 flex-shrink-0",children:e.jsxs("p",{className:"text-sm text-amber-800 flex items-center gap-2",children:[e.jsx(Ce,{className:"h-4 w-4"}),e.jsx("strong",{children:d})," ",d===1?"assignment":"assignments"," pending approval"]})}),e.jsx("div",{className:"flex-1 overflow-auto px-6 py-4",children:g?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading assignments..."})]}):f.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ce,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"No assignments found for this event."})]}):e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"border-b border-gray-200",children:e.jsxs("tr",{className:"text-left",children:[e.jsx("th",{className:"pb-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Worker"}),e.jsx("th",{className:"pb-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),e.jsx("th",{className:"pb-3 text-xs font-medium text-gray-500 uppercase tracking-wider text-right",children:"Hours"}),e.jsx("th",{className:"pb-3 text-xs font-medium text-gray-500 uppercase tracking-wider text-right",children:"Rate"}),e.jsx("th",{className:"pb-3 text-xs font-medium text-gray-500 uppercase tracking-wider text-right",children:"Total"}),e.jsx("th",{className:"pb-3 text-xs font-medium text-gray-500 uppercase tracking-wider text-right",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:f.map(r=>e.jsx(Nt,{assignment:r,isEditing:O===r.id,editData:J,onEdit:H,onSave:B,onCancel:()=>{T(null),P({})},onEditDataChange:P,onNoShow:C,onRemove:V,onReEdit:Q},r.id))})]})}),e.jsxs("footer",{className:"border-t bg-gray-50 px-6 py-4 flex-shrink-0",children:[d>0&&b>0?e.jsxs("div",{className:"mb-4 space-y-1.5 text-sm",children:[e.jsxs("div",{className:"flex justify-between text-gray-600",children:[e.jsx("span",{children:"Pending approval:"}),e.jsxs("span",{className:"font-medium",children:["$",te(R,2,"0.00")," (",d," ",d===1?"worker":"workers",")"]})]}),e.jsxs("div",{className:"flex justify-between text-gray-600",children:[e.jsx("span",{children:"Approved:"}),e.jsxs("span",{className:"font-medium",children:["$",te(A,2,"0.00")," (",b," ",b===1?"worker":"workers",")"]})]}),e.jsxs("div",{className:"pt-2 border-t border-gray-200 flex justify-between text-gray-900",children:[e.jsx("span",{className:"font-semibold",children:"Total:"}),e.jsxs("span",{className:"font-semibold",children:["$",te(I,2,"0.00")," (",L," workers, ",te(m,2,"0.00"),"h)"]})]})]}):d===0&&b>0?e.jsxs("div",{className:"mb-4 flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Final approved cost:"}),e.jsxs("span",{className:"text-lg font-bold text-green-600",children:["$",te(A,2,"0.00")]})]}):e.jsxs("div",{className:"mb-4 flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Total cost:"}),e.jsxs("span",{className:"text-lg font-bold text-gray-900",children:["$",te(I,2,"0.00")," (",L," workers, ",te(m,2,"0.00"),"h)"]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3",children:[e.jsx("button",{onClick:a,className:"px-4 py-2 text-sm font-medium text-gray-700 hover:text-gray-900 transition-colors",children:"Close"}),d>0&&e.jsxs("button",{onClick:X,disabled:u,className:"px-4 py-2 bg-green-600 hover:bg-green-700 disabled:bg-green-400 text-white text-sm font-medium rounded-lg shadow-sm flex items-center gap-2 transition-colors",children:[e.jsx(ze,{className:"h-4 w-4"}),"Approve All (",d,")"]})]})]})]}),E.open&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>v({open:!1,title:""})}),e.jsxs("div",{className:"relative bg-white w-full max-w-md rounded-lg shadow-xl p-5",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:E.title}),E.message&&e.jsx("p",{className:"mt-2 text-sm text-gray-700",children:E.message}),E.requireNote&&e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Notes (optional)"}),e.jsx("textarea",{value:E.note||"",onChange:r=>v(l=>({...l,note:r.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:3})]}),e.jsxs("div",{className:"mt-5 flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>v({open:!1,title:""}),className:"px-4 py-2 bg-gray-100 text-gray-700 text-sm font-medium rounded-md hover:bg-gray-200",children:"Cancel"}),e.jsx("button",{onClick:async()=>{var r;await((r=E.onConfirm)==null?void 0:r.call(E))},className:"px-4 py-2 text-white text-sm font-medium rounded-md "+(E.variant==="danger"?"bg-red-600 hover:bg-red-700":E.variant==="warning"?"bg-yellow-600 hover:bg-yellow-700":"bg-blue-600 hover:bg-blue-700"),children:"Confirm"})]})]})]})]})}function oe({className:s="",count:n=1}){return e.jsx(e.Fragment,{children:Array.from({length:n}).map((a,t)=>e.jsx("div",{className:`animate-pulse bg-gray-200 rounded-lg ${s}`},t))})}function qe(){return e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(oe,{className:"h-6 w-48 mb-2"}),e.jsx(oe,{className:"h-4 w-32"})]}),e.jsx(oe,{className:"h-8 w-8 rounded-full"})]}),e.jsxs("div",{className:"space-y-3 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(oe,{className:"h-4 w-4 rounded"}),e.jsx(oe,{className:"h-4 w-40"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(oe,{className:"h-4 w-4 rounded"}),e.jsx(oe,{className:"h-4 w-36"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(oe,{className:"h-4 w-4 rounded"}),e.jsx(oe,{className:"h-4 w-32"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(oe,{className:"h-2 w-full rounded-full mb-2"}),e.jsx(oe,{className:"h-3 w-24"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(oe,{className:"h-9 w-24 rounded-md"}),e.jsx(oe,{className:"h-9 w-24 rounded-md"})]})]})})}function _t(s,n=500){const[a,t]=j.useState(s);return j.useEffect(()=>{const f=setTimeout(()=>{t(s)},n);return()=>{clearTimeout(f)}},[s,n]),a}function Gt(){const s=is(),[n,a]=ks(),t=(n.get("tab")==="completed"?"completed":n.get("tab"))||"active",f=n.get("filter")||"needs_workers",[i,h]=j.useState(t),[c,g]=j.useState(f),[k,O]=j.useState(""),T=_t(k,500),[J,P]=j.useState("date"),[u,U]=j.useState(!0),[W,_]=j.useState([]),[E,v]=j.useState(new Set),[F,H]=j.useState({isOpen:!1}),[Q,B]=j.useState({isOpen:!1}),[C,V]=j.useState({isVisible:!1,message:"",type:"success"}),[X,y]=j.useState({isOpen:!1,isLoading:!1}),[d,b]=j.useState({isOpen:!1,isLoading:!1}),[L,R]=j.useState({isOpen:!1,isLoading:!1}),[A,I]=j.useState({isOpen:!1,unfilledShiftIds:[]}),[m,$]=j.useState({isOpen:!1});j.useEffect(()=>{r()},[i,c,n]),j.useEffect(()=>{const o=(n.get("tab")==="completed"?"completed":n.get("tab"))||"active",p=n.get("filter")||"all";o!==i&&h(o),p!==c&&g(p)},[n,i,c]),j.useEffect(()=>{const o=n.get("event_id"),p=n.get("shift_id");if(o){const z=parseInt(o);isNaN(z)||(v(new Set([z])),p&&console.log(`Auto-expanding event ${z} with shift ${p}`))}},[n]),j.useEffect(()=>{const o=n.get("event_id");if(!o)return;const p=parseInt(o);if(isNaN(p))return;const z=W.find(Z=>Z.id===p);z&&(!z.shifts_by_role||z.shifts_by_role.length===0)&&(x(p),v(new Set([p])))},[n,W]);async function r(){U(!0);try{const o=i==="completed"?"completed":i,p=n.get("date");let z=`/events?tab=${o}`;c!=="all"&&(z+=`&filter=${c}`),p&&(z+=`&date=${p}`),console.log("Loading events with URL:",z,"filterStatus:",c,"date:",p);const Z=await K.get(z);if(Z.data.status==="success"){console.log("Received events:",Z.data.data.length);const ue=Z.data.data;if(i==="completed"){const ae=await Promise.all(ue.map(async re=>{var de;try{const ee=await K.get(`/events/${re.id}/approvals`);if(((de=ee.data)==null?void 0:de.status)==="success"){const le=ee.data.data.assignments||[],ke=le.length,_e=le.filter(js=>js.approved).length,vs=ee.data.data.cost_summary||null;return{...re,approval_status:{total:ke,approved:_e,pending:ke-_e},cost_summary:vs}}}catch(ee){console.warn(`Failed to load approval status for event ${re.id}:`,ee)}return re}));_(ae)}else{const ae=Array.from(E);_(re=>{const de=new Map(re.map(ee=>[ee.id,ee]));return ue.map(ee=>{const le=de.get(ee.id);return ae.includes(ee.id)&&(le!=null&&le.shifts_by_role)&&le.shifts_by_role.length>0?{...ee,shifts_by_role:le.shifts_by_role,full_details:le.full_details||le}:ee})}),ae.length>0&&Promise.all(ae.map(re=>x(re))).catch(re=>{console.error("Failed to refresh expanded event details:",re)})}}}catch(o){console.error("Failed to load events:",o)}finally{U(!1)}}const l=o=>{h(o),a({tab:o}),g(o==="active"?"needs_workers":"all")},S=o=>{g(o);const p=new URLSearchParams;p.set("tab",i),o!=="all"&&p.set("filter",o),a(p)},x=async o=>{var p,z;try{const[Z,ue]=await Promise.all([K.get(`/events/${o}`),K.get(`/events/${o}/approvals`).catch(()=>null)]);if(((p=Z.data)==null?void 0:p.status)==="success"){const ae=Z.data.data;if(((z=ue==null?void 0:ue.data)==null?void 0:z.status)==="success"){const re=ue.data.data.assignments||[],de=new Map(re.map(ee=>[ee.id,ee]));ae.shifts_by_role&&(ae.shifts_by_role=ae.shifts_by_role.map(ee=>({...ee,shifts:ee.shifts.map(le=>({...le,assignments:le.assignments.map(ke=>{const _e=de.get(ke.id);return _e&&typeof _e=="object"?{...ke,..._e}:ke})}))})))}_(re=>re.map(de=>de.id===o?{...de,...ae}:de))}}catch(Z){console.error("Failed to load event details",Z)}},M=o=>{var z;const p=new Set(E);if(p.has(o))p.delete(o);else{p.add(o);const Z=W.find(ae=>ae.id===o);!!((z=Z==null?void 0:Z.shifts_by_role)!=null&&z.some(ae=>{var re;return(re=ae.shifts)==null?void 0:re.some(de=>(de.assignments||[]).length>0)}))||x(o)}v(p)};async function q(o){const p=W==null?void 0:W.find(z=>z.id===o);R({isOpen:!0,isLoading:!1,eventId:o,eventTitle:p==null?void 0:p.title})}async function Y(){if(L.eventId){R(o=>({...o,isLoading:!0}));try{const o=await K.delete(`/events/${L.eventId}`);o.data.status==="success"?(R({isOpen:!1,isLoading:!1}),V({isVisible:!0,message:`"${o.data.event_title}" moved to trash`,type:"success",action:{label:"Undo",onClick:()=>G(o.data.event_id),variant:"primary"}}),r()):V({isVisible:!0,message:o.data.message||"Unable to delete event",type:"error"})}catch(o){console.error("Failed to delete event:",o),V({isVisible:!0,message:"Unable to delete event",type:"error"})}finally{R(o=>({...o,isLoading:!1}))}}}async function G(o){try{const p=await K.post(`/events/${o}/restore`);p.data.status==="success"?(V({isVisible:!0,message:"Event restored to draft",type:"success"}),r()):V({isVisible:!0,message:p.data.message||"Unable to restore event",type:"error"})}catch(p){console.error("Failed to restore event:",p),V({isVisible:!0,message:"Unable to restore event",type:"error"})}}function ge(){R({isOpen:!1,isLoading:!1})}function ie(o){y({isOpen:!0,eventId:o,isLoading:!1})}async function fe(){if(X.eventId){y(o=>({...o,isLoading:!0}));try{const o=await K.post(`/events/${X.eventId}/publish`);o.data.status==="success"?(V({isVisible:!0,message:"Event published successfully",type:"success"}),y({isOpen:!1,isLoading:!1}),r()):(V({isVisible:!0,message:o.data.message||"Unable to publish event",type:"error"}),y({isOpen:!1,isLoading:!1}))}catch(o){console.error("Failed to publish event:",o),V({isVisible:!0,message:"Unable to publish event",type:"error"}),y({isOpen:!1,isLoading:!1})}}}function ye(){y({isOpen:!1,isLoading:!1})}function he(o,p){b({isOpen:!0,assignmentId:o,isLoading:!1,workerName:p})}async function me(){var o,p;if(d.assignmentId){b(z=>({...z,isLoading:!0}));try{const z=await K.delete(`/staffing/${d.assignmentId}`);((o=z.data)==null?void 0:o.status)==="success"?(V({isVisible:!0,message:"Worker unassigned successfully",type:"success"}),b({isOpen:!1,isLoading:!1}),r()):(V({isVisible:!0,message:((p=z.data)==null?void 0:p.message)||"Unable to unassign worker",type:"error"}),b({isOpen:!1,isLoading:!1}))}catch(z){console.error("Failed to unassign worker:",z),V({isVisible:!0,message:"Unable to unassign worker",type:"error"}),b({isOpen:!1,isLoading:!1})}}}const Me=o=>{B({isOpen:!0,shiftId:o})},ce=()=>{B({isOpen:!1})},ve=()=>{ce(),V({isVisible:!0,message:"Worker assigned",type:"success"}),r()},ne=W.filter(o=>{var p;if(T){const z=T.toLowerCase();if(!(o.title.toLowerCase().includes(z)||((p=o.venue)==null?void 0:p.name.toLowerCase().includes(z))))return!1}if(i==="active")switch(c){case"needs_workers":return o.unfilled_roles_count>0;case"partially_filled":return o.unfilled_roles_count>0&&o.assigned_workers_count>0;case"fully_staffed":return o.unfilled_roles_count===0&&o.assigned_workers_count>0;case"all":default:return!0}return!0}).sort((o,p)=>{var z,Z;switch(J){case"name":return o.title.localeCompare(p.title);case"staffing":return o.staffing_percentage-p.staffing_percentage;case"date":default:const ue=((z=o.schedule)==null?void 0:z.start_time_utc)||o.created_at,ae=((Z=p.schedule)==null?void 0:Z.start_time_utc)||p.created_at;return new Date(ue).getTime()-new Date(ae).getTime()}});return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-2",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-900",children:"Events"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Manage events and assign workers"})]}),e.jsxs("button",{onClick:()=>s("/events/create"),className:"w-full sm:w-auto inline-flex items-center justify-center gap-2 px-4 py-2 bg-teal-600 text-white font-medium rounded-lg hover:bg-teal-700 transition-colors shadow-sm min-h-touch",children:[e.jsx(Ke,{size:20}),"Create New Event"]})]}),n.get("date")&&e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-teal-50 border border-teal-200 rounded-lg",children:[e.jsx(Oe,{size:16,className:"text-teal-600"}),e.jsxs("span",{className:"text-sm font-medium text-teal-900",children:["Showing events for ",be(xe(n.get("date")),"EEEE, MMMM d, yyyy")]}),e.jsx("button",{onClick:()=>{const o=new URLSearchParams(n);o.delete("date"),a(o)},className:"ml-auto text-teal-600 hover:text-teal-700",title:"Clear date filter",children:e.jsx(Ne,{size:16})})]})]}),e.jsxs("div",{className:"flex gap-6 border-b border-gray-200 mb-6",children:[e.jsx("button",{onClick:()=>l("draft"),className:`pb-3 px-1 font-medium transition-colors border-b-2 ${i==="draft"?"border-teal-600 text-teal-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Draft Events"}),e.jsx("button",{onClick:()=>l("active"),className:`pb-3 px-1 font-medium transition-colors border-b-2 ${i==="active"?"border-teal-600 text-teal-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Active Events"}),e.jsx("button",{onClick:()=>l("completed"),className:`pb-3 px-1 font-medium transition-colors border-b-2 ${i==="completed"?"border-teal-600 text-teal-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Completed Events"})]}),e.jsxs("div",{className:"flex flex-col md:flex-row items-stretch md:items-center gap-3 sm:gap-4 mb-6",children:[e.jsxs("div",{className:"w-full md:flex-1 md:max-w-md relative",children:[e.jsx(Je,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),e.jsx("input",{type:"text",placeholder:"Search events or venues...",value:k,onChange:o=>O(o.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent"})]}),e.jsxs("select",{value:J,onChange:o=>P(o.target.value),className:"w-full sm:w-auto px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500 bg-white",children:[e.jsx("option",{value:"date",children:"Sort by Date"}),e.jsx("option",{value:"name",children:"Sort by Name"}),i!=="draft"&&e.jsx("option",{value:"staffing",children:"Sort by Staffing"})]}),i==="active"&&e.jsxs("div",{className:"w-full sm:w-auto flex flex-wrap gap-2",children:[e.jsx("button",{onClick:()=>S("all"),className:`w-full sm:w-auto px-3 py-2 text-sm font-medium rounded-lg transition ${c==="all"?"bg-gray-100 text-gray-700":"bg-white text-gray-600 hover:bg-gray-50 border border-gray-300"}`,children:"All"}),e.jsx("button",{onClick:()=>S("needs_workers"),className:`w-full sm:w-auto px-3 py-2 text-sm font-medium rounded-lg transition ${c==="needs_workers"?"bg-red-100 text-red-700":"bg-white text-gray-600 hover:bg-gray-50 border border-gray-300"}`,children:"Needs Workers"}),e.jsx("button",{onClick:()=>S("fully_staffed"),className:`w-full sm:w-auto px-3 py-2 text-sm font-medium rounded-lg transition ${c==="fully_staffed"?"bg-green-100 text-green-700":"bg-white text-gray-600 hover:bg-gray-50 border border-gray-300"}`,children:"Ready"})]})]}),u?e.jsxs("div",{className:"space-y-4",children:[e.jsx(qe,{}),e.jsx(qe,{}),e.jsx(qe,{})]}):e.jsxs(e.Fragment,{children:[i==="draft"&&e.jsx(St,{events:ne,onDelete:q,onPublish:ie,onNavigate:o=>s(o),searchQuery:k}),i==="active"&&e.jsx(Ct,{events:ne,expandedEvents:E,onToggleEvent:M,onAssignWorker:Me,onUnassign:he,onQuickFill:(o,p,z,Z)=>I({isOpen:!0,eventId:o,roleName:p,unfilledShiftIds:z,payRate:Z}),onPublish:ie,onDelete:q,onEdit:o=>$({isOpen:!0,event:o}),searchQuery:k}),i==="completed"&&e.jsx(Et,{events:ne,searchQuery:k,onApproveHours:o=>H({isOpen:!0,event:o})})]})]}),Q.isOpen&&Q.shiftId&&e.jsx(vt,{shiftId:Q.shiftId,onClose:ce,onSuccess:ve}),e.jsx(Ze,{isVisible:C.isVisible,message:C.message,type:C.type,action:C.action,onClose:()=>V({...C,isVisible:!1})}),e.jsx(Ve,{isOpen:X.isOpen,onClose:ye,onConfirm:fe,title:"Publish Event",message:"Ready to publish? This will create shifts and make them available for worker assignment.",confirmText:X.isLoading?"Publishingâ€¦":"Publish",cancelText:"Cancel",isLoading:X.isLoading,isDestructive:!1}),e.jsx(Ve,{isOpen:d.isOpen,onClose:()=>b({isOpen:!1,isLoading:!1}),onConfirm:me,title:"Unassign Worker",message:`Remove ${d.workerName||"this worker"} from this shift?`,confirmText:d.isLoading?"Removingâ€¦":"Unassign",cancelText:"Cancel",isLoading:d.isLoading,isDestructive:!0}),e.jsx(Ve,{isOpen:L.isOpen,onClose:ge,onConfirm:Y,title:"Delete Event",message:`Delete "${L.eventTitle}"? This action cannot be undone.`,confirmText:L.isLoading?"Deletingâ€¦":"Delete",cancelText:"Cancel",isLoading:L.isLoading,isDestructive:!0}),e.jsx(jt,{isOpen:A.isOpen,eventId:A.eventId||0,roleName:A.roleName||"",unfilledShiftIds:A.unfilledShiftIds,defaultPayRate:A.payRate,onClose:()=>I({isOpen:!1,unfilledShiftIds:[]}),onDone:({assigned:o,conflicts:p,details:z})=>{I({isOpen:!1,unfilledShiftIds:[]});let Z=`Assigned ${o} workers â€¢ ${p} skipped`;p>0&&z&&(Z+=`: ${z}`),V({isVisible:!0,message:Z,type:p>0?"error":"success"}),r()}}),m.event&&e.jsx(wt,{event:m.event,isOpen:m.isOpen,onClose:()=>$({isOpen:!1,event:void 0}),onSuccess:()=>{r(),$({isOpen:!1,event:void 0})}}),F.isOpen&&F.event&&e.jsx(kt,{event:F.event,isOpen:F.isOpen,onClose:()=>{H({isOpen:!1}),r()},onSuccess:()=>{r(),H({isOpen:!1})}})]})}function St({events:s,onDelete:n,onPublish:a,onNavigate:t,searchQuery:f}){const i=c=>{if(!c)return"No date set";const g=xe(c);return be(g,"MMM d, yyyy")},h=c=>{if(!c)return"";const g=xe(c);return be(g,"h:mm a")};return s.length===0?e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ“…"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:f?"No draft events found":"No draft events yet"}),e.jsx("p",{className:"text-gray-600 mb-6",children:f?"Try adjusting your search query":"Create your first event to get started"}),!f&&e.jsxs("button",{onClick:()=>t("/events/create"),className:"inline-flex items-center gap-2 px-4 py-2 bg-teal-600 text-white font-medium rounded-lg hover:bg-teal-700 transition-colors",children:[e.jsx(Ke,{size:20}),"Create Event"]})]}):e.jsxs("div",{className:"space-y-4",children:[s.length>0&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Re,{className:"h-5 w-5 text-blue-600"}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium text-blue-900",children:[s.length," Event",s.length!==1?"s":""," Today"]}),e.jsxs("p",{className:"text-xs text-blue-700",children:[s.reduce((c,g)=>c+(g.assigned_workers_count||0),0),"/",s.reduce((c,g)=>c+(g.total_workers_needed||0),0)," workers hired"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:s.reduce((c,g)=>c+(g.assigned_workers_count||0),0)}),e.jsx("p",{className:"text-xs text-blue-700",children:"hired"})]})]})}),s.map(c=>{var g;return e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 hover:shadow-md transition-shadow",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:[c.title,c.schedule&&e.jsxs("span",{className:"ml-2 text-sm font-normal text-gray-600",children:["â€¢ ",h(c.schedule.start_time_utc),"â€“",h(c.schedule.end_time_utc)]})]})}),e.jsx("span",{className:"px-2.5 py-1 bg-gray-100 text-gray-700 text-xs font-medium rounded-full",children:"Draft"})]}),c.venue&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 mb-2",children:[e.jsx(De,{size:16,className:"text-gray-400 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:((g=c.venue)==null?void 0:g.name)||"No venue"})]}),c.schedule&&e.jsx("div",{className:"flex items-center gap-4 text-sm text-gray-600 mb-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Oe,{size:16,className:"text-gray-400 flex-shrink-0"}),e.jsx("span",{children:i(c.schedule.start_time_utc)})]})}),c.total_workers_needed>0&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(Re,{size:16,className:"text-gray-400"}),e.jsxs("span",{children:[c.total_workers_needed," workers needed"]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{onClick:()=>t(`/events/${c.id}/edit`),className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition",title:"Edit",children:e.jsx(os,{size:18})})})]})})},c.id)})]})}function Ct({events:s,expandedEvents:n,onToggleEvent:a,onAssignWorker:t,onUnassign:f,onQuickFill:i,onPublish:h,onDelete:c,onEdit:g,searchQuery:k}){const O=u=>{const U=xe(u);return be(U,"EEE, MMM d, yyyy")},T=u=>{const U=xe(u);return be(U,"h:mm a")},J=u=>{if(!u.schedule)return!1;const W=(xe(u.schedule.start_time_utc).getTime()-new Date().getTime())/(1e3*60*60);return W>0&&W<=48},P=u=>{switch(u){case"fully_staffed":return e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 bg-green-100 text-green-700 text-xs font-medium rounded-full",children:[e.jsx(ze,{size:14}),"Ready"]});case"partially_staffed":return e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 bg-yellow-100 text-yellow-700 text-xs font-medium rounded-full",children:[e.jsx(Ce,{size:14}),"Partial"]});case"needs_workers":return e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 bg-red-100 text-red-700 text-xs font-medium rounded-full",children:[e.jsx(Ne,{size:14}),"Needs Workers"]});default:return null}};return s.length===0?e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ“…"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:k?"No active events found":"No active events"}),e.jsx("p",{className:"text-gray-600",children:k?"Try adjusting your search query or filters":"Publish draft events to see them here"})]}):e.jsx("div",{className:"space-y-4",children:s.map(u=>{var W;const U=n.has(u.id);return e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[e.jsxs("div",{onClick:()=>a(u.id),className:"w-full px-4 sm:px-6 py-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 hover:bg-gray-50 transition-colors cursor-pointer",children:[e.jsxs("div",{className:"flex-1 text-left",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-2",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:[u.title,u.schedule&&e.jsxs("span",{className:"ml-2 text-sm font-normal text-gray-600",children:["â€¢ ",T(u.schedule.start_time_utc),"â€“",T(u.schedule.end_time_utc)]})]})}),P(u.staffing_status)]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600 mb-3",children:[u.venue&&e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(De,{size:14,className:"text-gray-400"}),((W=u.venue)==null?void 0:W.name)||"No venue"]}),u.schedule&&e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(Oe,{size:14,className:"text-gray-400"}),e.jsx("span",{children:O(u.schedule.start_time_utc)}),J(u)&&e.jsx("span",{className:"bg-red-600 text-white text-xs font-semibold px-2 py-0.5 rounded-full ml-2","aria-label":"Urgent: starts within 48 hours",children:"Urgent"})]})]}),e.jsxs("div",{className:"mb-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm mb-1",children:[e.jsxs("span",{className:"font-medium text-gray-700",children:[u.assigned_workers_count,"/",u.total_workers_needed," hired"]}),e.jsxs("span",{className:"font-semibold text-gray-900",children:[u.staffing_percentage,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-full rounded-full transition-all ${u.staffing_percentage===100?"bg-green-500":u.staffing_percentage>0?"bg-yellow-500":"bg-red-500"}`,style:{width:`${u.staffing_percentage}%`}})})]}),u.unfilled_roles_count>0&&e.jsxs("p",{className:"text-sm text-red-600 font-medium",children:[u.unfilled_roles_count," still needed"]}),(u.total_pay_amount!==void 0||u.shifts_by_role&&u.shifts_by_role.length>0)&&e.jsxs("div",{className:"mt-3 inline-flex items-center gap-2 px-3 py-1.5 bg-green-50 border border-green-200 rounded-lg",children:[e.jsx("span",{className:"text-xs font-medium text-gray-600",children:"Estimated Cost:"}),e.jsxs("span",{className:"text-base font-bold text-green-700",children:["$",(()=>{if(u.total_pay_amount!==void 0&&u.total_pay_amount>0)return te(u.total_pay_amount,2,"0.00");let _=0;return u.shifts_by_role&&u.shifts_by_role.length>0&&u.shifts_by_role.forEach(E=>{var v;(v=E.shifts)==null||v.forEach(F=>{var H;(H=F.assignments)==null||H.forEach(Q=>{const B=Te(Q.effective_pay);_+=B})})}),te(_,2,"0.00")})()]}),e.jsxs("span",{className:"text-xs text-gray-500",children:["(",u.assigned_workers_count," worker",u.assigned_workers_count!==1?"s":"",")"]})]})]}),e.jsxs("div",{className:"ml-4 flex items-center gap-2",children:[g&&u.status==="published"&&e.jsx("button",{onClick:_=>{_.stopPropagation(),g(u)},title:"Edit Event",className:"p-1.5 text-teal-600 hover:text-teal-700 hover:bg-teal-50 rounded transition-colors",children:e.jsx(Rs,{size:14})}),c&&e.jsx("button",{onClick:_=>{_.stopPropagation(),c(u.id)},title:"Delete",className:"p-1.5 text-red-600 hover:text-red-700 hover:bg-red-50 rounded transition-colors",children:e.jsx(Xe,{size:14})}),e.jsx("div",{className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:U?e.jsx(Ns,{size:24,className:"text-gray-600 hover:text-gray-800"}):e.jsx(Fs,{size:24,className:"text-gray-600 hover:text-gray-800"})})]})]}),U&&e.jsx("div",{className:"border-t border-gray-200 bg-gray-50 px-6 py-4",children:u.shifts_by_role&&u.shifts_by_role.length>0?e.jsx("div",{className:"space-y-4",children:u.shifts_by_role.map(_=>e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:_.role_name}),e.jsxs("span",{className:"text-sm text-gray-600",children:[_.filled_shifts,"/",_.total_shifts," hired"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[_.filled_shifts<_.total_shifts&&e.jsxs("span",{className:"px-2.5 py-1 bg-red-100 text-red-700 text-xs font-medium rounded-full",children:[_.total_shifts-_.filled_shifts," needed"]}),_.filled_shifts<_.total_shifts&&e.jsx("button",{onClick:E=>{var H;E.stopPropagation();const v=_.shifts.filter(Q=>Q.staffing_progress.percentage<100).sort((Q,B)=>new Date(Q.start_time_utc).getTime()-new Date(B.start_time_utc).getTime()).map(Q=>Q.id),F=(H=_.shifts[0])==null?void 0:H.pay_rate;i(u.id,_.role_name,v,F)},className:"px-2.5 py-1 text-xs font-semibold bg-teal-600 text-white rounded hover:bg-teal-700",title:"Quick Fill by Skill",children:"Quick Fill by Skill"})]})]}),e.jsx("div",{className:"space-y-2",children:_.shifts.map((E,v)=>e.jsxs("div",{className:"flex items-center justify-between py-2 px-3 bg-gray-50 rounded border border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-6 h-6 bg-gray-200 text-gray-700 rounded-md flex items-center justify-center text-xs font-medium",children:v+1}),e.jsxs("span",{className:"text-sm text-gray-700",children:[T(E.start_time_utc)," - ",T(E.end_time_utc)]}),E.assignments.length>0&&e.jsx("div",{className:"flex items-center gap-1 flex-wrap",children:E.assignments.map(F=>{const H=`${F.worker.first_name} ${F.worker.last_name}`,Q=Number(F.hourly_rate||E.pay_rate||0);return e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"bg-white text-black border border-gray-200 rounded-full px-2.5 py-1 text-sm font-medium shadow-sm max-w-[140px] truncate",title:`${H} â€¢ $${te(Q,0,"0")}/hr`,children:H}),e.jsx("button",{onClick:B=>{B.stopPropagation(),f(F.id,H)},className:"w-5 h-5 flex items-center justify-center text-red-600 hover:text-red-700 hover:bg-red-50 rounded",title:"Unassign worker",children:e.jsx(Ne,{size:12})})]},F.id)})})]}),E.staffing_progress.percentage===100?e.jsxs("span",{className:"flex items-center gap-1.5 text-sm font-medium text-green-600",children:[e.jsx(ze,{size:16}),"Assigned"]}):e.jsx("button",{onClick:F=>{F.stopPropagation(),t(E.id)},className:"px-3 py-1.5 bg-teal-600 text-white text-sm font-medium rounded-lg hover:bg-teal-700 transition-colors",children:"Assign Worker"})]},E.id))})]},_.role_name))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-gray-500 mb-4",children:u.status==="draft"?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"font-medium",children:"This event is still in draft status"}),e.jsx("p",{className:"text-sm",children:"Publish the event to generate shifts and assign workers"})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"font-medium",children:"No shifts available"}),e.jsx("p",{className:"text-sm",children:"This event may not have any shifts generated yet"})]})}),e.jsx("div",{className:"flex items-center justify-center gap-3",children:u.status==="draft"&&e.jsx("button",{onClick:()=>h(u.id),className:"px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-colors",children:"Publish Event"})})]})})]},u.id)})})}function Et({events:s,searchQuery:n,onApproveHours:a}){const t=i=>{const h=xe(i);return be(h,"MMM d, yyyy")},f=i=>{const h=xe(i);return be(h,"h:mm a")};return s.length===0?e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ“‹"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:n?"No past events found":"No past events yet"}),e.jsx("p",{className:"text-gray-600",children:n?"Try adjusting your search query":"Completed events will appear here"})]}):e.jsx("div",{className:"space-y-4",children:s.map(i=>{var c;let h=Te(i.total_hours_worked);return h===0&&i.shifts_by_role&&i.shifts_by_role.length>0&&i.shifts_by_role.forEach(g=>{var k;(k=g.shifts)==null||k.forEach(O=>{var T;(T=O.assignments)==null||T.forEach(J=>{const P=Te(J.effective_hours);h+=P})})}),e.jsxs("div",{className:"border border-gray-200 rounded-lg p-5 hover:border-gray-300 hover:shadow-sm transition-all",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-1 truncate",children:i.title}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600 flex-wrap",children:[i.schedule&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Oe,{className:"h-4 w-4 flex-shrink-0"}),t(i.schedule.start_time_utc)]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Pe,{className:"h-4 w-4 flex-shrink-0"}),f(i.schedule.start_time_utc)," - ",f(i.schedule.end_time_utc)]})]}),i.venue&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(De,{className:"h-4 w-4 flex-shrink-0"}),i.venue.name]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0 ml-4",children:[e.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-gray-100 text-gray-700 rounded",children:"Completed"}),i.approval_status&&i.approval_status.pending>0&&e.jsxs("span",{className:"px-2 py-1 text-xs font-medium bg-amber-100 text-amber-700 rounded",children:[i.approval_status.pending," Pending"]})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4 py-3 border-y border-gray-100",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Workers"}),e.jsx("div",{className:"text-lg font-semibold text-gray-900",children:i.assigned_workers_count||0})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Hours"}),e.jsx("div",{className:"text-lg font-semibold text-gray-900",children:te(h,2,"0.00")})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Cost"}),e.jsxs("div",{className:"text-lg font-semibold text-gray-900",children:["$",(c=i.cost_summary)!=null&&c.total_estimated_cost?te(i.cost_summary.total_estimated_cost,2,"0.00"):i.total_pay_amount?te(i.total_pay_amount,2,"0.00"):"0.00"]}),i.approval_status&&i.approval_status.pending>0&&i.cost_summary&&e.jsxs("div",{className:"text-xs text-amber-600 font-medium mt-0.5",children:["$",te(i.cost_summary.pending_cost,2,"0.00")," pending"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Staffing"}),e.jsxs("div",{className:"text-lg font-semibold text-green-600",children:[i.staffing_percentage||100,"%"]})]})]}),e.jsx("div",{className:"mt-4 flex justify-end",children:a&&e.jsxs("button",{onClick:()=>a(i),className:bt("px-4 py-2 text-sm font-medium rounded-lg flex items-center gap-2 transition-colors shadow-sm",i.approval_status&&i.approval_status.pending>0?"bg-amber-600 hover:bg-amber-700 text-white":(i.approval_status&&i.approval_status.approved===i.approval_status.total,"bg-green-600 hover:bg-green-700 text-white")),children:[i.approval_status&&i.approval_status.pending>0?e.jsxs(e.Fragment,{children:[e.jsx(Pe,{className:"h-4 w-4"}),"Approve Hours (",i.approval_status.pending,")"]}):e.jsxs(e.Fragment,{children:[e.jsx(ze,{className:"h-4 w-4"}),"Approved"]}),e.jsx(Ls,{className:"h-4 w-4"})]})})]},i.id)})})}export{Gt as EventsPage};
