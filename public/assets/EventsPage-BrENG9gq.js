import{c as Ie,j as e,X as Ae,a as re,A as we,b as Cs,C as As}from"./index-ULZG8PsA.js";import{r as b,b as ds,f as Ms}from"./vendor-79DyBOV9.js";import{f as $s,a as as}from"./dateUtils-CHmZs4Ub.js";import{C as _e}from"./clock-CJLSXQKj.js";import{M as Ue}from"./map-pin-C5rkqt2K.js";import{U as Je}from"./users-HrzT5kSV.js";import{S as ss,T as Re,L as Ke,C as He}from"./ConfirmationModal-BgDeTk7m.js";import{D as ms}from"./dollar-sign-C4id7iVS.js";import{T as ts}from"./Toast-D6lmxghp.js";import{C as Fs}from"./x-circle-DBO6qIIO.js";import{b as zs,a as Es,c as Ls,e as Ps,p as Ts}from"./Prep Cook-CE8OFMb5.js";import{P as us}from"./pen-square-CSr7cSuG.js";import{P as We}from"./plus-UaJwqVqF.js";import{f as Ne}from"./index-C_slYh2M.js";import{p as ge}from"./index-BK_MyBzW.js";import{C as qe}from"./calendar-BkBsJcvm.js";import{C as Ds}from"./chevron-down-BVphq-Ja.js";import{C as Rs}from"./chevron-right-DaOU1-bF.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ns=Ie("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=Ie("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Is=Ie("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Me=Ie("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vs=Ie("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);function xs(s,r=0){const n=typeof s=="string"?Number(s):s;return Number.isFinite(n)?n:r}function ie(s,r=2,n="0"){const t=xs(s,NaN);if(!Number.isFinite(t))return n;try{return t.toFixed(r)}catch{return n}}function hs(s){var r,n,t="";if(typeof s=="string"||typeof s=="number")t+=s;else if(typeof s=="object")if(Array.isArray(s)){var u=s.length;for(r=0;r<u;r++)s[r]&&(n=hs(s[r]))&&(t&&(t+=" "),t+=n)}else for(n in s)s[n]&&(t&&(t+=" "),t+=n);return t}function Os(){for(var s,r,n=0,t="",u=arguments.length;n<u;n++)(s=arguments[n])&&(r=hs(s))&&(t&&(t+=" "),t+=r);return t}const rs="-",Us=s=>{const r=qs(s),{conflictingClassGroups:n,conflictingClassGroupModifiers:t}=s;return{getClassGroupId:y=>{const m=y.split(rs);return m[0]===""&&m.length!==1&&m.shift(),gs(m,r)||Ws(y)},getConflictingClassGroupIds:(y,m)=>{const x=n[y]||[];return m&&t[y]?[...x,...t[y]]:x}}},gs=(s,r)=>{var y;if(s.length===0)return r.classGroupId;const n=s[0],t=r.nextPart.get(n),u=t?gs(s.slice(1),t):void 0;if(u)return u;if(r.validators.length===0)return;const a=s.join(rs);return(y=r.validators.find(({validator:m})=>m(a)))==null?void 0:y.classGroupId},ls=/^\[(.+)\]$/,Ws=s=>{if(ls.test(s)){const r=ls.exec(s)[1],n=r==null?void 0:r.substring(0,r.indexOf(":"));if(n)return"arbitrary.."+n}},qs=s=>{const{theme:r,classGroups:n}=s,t={nextPart:new Map,validators:[]};for(const u in n)Xe(n[u],t,u,r);return t},Xe=(s,r,n,t)=>{s.forEach(u=>{if(typeof u=="string"){const a=u===""?r:os(r,u);a.classGroupId=n;return}if(typeof u=="function"){if(Hs(u)){Xe(u(t),r,n,t);return}r.validators.push({validator:u,classGroupId:n});return}Object.entries(u).forEach(([a,y])=>{Xe(y,os(r,a),n,t)})})},os=(s,r)=>{let n=s;return r.split(rs).forEach(t=>{n.nextPart.has(t)||n.nextPart.set(t,{nextPart:new Map,validators:[]}),n=n.nextPart.get(t)}),n},Hs=s=>s.isThemeGetter,Bs=s=>{if(s<1)return{get:()=>{},set:()=>{}};let r=0,n=new Map,t=new Map;const u=(a,y)=>{n.set(a,y),r++,r>s&&(r=0,t=n,n=new Map)};return{get(a){let y=n.get(a);if(y!==void 0)return y;if((y=t.get(a))!==void 0)return u(a,y),y},set(a,y){n.has(a)?n.set(a,y):u(a,y)}}},Ze="!",Ye=":",Qs=Ye.length,Gs=s=>{const{prefix:r,experimentalParseClassName:n}=s;let t=u=>{const a=[];let y=0,m=0,x=0,C;for(let Z=0;Z<u.length;Z++){let f=u[Z];if(y===0&&m===0){if(f===Ye){a.push(u.slice(x,Z)),x=Z+Qs;continue}if(f==="/"){C=Z;continue}}f==="["?y++:f==="]"?y--:f==="("?m++:f===")"&&m--}const z=a.length===0?u:u.substring(x),J=Js(z),ee=J!==z,X=C&&C>x?C-x:void 0;return{modifiers:a,hasImportantModifier:ee,baseClassName:J,maybePostfixModifierPosition:X}};if(r){const u=r+Ye,a=t;t=y=>y.startsWith(u)?a(y.substring(u.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:y,maybePostfixModifierPosition:void 0}}if(n){const u=t;t=a=>n({className:a,parseClassName:u})}return t},Js=s=>s.endsWith(Ze)?s.substring(0,s.length-1):s.startsWith(Ze)?s.substring(1):s,Ks=s=>{const r=Object.fromEntries(s.orderSensitiveModifiers.map(t=>[t,!0]));return t=>{if(t.length<=1)return t;const u=[];let a=[];return t.forEach(y=>{y[0]==="["||r[y]?(u.push(...a.sort(),y),a=[]):a.push(y)}),u.push(...a.sort()),u}},Xs=s=>({cache:Bs(s.cacheSize),parseClassName:Gs(s),sortModifiers:Ks(s),...Us(s)}),Zs=/\s+/,Ys=(s,r)=>{const{parseClassName:n,getClassGroupId:t,getConflictingClassGroupIds:u,sortModifiers:a}=r,y=[],m=s.trim().split(Zs);let x="";for(let C=m.length-1;C>=0;C-=1){const z=m[C],{isExternal:J,modifiers:ee,hasImportantModifier:X,baseClassName:Z,maybePostfixModifierPosition:f}=n(z);if(J){x=z+(x.length>0?" "+x:x);continue}let Q=!!f,M=t(Q?Z.substring(0,f):Z);if(!M){if(!Q){x=z+(x.length>0?" "+x:x);continue}if(M=t(Z),!M){x=z+(x.length>0?" "+x:x);continue}Q=!1}const D=a(ee).join(":"),k=X?D+Ze:D,V=k+M;if(y.includes(V))continue;y.push(V);const B=u(M,Q);for(let H=0;H<B.length;++H){const E=B[H];y.push(k+E)}x=z+(x.length>0?" "+x:x)}return x};function et(){let s=0,r,n,t="";for(;s<arguments.length;)(r=arguments[s++])&&(n=ps(r))&&(t&&(t+=" "),t+=n);return t}const ps=s=>{if(typeof s=="string")return s;let r,n="";for(let t=0;t<s.length;t++)s[t]&&(r=ps(s[t]))&&(n&&(n+=" "),n+=r);return n};function st(s,...r){let n,t,u,a=y;function y(x){const C=r.reduce((z,J)=>J(z),s());return n=Xs(C),t=n.cache.get,u=n.cache.set,a=m,m(x)}function m(x){const C=t(x);if(C)return C;const z=Ys(x,n);return u(x,z),z}return function(){return a(et.apply(null,arguments))}}const oe=s=>{const r=n=>n[s]||[];return r.isThemeGetter=!0,r},fs=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,bs=/^\((?:(\w[\w-]*):)?(.+)\)$/i,tt=/^\d+\/\d+$/,rt=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,at=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,nt=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,lt=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,ot=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Le=s=>tt.test(s),q=s=>!!s&&!Number.isNaN(Number(s)),Ce=s=>!!s&&Number.isInteger(Number(s)),Be=s=>s.endsWith("%")&&q(s.slice(0,-1)),ke=s=>rt.test(s),it=()=>!0,ct=s=>at.test(s)&&!nt.test(s),ys=()=>!1,dt=s=>lt.test(s),mt=s=>ot.test(s),ut=s=>!_(s)&&!S(s),xt=s=>Pe(s,ws,ys),_=s=>fs.test(s),$e=s=>Pe(s,Ns,ct),Qe=s=>Pe(s,bt,q),is=s=>Pe(s,js,ys),ht=s=>Pe(s,vs,mt),Ve=s=>Pe(s,ks,dt),S=s=>bs.test(s),De=s=>Te(s,Ns),gt=s=>Te(s,yt),cs=s=>Te(s,js),pt=s=>Te(s,ws),ft=s=>Te(s,vs),Oe=s=>Te(s,ks,!0),Pe=(s,r,n)=>{const t=fs.exec(s);return t?t[1]?r(t[1]):n(t[2]):!1},Te=(s,r,n=!1)=>{const t=bs.exec(s);return t?t[1]?r(t[1]):n:!1},js=s=>s==="position"||s==="percentage",vs=s=>s==="image"||s==="url",ws=s=>s==="length"||s==="size"||s==="bg-size",Ns=s=>s==="length",bt=s=>s==="number",yt=s=>s==="family-name",ks=s=>s==="shadow",jt=()=>{const s=oe("color"),r=oe("font"),n=oe("text"),t=oe("font-weight"),u=oe("tracking"),a=oe("leading"),y=oe("breakpoint"),m=oe("container"),x=oe("spacing"),C=oe("radius"),z=oe("shadow"),J=oe("inset-shadow"),ee=oe("text-shadow"),X=oe("drop-shadow"),Z=oe("blur"),f=oe("perspective"),Q=oe("aspect"),M=oe("ease"),D=oe("animate"),k=()=>["auto","avoid","all","avoid-page","page","left","right","column"],V=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],B=()=>[...V(),S,_],H=()=>["auto","hidden","clip","visible","scroll"],E=()=>["auto","contain","none"],j=()=>[S,_,x],R=()=>[Le,"full","auto",...j()],O=()=>[Ce,"none","subgrid",S,_],h=()=>["auto",{span:["full",Ce,S,_]},Ce,S,_],c=()=>[Ce,"auto",S,_],p=()=>["auto","min","max","fr",S,_],T=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],v=()=>["start","end","center","stretch","center-safe","end-safe"],w=()=>["auto",...j()],P=()=>[Le,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...j()],d=()=>[s,S,_],A=()=>[...V(),cs,is,{position:[S,_]}],i=()=>["no-repeat",{repeat:["","x","y","space","round"]}],g=()=>["auto","cover","contain",pt,xt,{size:[S,_]}],F=()=>[Be,De,$e],N=()=>["","none","full",C,S,_],L=()=>["",q,De,$e],U=()=>["solid","dashed","dotted","double"],se=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],K=()=>[q,Be,cs,is],fe=()=>["","none",Z,S,_],ce=()=>["none",q,S,_],be=()=>["none",q,S,_],ye=()=>[q,S,_],je=()=>[Le,"full",...j()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[ke],breakpoint:[ke],color:[it],container:[ke],"drop-shadow":[ke],ease:["in","out","in-out"],font:[ut],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[ke],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[ke],shadow:[ke],spacing:["px",q],text:[ke],"text-shadow":[ke],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",Le,_,S,Q]}],container:["container"],columns:[{columns:[q,_,S,m]}],"break-after":[{"break-after":k()}],"break-before":[{"break-before":k()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:B()}],overflow:[{overflow:H()}],"overflow-x":[{"overflow-x":H()}],"overflow-y":[{"overflow-y":H()}],overscroll:[{overscroll:E()}],"overscroll-x":[{"overscroll-x":E()}],"overscroll-y":[{"overscroll-y":E()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:R()}],"inset-x":[{"inset-x":R()}],"inset-y":[{"inset-y":R()}],start:[{start:R()}],end:[{end:R()}],top:[{top:R()}],right:[{right:R()}],bottom:[{bottom:R()}],left:[{left:R()}],visibility:["visible","invisible","collapse"],z:[{z:[Ce,"auto",S,_]}],basis:[{basis:[Le,"full","auto",m,...j()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[q,Le,"auto","initial","none",_]}],grow:[{grow:["",q,S,_]}],shrink:[{shrink:["",q,S,_]}],order:[{order:[Ce,"first","last","none",S,_]}],"grid-cols":[{"grid-cols":O()}],"col-start-end":[{col:h()}],"col-start":[{"col-start":c()}],"col-end":[{"col-end":c()}],"grid-rows":[{"grid-rows":O()}],"row-start-end":[{row:h()}],"row-start":[{"row-start":c()}],"row-end":[{"row-end":c()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":p()}],"auto-rows":[{"auto-rows":p()}],gap:[{gap:j()}],"gap-x":[{"gap-x":j()}],"gap-y":[{"gap-y":j()}],"justify-content":[{justify:[...T(),"normal"]}],"justify-items":[{"justify-items":[...v(),"normal"]}],"justify-self":[{"justify-self":["auto",...v()]}],"align-content":[{content:["normal",...T()]}],"align-items":[{items:[...v(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...v(),{baseline:["","last"]}]}],"place-content":[{"place-content":T()}],"place-items":[{"place-items":[...v(),"baseline"]}],"place-self":[{"place-self":["auto",...v()]}],p:[{p:j()}],px:[{px:j()}],py:[{py:j()}],ps:[{ps:j()}],pe:[{pe:j()}],pt:[{pt:j()}],pr:[{pr:j()}],pb:[{pb:j()}],pl:[{pl:j()}],m:[{m:w()}],mx:[{mx:w()}],my:[{my:w()}],ms:[{ms:w()}],me:[{me:w()}],mt:[{mt:w()}],mr:[{mr:w()}],mb:[{mb:w()}],ml:[{ml:w()}],"space-x":[{"space-x":j()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":j()}],"space-y-reverse":["space-y-reverse"],size:[{size:P()}],w:[{w:[m,"screen",...P()]}],"min-w":[{"min-w":[m,"screen","none",...P()]}],"max-w":[{"max-w":[m,"screen","none","prose",{screen:[y]},...P()]}],h:[{h:["screen","lh",...P()]}],"min-h":[{"min-h":["screen","lh","none",...P()]}],"max-h":[{"max-h":["screen","lh",...P()]}],"font-size":[{text:["base",n,De,$e]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[t,S,Qe]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",Be,_]}],"font-family":[{font:[gt,_,r]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[u,S,_]}],"line-clamp":[{"line-clamp":[q,"none",S,Qe]}],leading:[{leading:[a,...j()]}],"list-image":[{"list-image":["none",S,_]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",S,_]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:d()}],"text-color":[{text:d()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...U(),"wavy"]}],"text-decoration-thickness":[{decoration:[q,"from-font","auto",S,$e]}],"text-decoration-color":[{decoration:d()}],"underline-offset":[{"underline-offset":[q,"auto",S,_]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:j()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",S,_]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",S,_]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:A()}],"bg-repeat":[{bg:i()}],"bg-size":[{bg:g()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},Ce,S,_],radial:["",S,_],conic:[Ce,S,_]},ft,ht]}],"bg-color":[{bg:d()}],"gradient-from-pos":[{from:F()}],"gradient-via-pos":[{via:F()}],"gradient-to-pos":[{to:F()}],"gradient-from":[{from:d()}],"gradient-via":[{via:d()}],"gradient-to":[{to:d()}],rounded:[{rounded:N()}],"rounded-s":[{"rounded-s":N()}],"rounded-e":[{"rounded-e":N()}],"rounded-t":[{"rounded-t":N()}],"rounded-r":[{"rounded-r":N()}],"rounded-b":[{"rounded-b":N()}],"rounded-l":[{"rounded-l":N()}],"rounded-ss":[{"rounded-ss":N()}],"rounded-se":[{"rounded-se":N()}],"rounded-ee":[{"rounded-ee":N()}],"rounded-es":[{"rounded-es":N()}],"rounded-tl":[{"rounded-tl":N()}],"rounded-tr":[{"rounded-tr":N()}],"rounded-br":[{"rounded-br":N()}],"rounded-bl":[{"rounded-bl":N()}],"border-w":[{border:L()}],"border-w-x":[{"border-x":L()}],"border-w-y":[{"border-y":L()}],"border-w-s":[{"border-s":L()}],"border-w-e":[{"border-e":L()}],"border-w-t":[{"border-t":L()}],"border-w-r":[{"border-r":L()}],"border-w-b":[{"border-b":L()}],"border-w-l":[{"border-l":L()}],"divide-x":[{"divide-x":L()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":L()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...U(),"hidden","none"]}],"divide-style":[{divide:[...U(),"hidden","none"]}],"border-color":[{border:d()}],"border-color-x":[{"border-x":d()}],"border-color-y":[{"border-y":d()}],"border-color-s":[{"border-s":d()}],"border-color-e":[{"border-e":d()}],"border-color-t":[{"border-t":d()}],"border-color-r":[{"border-r":d()}],"border-color-b":[{"border-b":d()}],"border-color-l":[{"border-l":d()}],"divide-color":[{divide:d()}],"outline-style":[{outline:[...U(),"none","hidden"]}],"outline-offset":[{"outline-offset":[q,S,_]}],"outline-w":[{outline:["",q,De,$e]}],"outline-color":[{outline:d()}],shadow:[{shadow:["","none",z,Oe,Ve]}],"shadow-color":[{shadow:d()}],"inset-shadow":[{"inset-shadow":["none",J,Oe,Ve]}],"inset-shadow-color":[{"inset-shadow":d()}],"ring-w":[{ring:L()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:d()}],"ring-offset-w":[{"ring-offset":[q,$e]}],"ring-offset-color":[{"ring-offset":d()}],"inset-ring-w":[{"inset-ring":L()}],"inset-ring-color":[{"inset-ring":d()}],"text-shadow":[{"text-shadow":["none",ee,Oe,Ve]}],"text-shadow-color":[{"text-shadow":d()}],opacity:[{opacity:[q,S,_]}],"mix-blend":[{"mix-blend":[...se(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":se()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[q]}],"mask-image-linear-from-pos":[{"mask-linear-from":K()}],"mask-image-linear-to-pos":[{"mask-linear-to":K()}],"mask-image-linear-from-color":[{"mask-linear-from":d()}],"mask-image-linear-to-color":[{"mask-linear-to":d()}],"mask-image-t-from-pos":[{"mask-t-from":K()}],"mask-image-t-to-pos":[{"mask-t-to":K()}],"mask-image-t-from-color":[{"mask-t-from":d()}],"mask-image-t-to-color":[{"mask-t-to":d()}],"mask-image-r-from-pos":[{"mask-r-from":K()}],"mask-image-r-to-pos":[{"mask-r-to":K()}],"mask-image-r-from-color":[{"mask-r-from":d()}],"mask-image-r-to-color":[{"mask-r-to":d()}],"mask-image-b-from-pos":[{"mask-b-from":K()}],"mask-image-b-to-pos":[{"mask-b-to":K()}],"mask-image-b-from-color":[{"mask-b-from":d()}],"mask-image-b-to-color":[{"mask-b-to":d()}],"mask-image-l-from-pos":[{"mask-l-from":K()}],"mask-image-l-to-pos":[{"mask-l-to":K()}],"mask-image-l-from-color":[{"mask-l-from":d()}],"mask-image-l-to-color":[{"mask-l-to":d()}],"mask-image-x-from-pos":[{"mask-x-from":K()}],"mask-image-x-to-pos":[{"mask-x-to":K()}],"mask-image-x-from-color":[{"mask-x-from":d()}],"mask-image-x-to-color":[{"mask-x-to":d()}],"mask-image-y-from-pos":[{"mask-y-from":K()}],"mask-image-y-to-pos":[{"mask-y-to":K()}],"mask-image-y-from-color":[{"mask-y-from":d()}],"mask-image-y-to-color":[{"mask-y-to":d()}],"mask-image-radial":[{"mask-radial":[S,_]}],"mask-image-radial-from-pos":[{"mask-radial-from":K()}],"mask-image-radial-to-pos":[{"mask-radial-to":K()}],"mask-image-radial-from-color":[{"mask-radial-from":d()}],"mask-image-radial-to-color":[{"mask-radial-to":d()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":V()}],"mask-image-conic-pos":[{"mask-conic":[q]}],"mask-image-conic-from-pos":[{"mask-conic-from":K()}],"mask-image-conic-to-pos":[{"mask-conic-to":K()}],"mask-image-conic-from-color":[{"mask-conic-from":d()}],"mask-image-conic-to-color":[{"mask-conic-to":d()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:A()}],"mask-repeat":[{mask:i()}],"mask-size":[{mask:g()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",S,_]}],filter:[{filter:["","none",S,_]}],blur:[{blur:fe()}],brightness:[{brightness:[q,S,_]}],contrast:[{contrast:[q,S,_]}],"drop-shadow":[{"drop-shadow":["","none",X,Oe,Ve]}],"drop-shadow-color":[{"drop-shadow":d()}],grayscale:[{grayscale:["",q,S,_]}],"hue-rotate":[{"hue-rotate":[q,S,_]}],invert:[{invert:["",q,S,_]}],saturate:[{saturate:[q,S,_]}],sepia:[{sepia:["",q,S,_]}],"backdrop-filter":[{"backdrop-filter":["","none",S,_]}],"backdrop-blur":[{"backdrop-blur":fe()}],"backdrop-brightness":[{"backdrop-brightness":[q,S,_]}],"backdrop-contrast":[{"backdrop-contrast":[q,S,_]}],"backdrop-grayscale":[{"backdrop-grayscale":["",q,S,_]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[q,S,_]}],"backdrop-invert":[{"backdrop-invert":["",q,S,_]}],"backdrop-opacity":[{"backdrop-opacity":[q,S,_]}],"backdrop-saturate":[{"backdrop-saturate":[q,S,_]}],"backdrop-sepia":[{"backdrop-sepia":["",q,S,_]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":j()}],"border-spacing-x":[{"border-spacing-x":j()}],"border-spacing-y":[{"border-spacing-y":j()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",S,_]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[q,"initial",S,_]}],ease:[{ease:["linear","initial",M,S,_]}],delay:[{delay:[q,S,_]}],animate:[{animate:["none",D,S,_]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[f,S,_]}],"perspective-origin":[{"perspective-origin":B()}],rotate:[{rotate:ce()}],"rotate-x":[{"rotate-x":ce()}],"rotate-y":[{"rotate-y":ce()}],"rotate-z":[{"rotate-z":ce()}],scale:[{scale:be()}],"scale-x":[{"scale-x":be()}],"scale-y":[{"scale-y":be()}],"scale-z":[{"scale-z":be()}],"scale-3d":["scale-3d"],skew:[{skew:ye()}],"skew-x":[{"skew-x":ye()}],"skew-y":[{"skew-y":ye()}],transform:[{transform:[S,_,"","none","gpu","cpu"]}],"transform-origin":[{origin:B()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:je()}],"translate-x":[{"translate-x":je()}],"translate-y":[{"translate-y":je()}],"translate-z":[{"translate-z":je()}],"translate-none":["translate-none"],accent:[{accent:d()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:d()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",S,_]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":j()}],"scroll-mx":[{"scroll-mx":j()}],"scroll-my":[{"scroll-my":j()}],"scroll-ms":[{"scroll-ms":j()}],"scroll-me":[{"scroll-me":j()}],"scroll-mt":[{"scroll-mt":j()}],"scroll-mr":[{"scroll-mr":j()}],"scroll-mb":[{"scroll-mb":j()}],"scroll-ml":[{"scroll-ml":j()}],"scroll-p":[{"scroll-p":j()}],"scroll-px":[{"scroll-px":j()}],"scroll-py":[{"scroll-py":j()}],"scroll-ps":[{"scroll-ps":j()}],"scroll-pe":[{"scroll-pe":j()}],"scroll-pt":[{"scroll-pt":j()}],"scroll-pr":[{"scroll-pr":j()}],"scroll-pb":[{"scroll-pb":j()}],"scroll-pl":[{"scroll-pl":j()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",S,_]}],fill:[{fill:["none",...d()]}],"stroke-w":[{stroke:[q,De,$e,Qe]}],stroke:[{stroke:["none",...d()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},vt=st(jt);function Fe(...s){return vt(Os(s))}const wt={sm:"max-w-md",md:"max-w-2xl",lg:"max-w-4xl",xl:"max-w-6xl"},es=({isOpen:s,onClose:r,title:n,subtitle:t,children:u,footer:a,size:y="md",closeOnOverlayClick:m=!0})=>{if(b.useEffect(()=>(s?document.body.classList.add("modal-open"):document.body.classList.remove("modal-open"),()=>{document.body.classList.remove("modal-open")}),[s]),b.useEffect(()=>{const C=z=>{z.key==="Escape"&&s&&r()};return document.addEventListener("keydown",C),()=>document.removeEventListener("keydown",C)},[s,r]),!s)return null;const x=C=>{C.target===C.currentTarget&&m&&r()};return e.jsx("div",{className:"modal-overlay",onClick:x,role:"dialog","aria-modal":"true","aria-labelledby":"modal-title",children:e.jsxs("div",{className:`modal-container ${wt[y]}`,children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{id:"modal-title",className:"text-xl font-semibold text-gray-900 font-manrope",children:n}),t&&e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:t})]}),e.jsx("button",{onClick:r,className:"p-1.5 rounded-lg bg-gray-100 hover:bg-gray-200 transition-colors","aria-label":"Close modal",children:e.jsx(Ae,{size:20,className:"text-gray-600"})})]}),e.jsx("div",{className:"modal-body",children:u}),a&&e.jsx("div",{className:"modal-footer",children:a})]})})};function Nt({shiftId:s,onClose:r,onSuccess:n}){var O,h;const[t,u]=b.useState(null),[a,y]=b.useState([]),[m,x]=b.useState([]),[C,z]=b.useState(""),[J,ee]=b.useState(null),[X,Z]=b.useState({}),[f,Q]=b.useState(!0),[M,D]=b.useState(!1),[k,V]=b.useState(null),B=(c,p)=>{Z(T=>({...T,[c]:p}))};b.useEffect(()=>{H()},[s]),b.useEffect(()=>{t&&E()},[t]),b.useEffect(()=>{if(!C)x(a);else{const c=C.toLowerCase();x(a.filter(p=>{var T;return p.first_name.toLowerCase().includes(c)||p.last_name.toLowerCase().includes(c)||p.email.toLowerCase().includes(c)||((T=p.skills_json)==null?void 0:T.some(v=>v.toLowerCase().includes(c)))}))}},[C,a]);async function H(){try{const c=await re.get(`/shifts/${s}`);c.data.status==="success"?u(c.data.data):V("Failed to load shift details")}catch(c){console.error("Failed to load shift details:",c),V("Failed to load shift details")}}async function E(){var c;try{const p=new Set;if(t!=null&&t.event_id)try{const w=((c=(await re.get(`/events/${t.event_id}`)).data)==null?void 0:c.data)||{};if(w.shifts_by_role){const P=w.shifts_by_role.find(d=>d.skill_name===t.role_needed||d.role_name===t.role_needed);P!=null&&P.shifts&&P.shifts.forEach(d=>{d.assignments&&d.assignments.forEach(A=>{var F;const i=A.worker_id||((F=A.worker)==null?void 0:F.id),g=A.status;i&&g!=="cancelled"&&g!=="no_show"&&p.add(i)})})}}catch(v){console.log("Could not fetch event to filter assigned workers:",v)}console.log(`AssignmentModal: Found ${p.size} already assigned workers for "${t==null?void 0:t.role_needed}"`);const T=await re.get("/workers?active=true");if(T.data.status==="success"){const v=T.data.data.workers||T.data.data;if(t!=null&&t.role_needed){const w=v.filter(P=>{var d;return((d=P.skills_json)==null?void 0:d.includes(t.role_needed))&&!p.has(P.id)});console.log(`AssignmentModal: Showing ${w.length} eligible workers`),y(w)}else{const w=v.filter(P=>!p.has(P.id));y(w)}}else V("Failed to load workers")}catch(p){console.error("Failed to load workers:",p),V("Failed to load workers")}finally{Q(!1)}}async function j(){var c,p,T,v,w,P;if(!(!J||!t)){D(!0),V(null);try{const A=(await re.post("/staffing",{assignment:{shift_id:t.id,worker_id:J.id,status:"assigned",assigned_at_utc:new Date().toISOString(),hourly_rate:X[J.id]||Number(t.pay_rate)||0}})).data;if(A.status==="success")n();else{let i=A.message||"Failed to assign worker";A.details&&A.details.length>0?i+=`

Details:
â€¢ `+A.details.join(`
â€¢ `):A.errors&&(i+=`

Details:
â€¢ `+A.errors.join(`
â€¢ `)),V(i)}}catch(d){console.error("Failed to assign worker:",d);let A="Failed to assign worker";if((p=(c=d.response)==null?void 0:c.data)!=null&&p.details&&d.response.data.details.length>0){const i=d.response.data.details.map(g=>(g.includes("conflicting shift"),g));A+=`

`+i.join(`
`)}else(v=(T=d.response)==null?void 0:T.data)!=null&&v.errors?A+=`

`+d.response.data.errors.join(`
`):(P=(w=d.response)==null?void 0:w.data)!=null&&P.message?A=d.response.data.message:d.message&&(A=d.message);V(A)}finally{D(!1)}}}if(f)return e.jsx(es,{isOpen:!0,onClose:r,title:"Assign Worker",size:"lg",children:e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-teal-600"})})});const R=e.jsxs(e.Fragment,{children:[k&&e.jsxs("div",{className:"mb-4 p-3 bg-gradient-to-r from-red-50 to-amber-50 border-l-4 border-red-500 rounded-r-lg shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-6 h-6 bg-red-500 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-white text-xs font-bold",children:"!"})}),e.jsx("h4",{className:"text-sm font-semibold text-red-900",children:"âš ï¸ Scheduling Conflict Detected"})]}),e.jsx("p",{className:"text-xs text-gray-600 ml-8",children:"Please resolve the conflict before attempting to assign this worker"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:r,disabled:M,className:"btn-secondary",children:"Cancel"}),e.jsx("button",{onClick:j,disabled:!J||M||!!k,className:`btn-primary ${k?"opacity-50 cursor-not-allowed":""}`,title:k?"Cannot assign due to scheduling conflict":"",children:M?"Assigning Worker...":"Assign Worker"})]})]});return e.jsx(es,{isOpen:!0,onClose:r,title:t?`${t.client_name} â€¢ ${t.role_needed}`:"Assign Worker",size:"xl",footer:R,children:e.jsxs("div",{className:"flex h-[600px]",children:[e.jsx("div",{className:"w-1/3 border-r border-gray-200 p-6 bg-gray-50",children:t?e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Shift Details"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(_e,{size:16,className:"text-gray-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:$s(t.start_time_utc)}),e.jsxs("div",{className:"text-sm text-gray-600",children:[as(t.start_time_utc)," - ",as(t.end_time_utc)]})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Ue,{size:16,className:"text-gray-400 mt-0.5 flex-shrink-0"}),e.jsx("div",{className:"text-sm text-gray-900",children:t.location||((h=(O=t.event)==null?void 0:O.venue)==null?void 0:h.formatted_address)||"Location not specified"})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Je,{size:16,className:"text-gray-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-900",children:t.role_needed}),t.required_skill&&e.jsxs("div",{className:"text-sm text-gray-600",children:["Requires: ",t.required_skill]})]})]}),e.jsxs("div",{className:"pt-2 border-t border-gray-200",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Pay Rate:"})," $",(Number(t.pay_rate)||0).toFixed(2),"/hour"]}),t.uniform_name&&e.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[e.jsx("span",{className:"font-medium",children:"Uniform:"})," ",t.uniform_name]})]}),t.notes&&e.jsx("div",{className:"pt-2 border-t border-gray-200",children:e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Notes:"}),e.jsx("div",{className:"mt-1 whitespace-pre-line",children:t.notes.split("Uniform:").map((c,p)=>p===0?c.trim():e.jsxs("div",{children:[e.jsx("br",{}),e.jsx("span",{className:"font-medium",children:"Uniform:"})," ",c.trim()]},p))})]})})]})]})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(we,{size:32,className:"text-gray-400 mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Failed to load shift details"})]})}),e.jsxs("div",{className:"flex-1 flex flex-col",children:[e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsxs("div",{className:"relative",children:[e.jsx(ss,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:16}),e.jsx("input",{type:"text",placeholder:"Search workers...",value:C,onChange:c=>z(c.target.value),className:"w-full pl-9 pr-4 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-1 focus:ring-teal-500 focus:border-teal-500"})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:k?e.jsx("div",{className:"p-6 flex items-center justify-center h-full",children:e.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 rounded-lg p-5 shadow-sm w-full max-w-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx(we,{size:20,className:"text-red-600"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-lg font-semibold text-red-900 mb-1",children:"âš ï¸ Scheduling Conflict"}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"This worker cannot be assigned due to a scheduling conflict"}),e.jsx("div",{className:"bg-white border border-red-200 rounded p-3 mt-3",children:e.jsx("div",{className:"text-sm text-red-800 font-mono",children:k.split(`
`).map((c,p)=>c.trim()===""?null:c.startsWith("â€¢")?e.jsxs("div",{className:"mt-1 flex items-start gap-2",children:[e.jsx("span",{className:"text-red-500",children:"â—"}),e.jsx("span",{className:"flex-1",children:c.replace("â€¢","").trim()})]},p):c.startsWith("Details:")?null:c.includes("conflicting shift")?e.jsx("div",{className:"mt-1 text-red-700 font-medium",children:c},p):e.jsx("div",{className:"text-gray-700",children:c},p))})})]})]})})}):m.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Je,{size:32,className:"text-gray-400 mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-gray-600",children:C?"No workers found matching your search":t!=null&&t.role_needed?`No workers found with "${t.role_needed}" skill`:"No available workers"}),(t==null?void 0:t.role_needed)&&!C&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:['Try adding "',t.role_needed,'" skill to workers or select a different shift.']})]}):e.jsx("ul",{children:m.map(c=>{const p=(J==null?void 0:J.id)===c.id,T=X[c.id]||Number(t.pay_rate)||0,v=X[c.id]&&X[c.id]!==(Number(t.pay_rate)||0);return e.jsxs("li",{className:`flex items-center justify-between px-4 py-3 border-b last:border-b-0 ${p?"bg-teal-50":"bg-white"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"w-8 h-8 rounded-full bg-teal-100 flex items-center justify-center text-teal-700 text-xs font-semibold",children:[c.first_name[0],c.last_name[0]]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[c.first_name," ",c.last_name]}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:(c.skills_json||[]).map((w,P)=>{const d=w===(t==null?void 0:t.role_needed);return e.jsx("span",{className:`px-2 py-0.5 text-xs rounded ${d?"bg-teal-100 text-teal-700 font-medium":"bg-gray-100 text-gray-600"}`,children:w},P)})})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[v&&e.jsx("span",{className:"text-xs text-amber-600 font-medium",children:"Custom"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ms,{className:"h-4 w-4 text-gray-400"}),e.jsx("input",{type:"number",step:"1",min:"0",placeholder:(Number(t.pay_rate)||0).toString(),value:T||"",onChange:w=>{const P=w.target.value;(P===""||/^\d*\.?\d*$/.test(P))&&B(c.id,parseFloat(P)||0)},className:"w-20 px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent",onMouseDown:w=>w.stopPropagation(),onFocus:w=>w.stopPropagation()}),e.jsx("span",{className:"text-xs text-gray-600",children:"/hr"})]}),e.jsx("button",{onClick:()=>ee(c),className:`px-3 py-1.5 rounded-lg text-sm font-medium border ${p?"bg-teal-600 text-white border-teal-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:p?"Selected":"Select"})]})]},c.id)})})})]})]})})}function kt({isOpen:s,eventId:r,roleName:n,unfilledShiftIds:t,defaultPayRate:u,onClose:a,onDone:y}){const[m,x]=b.useState([]),[C,z]=b.useState([]),[J,ee]=b.useState(""),[X,Z]=b.useState(!1),[f,Q]=b.useState(!1),[M,D]=b.useState({}),[k,V]=b.useState(0),B=(h,c)=>{D(p=>({...p,[h]:c}))};b.useEffect(()=>{s&&(x([]),z([]),ee(""),D({}),Z(!0),(async()=>{var h,c;try{const T=((h=(await re.get(`/events/${r}`)).data)==null?void 0:h.data)||{};console.log("QuickFill: Full event data:",JSON.stringify(T,null,2)),console.log("QuickFill: Looking for role:",n),console.log("QuickFill: shifts_by_role:",T.shifts_by_role);const v=new Set;if(T.shifts_by_role){const A=T.shifts_by_role.find(i=>(console.log("QuickFill: Checking role:",i.skill_name,i.role_name,"vs",n),i.skill_name===n||i.role_name===n));A?(console.log("QuickFill: Found role shifts:",A),A.shifts&&A.shifts.forEach(i=>{i.assignments&&(console.log("QuickFill: Shift has assignments:",i.assignments),i.assignments.forEach(g=>{var L;const F=g.worker_id||((L=g.worker)==null?void 0:L.id),N=g.status;F&&N!=="cancelled"&&(v.add(F),console.log("QuickFill: Adding worker_id to exclude:",F,"status:",N))}))})):console.log("QuickFill: No role shifts found for:",n)}console.log(`QuickFill: Found ${v.size} already assigned worker IDs:`,Array.from(v));const w=await re.get("/workers?active=true"),d=(((c=w.data)==null?void 0:c.data)||w.data||[]).filter(A=>{const i=(A.skills_json||[]).includes(n),g=v.has(A.id);return g&&console.log(`QuickFill: Excluding ${A.first_name} ${A.last_name} (ID: ${A.id}) - already assigned`),i&&!g});if(console.log(`QuickFill: Found ${d.length} eligible workers for "${n}"`),console.log("QuickFill: Eligible workers:",d.map(A=>`${A.first_name} ${A.last_name}`)),x(d),u){const A=Number(u)||0;V(A),console.log(`QuickFill: Default pay rate for ${n}: $${A}/hr`)}else console.log(`QuickFill: No default pay rate provided for ${n}`)}catch(p){console.error("Error loading workers:",p)}finally{Z(!1)}})())},[s,r,n,u]);const H=b.useMemo(()=>{const h=J.trim().toLowerCase(),c=m;return h?c.filter(p=>`${p.first_name} ${p.last_name}`.toLowerCase().includes(h)||(p.email||"").toLowerCase().includes(h)):c},[m,J]),E=t.length,j=h=>{z(c=>c.includes(h)?c.filter(p=>p!==h):c.length>=E?c:[...c,h])},R=async()=>{var T,v,w,P,d,A,i,g,F,N,L,U,se,K,fe;if(C.length===0||E===0)return;Q(!0);let h=0,c=0;const p=[];try{const ce=C.map(o=>m.find(G=>G.id===o)).filter(Boolean),be=[...t];let ye=0;for(;be.length>0&&ce.length>0;){const o=ce[ye%ce.length],G=be.shift();try{const W=M[o.id]||Number(k)||0||0,ae=await re.post("/staffing",{assignment:{shift_id:G,worker_id:o.id,status:"assigned",assigned_at_utc:new Date().toISOString(),hourly_rate:W}});if(((T=ae.data)==null?void 0:T.status)==="success")h+=1;else{c+=1;const te=`${o.first_name} ${o.last_name}`,pe=((v=ae.data)==null?void 0:v.message)||((P=(w=ae.data)==null?void 0:w.error)==null?void 0:P.message)||((A=(d=ae.data)==null?void 0:d.errors)==null?void 0:A.join(", "))||"Unknown error";let ne="Unable to assign";const l=String(pe).toLowerCase();l.includes("overlapping")||l.includes("conflict")?ne="Has overlapping shift":l.includes("capacity")||l.includes("full")?ne="Shift is full":l.includes("skill")||l.includes("certification")||l.includes("requirement")?ne="Missing required skill":l.includes("status")?ne="Cannot be assigned":ne="Unable to assign",p.push(`${te}: ${ne}`)}}catch(W){c+=1;const ae=`${o.first_name} ${o.last_name}`;let te="Unable to assign";const pe=((g=(i=W.response)==null?void 0:i.data)==null?void 0:g.message)||((L=(N=(F=W.response)==null?void 0:F.data)==null?void 0:N.error)==null?void 0:L.message)||((K=(se=(U=W.response)==null?void 0:U.data)==null?void 0:se.errors)==null?void 0:K.join(", "))||null;if(pe){const ne=String(pe).toLowerCase();ne.includes("overlapping")||ne.includes("conflict")?te="Has overlapping shift":ne.includes("capacity")||ne.includes("full")?te="Shift is full":ne.includes("skill")||ne.includes("certification")||ne.includes("requirement")?te="Missing required skill":ne.includes("status")?te="Cannot be assigned":te="Unable to assign"}else((fe=W.response)==null?void 0:fe.status)===422?te="Unable to assign":W.message&&!W.message.includes("status code")&&(te=W.message);p.push(`${ae}: ${te}`)}ye+=1}let je="";c>0&&p.length>0&&(je=p.join(", ")),y({assigned:h,conflicts:c,details:je})}finally{Q(!1)}};if(!s)return null;const O=e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:a,disabled:f,className:"btn-secondary",children:"Cancel"}),e.jsx("button",{onClick:R,disabled:f||C.length===0||E===0,className:"btn-primary",children:f?"Filling Shifts...":C.length===1?`Assign worker to ${E} shift${E!==1?"s":""}`:`Assign ${C.length} workers to ${E} shifts`})]});return e.jsxs(es,{isOpen:s,onClose:a,title:`Quick Fill â€” ${n}`,subtitle:`Unfilled shifts: ${E}`,size:"lg",footer:O,children:[e.jsxs("div",{className:"relative",children:[e.jsx(ss,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx("input",{value:J,onChange:h=>ee(h.target.value),placeholder:"Search eligible workersâ€¦",className:"w-full pl-9 pr-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500"})]}),e.jsx("div",{className:"max-h-[340px] overflow-y-auto border border-gray-200 rounded-lg",children:X?e.jsx("div",{className:"p-6 text-center text-gray-500",children:"Loadingâ€¦"}):H.length===0?e.jsx("div",{className:"p-6 text-center text-gray-500",children:"No eligible workers"}):e.jsx("ul",{children:H.map(h=>{const c=C.includes(h.id);return e.jsxs("li",{className:`flex items-center justify-between px-4 py-3 border-b last:border-b-0 ${c?"bg-teal-50":"bg-white"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"w-8 h-8 rounded-full bg-teal-100 flex items-center justify-center text-teal-700 text-xs font-semibold",children:[h.first_name[0],h.last_name[0]]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[h.first_name," ",h.last_name]}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:(h.skills_json||[]).map((p,T)=>{const v=p===n;return e.jsx("span",{className:`px-2 py-0.5 text-xs rounded ${v?"bg-teal-100 text-teal-700 font-medium":"bg-gray-100 text-gray-600"}`,children:p},T)})})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[M[h.id]&&M[h.id]!==(Number(k)||0)&&e.jsx("span",{className:"text-xs text-amber-600 font-medium",children:"Custom"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ms,{className:"h-4 w-4 text-gray-400"}),e.jsx("input",{type:"number",step:"1",min:"0",placeholder:Number(k)?(Number(k)||0).toString():"Rate",value:M[h.id]||Number(k)||0||"",onChange:p=>{const T=p.target.value;(T===""||/^\d*\.?\d*$/.test(T))&&B(h.id,parseFloat(T)||0)},className:"w-20 px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent",onMouseDown:p=>p.stopPropagation(),onFocus:p=>p.stopPropagation()}),e.jsx("span",{className:"text-xs text-gray-600",children:"/hr"})]}),e.jsx("button",{onClick:()=>j(h.id),disabled:!c&&C.length>=E,className:`px-3 py-1.5 rounded-lg text-sm font-medium border ${c?"bg-teal-600 text-white border-teal-600":C.length>=E?"bg-gray-100 text-gray-400 border-gray-200 cursor-not-allowed":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:c?"Selected":"Select"})]})]},h.id)})})}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[e.jsx(Fs,{size:16,className:"text-teal-600"}),e.jsxs("span",{children:["Will assign ",e.jsx("strong",{children:C.length})," worker",C.length!==1?"s":""," to ",e.jsx("strong",{children:E})," shift",E!==1?"s":"","."]})]}),(Number(k)||0)>0&&e.jsxs("div",{className:"border-t pt-4 mt-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-gray-600",children:["Default rate for ",n,":"]}),e.jsxs("span",{className:"font-medium",children:["$",(Number(k)||0).toFixed(2),"/hr"]})]}),Object.keys(M).length>0&&e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["ðŸ’¡ Empty fields will use default rate ($",(Number(k)||0).toFixed(2),"/hr)"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[e.jsx(Cs,{size:14,className:"text-yellow-600"}),"Conflicts and already-filled shifts will be skipped automatically."]})]})}function _t({event:s,isOpen:r,onClose:n,onSuccess:t}){var d,A;const u=ds(),[a,y]=b.useState(!1),[m,x]=b.useState([]),[C,z]=b.useState(!1),[J,ee]=b.useState(!1),[X,Z]=b.useState(null),[f,Q]=b.useState(null),[M,D]=b.useState({isVisible:!1,message:"",type:"error"}),[k,V]=b.useState(null),[B,H]=b.useState(!1);b.useEffect(()=>{r&&s.id&&E()},[r,s.id]);const E=async()=>{ee(!0);try{const i=await re.get(`/events/${s.id}`);i.data.status==="success"&&Z(i.data.data)}catch(i){console.error("Failed to load full event details:",i),Z(s)}finally{ee(!1)}},j=()=>{n(),u(`/events/${s.id}/edit`)},R=[{name:"Bartender",icon:zs},{name:"Banquet Server/Runner",icon:Es},{name:"Captain",icon:Ls},{name:"Event Helper",icon:Ps},{name:"Prep Cook",icon:Ts}],O=X||s,h=X||s;b.useEffect(()=>{if(O){if(O.skill_requirements&&Array.isArray(O.skill_requirements)){const i=O.skill_requirements.map(g=>{var L,U;const F=(L=O.shifts_by_role)==null?void 0:L.find(se=>(se.skill_name||se.role_name)===g.skill_name),N=((U=F==null?void 0:F.shifts)==null?void 0:U.length)||(F==null?void 0:F.total_shifts)||g.needed_workers||1;return{skill_name:g.skill_name,needed_workers:N,pay_rate:g.pay_rate||15,description:g.description||"",uniform_id:void 0,cert_id:void 0}});x(i)}else if(O.shifts_by_role&&Array.isArray(O.shifts_by_role)){const i=O.shifts_by_role.map(g=>{const F=g.shifts?g.shifts.length:g.total_shifts||1;return{skill_name:g.skill_name||g.role_name||"",needed_workers:F,pay_rate:g.pay_rate||15,description:"",uniform_id:void 0,cert_id:void 0}});x(i)}}},[O]),b.useEffect(()=>{const i=X||s;i!=null&&i.schedule&&V({start_time_utc:i.schedule.start_time_utc,end_time_utc:i.schedule.end_time_utc,break_minutes:i.schedule.break_minutes||0})},[X,s]);const c=(i,g,F)=>{if(i<0||i>=m.length)return;const N=[...m];N[i]={...N[i],[g]:F},x(N)},p=()=>{x([...m,{skill_name:"",needed_workers:1,pay_rate:15,description:"",uniform_id:void 0,cert_id:void 0}])},T=i=>{var F;if(i<0||i>=m.length)return;const g=m[i];if((g==null?void 0:g.needed_workers)>0){const N=(F=h==null?void 0:h.shifts_by_role)==null?void 0:F[i];if(((N==null?void 0:N.assigned_workers)||(N==null?void 0:N.filled_shifts)||0)>0){D({isVisible:!0,message:"Cannot remove role with assigned workers. Please unassign workers first.",type:"error"});return}}x(m.filter((N,L)=>L!==i))},v=(i,g)=>{if(i<0||i>=m.length)return;R.find(N=>N.name===g);const F=[...m];F[i]={...F[i],skill_name:g},x(F),Q(null)},w=async()=>{var g,F,N;const i=X||s;if(i.schedule&&new Date(i.schedule.start_time_utc)<=new Date){D({isVisible:!0,message:"Cannot edit event that has already started",type:"error"});return}z(!0);try{const L=X||s,U=await re.patch(`/events/${L.id}`,{event:{roles:m.map(se=>({skill_name:se.skill_name,needed:se.needed_workers,pay_rate:se.pay_rate,description:se.description,uniform_id:se.uniform_id,cert_id:se.cert_id})),schedule:k?{start_time_utc:k.start_time_utc,end_time_utc:k.end_time_utc,break_minutes:k.break_minutes}:L.schedule?{start_time_utc:L.schedule.start_time_utc,end_time_utc:L.schedule.end_time_utc,break_minutes:L.schedule.break_minutes||0}:void 0}});U.data.status==="success"?(D({isVisible:!0,message:U.data.message||"Event updated successfully",type:"success"}),t(),n()):D({isVisible:!0,message:U.data.message||"Failed to update event",type:"error"})}catch(L){console.error("Failed to update event:",L);const U=(g=L==null?void 0:L.response)==null?void 0:g.data;if((U==null?void 0:U.status)==="validation_error"&&((N=(F=U==null?void 0:U.data)==null?void 0:F.conflicts)!=null&&N.length)){const se=U.data.conflicts.map(K=>{const fe=new Date(K.conflicting_shift_start_time_utc).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"}),ce=new Date(K.conflicting_shift_end_time_utc).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"});return`${K.worker_name} conflicts with ${K.conflicting_event_title} (${fe} â€“ ${ce})`});D({isVisible:!0,message:`Can't save changes: ${se.length} worker${se.length!==1?"s":""} would be double-booked
â€¢ `+se.join(`
â€¢ `),type:"error"})}else D({isVisible:!0,message:(U==null?void 0:U.message)||"Failed to update event",type:"error"})}finally{z(!1)}},P=e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:n,disabled:C,className:"btn-secondary",children:"Cancel"}),e.jsx("button",{onClick:w,disabled:C,className:"btn-primary",children:C?"Saving...":"Save Changes"})]});return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-0 sm:p-4 overflow-y-auto",children:e.jsxs("div",{className:"bg-white w-full h-full sm:h-auto sm:max-w-4xl sm:rounded-lg shadow-xl overflow-hidden flex flex-col sm:max-h-[90vh]",children:[e.jsxs("div",{className:"sticky top-0 bg-white px-4 sm:px-6 py-4 border-b border-gray-200 flex items-center justify-between z-10",children:[e.jsxs("h2",{className:"text-lg sm:text-xl md:text-2xl font-bold text-gray-900 truncate",children:["Edit Event: ",h.title]}),e.jsx("button",{onClick:n,className:"p-2 text-gray-400 hover:text-gray-600 min-h-touch min-w-touch","aria-label":"Close",children:e.jsx(Ae,{className:"h-5 w-5 sm:h-6 sm:w-6"})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto px-4 sm:px-6 py-4 space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 p-6 rounded-xl border border-gray-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-5",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"Event Details"}),e.jsxs("button",{onClick:j,className:"inline-flex items-center gap-1.5 px-3 py-1.5 bg-white border border-gray-300 text-sm font-medium text-gray-700 rounded-lg hover:bg-gray-50 hover:border-gray-400 transition-all shadow-sm",children:[e.jsx(us,{size:14}),"Edit"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:"Venue"}),e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:(d=h.venue)==null?void 0:d.name})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:"Date"}),e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:h.schedule&&new Date(h.schedule.start_time_utc).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric"})})]}),e.jsxs("div",{className:"space-y-1 md:col-span-2",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:"Location"}),e.jsx("p",{className:"text-sm font-semibold text-gray-900 leading-relaxed",children:(A=h.venue)==null?void 0:A.formatted_address})]}),e.jsxs("div",{className:"space-y-1 md:col-start-2",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:"Time"}),e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:h.schedule&&e.jsxs(e.Fragment,{children:[new Date(h.schedule.start_time_utc).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})," - ",new Date(h.schedule.end_time_utc).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})]})})]}),e.jsx("div",{})]})]}),e.jsxs("div",{className:"col-span-2 bg-gray-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 uppercase tracking-wide",children:"Event Schedule"}),e.jsx("button",{type:"button",onClick:()=>H(!B),className:"text-sm text-blue-600 hover:text-blue-800 font-medium",children:B?"Cancel":"Edit Schedule"})]}),B?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Start Time"}),e.jsx("input",{type:"datetime-local",value:k!=null&&k.start_time_utc?new Date(k.start_time_utc).toISOString().slice(0,16):"",onChange:i=>V(g=>g?{...g,start_time_utc:new Date(i.target.value).toISOString()}:null),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"End Time"}),e.jsx("input",{type:"datetime-local",value:k!=null&&k.end_time_utc?new Date(k.end_time_utc).toISOString().slice(0,16):"",onChange:i=>V(g=>g?{...g,end_time_utc:new Date(i.target.value).toISOString()}:null),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Break Minutes"}),e.jsx("input",{type:"number",min:"0",value:(k==null?void 0:k.break_minutes)||0,onChange:i=>V(g=>g?{...g,break_minutes:parseInt(i.target.value)||0}:null),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm"})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-3",children:e.jsx("p",{className:"text-xs text-blue-800",children:"âš ï¸ Changing schedule times will update ALL shifts and worker schedules for this event."})})]}):e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Date"}),e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:h.schedule&&new Date(h.schedule.start_time_utc).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric"})})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Time"}),e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:k&&e.jsxs(e.Fragment,{children:[new Date(k.start_time_utc).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})," -",new Date(k.end_time_utc).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})]})})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Break"}),e.jsxs("p",{className:"text-sm font-semibold text-gray-900",children:[(k==null?void 0:k.break_minutes)||0," minutes"]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-base font-semibold text-gray-900",children:"Roles"}),e.jsxs("button",{onClick:p,className:"inline-flex items-center gap-2 px-4 py-2 bg-teal-600 text-white text-sm font-semibold rounded-lg hover:bg-teal-700 transition-colors shadow-sm",children:[e.jsx(We,{size:16}),"Add Role"]})]}),m.map((i,g)=>{var F;return e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start gap-4 mb-3",children:[e.jsxs("div",{className:"flex-1 relative overflow-visible",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Role Name *"}),e.jsxs("div",{className:"relative",style:{zIndex:f===g?1e3:1},children:[e.jsxs("button",{type:"button",onClick:()=>Q(f===g?null:g),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500 bg-white text-left flex items-center justify-between",children:[i.skill_name?e.jsxs("div",{className:"flex items-center gap-2",children:[((F=R.find(N=>N.name===i.skill_name))==null?void 0:F.icon)&&e.jsx("img",{src:R.find(N=>N.name===i.skill_name).icon,alt:i.skill_name,className:"w-5 h-5"}),e.jsx("span",{className:"text-gray-900",children:i.skill_name})]}):e.jsx("span",{className:"text-gray-400",children:"Pick the Skills the Worker Has"}),e.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{d:"M19 9l-7 7-7-7"})})]}),f===g&&e.jsx("div",{className:"absolute top-full left-0 right-0 mt-2 bg-white border-2 border-gray-200 rounded-xl shadow-2xl z-[9999] max-h-[300px] overflow-y-auto w-full min-w-max",children:R.filter(N=>!m.some((L,U)=>U!==g&&L.skill_name===N.name)).map(N=>e.jsxs("div",{onClick:()=>v(g,N.name),className:"flex items-center gap-3 px-4 py-3 cursor-pointer hover:bg-teal-50 border-b border-gray-100 last:border-0",children:[e.jsx("img",{src:N.icon,width:"24",height:"24",alt:N.name,className:"flex-shrink-0"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:N.name})]},N.name))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Needed Workers *"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>c(g,"needed_workers",Math.max(1,i.needed_workers-1)),className:"w-8 h-8 flex items-center justify-center border border-gray-300 bg-white hover:bg-gray-50 rounded-lg transition-colors font-semibold text-gray-700",children:"-"}),e.jsx("input",{type:"number",value:i.needed_workers,onChange:N=>c(g,"needed_workers",parseInt(N.target.value)||1),min:"1",className:"w-16 px-2 py-2 border border-gray-300 rounded-lg text-center focus:outline-none focus:ring-2 focus:ring-teal-500 font-medium"}),e.jsx("button",{onClick:()=>c(g,"needed_workers",i.needed_workers+1),className:"w-8 h-8 flex items-center justify-center border border-gray-300 bg-white hover:bg-gray-50 rounded-lg transition-colors font-semibold text-gray-700",children:"+"}),e.jsx("button",{onClick:()=>T(g),className:"ml-2 w-8 h-8 flex items-center justify-center text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Remove role",children:e.jsx(Re,{size:18})})]})]})]}),(()=>{var U;const N=(U=h==null?void 0:h.shifts_by_role)==null?void 0:U[g],L=(N==null?void 0:N.assigned_workers)||(N==null?void 0:N.filled_shifts)||0;return L>0?e.jsxs("div",{className:"text-sm text-amber-600 font-semibold bg-amber-50 px-3 py-2 rounded-lg",children:[L," worker(s) assigned"]}):null})()]},g)})]})]}),e.jsx("div",{className:"sticky bottom-0 bg-white px-4 sm:px-6 py-4 border-t border-gray-200 flex flex-col sm:flex-row gap-3 sm:justify-end z-10",children:P})]})}),e.jsx(ts,{isVisible:M.isVisible,message:M.message,type:M.type,onClose:()=>D({...M,isVisible:!1})})]})}function St({assignment:s,isEditing:r,editHours:n,isSavingEdit:t,wasApprovedBeforeEdit:u,isSelected:a,canSelect:y,onToggleSelect:m,onStartEdit:x,onSaveEdit:C,onCancelEdit:z,onEditHoursChange:J,onEditKeyDown:ee,calculateLiveTotal:X,onNoShow:Z,onRemove:f,onReEdit:Q}){const[M,D]=b.useState(!1),k=v=>{if(!v)return"N/A";try{const w=ge(v);return Ne(w,"MMM d, yyyy h:mm a")}catch{try{return new Date(v).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"})}catch{return"N/A"}}},V=v=>{const w=["bg-blue-500","bg-green-500","bg-purple-500","bg-pink-500","bg-orange-500","bg-teal-500","bg-indigo-500","bg-cyan-500"];if(!v)return w[0];const P=v.charCodeAt(0)||0;return w[P%w.length]},B=v=>{if(!v)return"??";const w=v.trim().split(" ");return w.length===1?w[0].substring(0,2).toUpperCase():(w[0][0]+w[w.length-1][0]).toUpperCase()},H=v=>{if(!v)return"";try{const w=ge(v);return Ne(w,"h:mm a")}catch{return new Date(v).toLocaleString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}},E=()=>{const v=s.actual_start||s.scheduled_start,w=s.actual_end||s.scheduled_end;return!v||!w?"Not set":`${H(v)} - ${H(w)}`},j=()=>{const v=s.actual_start||s.scheduled_start,w=s.actual_end||s.scheduled_end;if(!v||!w)return 0;try{const P=ge(v),i=(ge(w).getTime()-P.getTime())/(1e3*60*60);return Math.round(i*10)/10}catch{return 0}},R=v=>{const w=parseFloat(n)||0,P=Math.max(0,Math.min(24,w+v));J(P.toFixed(2))},O=s.approved,h=B(s.worker_name),c=V(s.worker_name),p=E(),T=j();return e.jsxs(e.Fragment,{children:[e.jsxs("tr",{className:Fe("hidden sm:table-row group transition-all duration-150 ease-in-out border-b",O&&!r&&"bg-green-50/30 hover:bg-green-50/50",!O&&!r&&s.status==="no_show"&&"bg-red-50/30",!O&&!r&&s.status==="cancelled"&&"bg-gray-50/30",!O&&!r&&"bg-white hover:bg-gray-50",r&&"bg-slate-50"),onMouseEnter:()=>D(!0),onMouseLeave:()=>D(!1),children:[e.jsx("td",{className:"py-4 px-3 w-12",children:y&&e.jsx("input",{type:"checkbox",checked:a,onChange:()=>m(s.id),className:"h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300 rounded cursor-pointer",onClick:v=>v.stopPropagation()})}),e.jsx("td",{className:"py-4 px-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:Fe("h-9 w-9 rounded-full flex items-center justify-center text-white font-semibold text-sm flex-shrink-0",c),children:h}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"font-medium text-gray-900 truncate",children:s.worker_name}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Scheduled: ",ie(s.scheduled_hours,2,"0.00"),"h"]}),O&&!r&&s.approved_by_name&&e.jsxs("div",{className:"mt-1 text-xs text-green-700 font-medium",children:["Approved by ",s.approved_by_name.split("@")[0]," on"," ",s.approved_at?k(s.approved_at):"N/A"]})]})]})}),e.jsx("td",{className:"py-4 px-3 text-sm text-gray-700",children:s.shift_role||"N/A"}),e.jsx("td",{className:"py-4 px-3",children:e.jsxs("div",{className:"flex items-center gap-1.5 text-sm text-gray-700",children:[e.jsx(_e,{className:"h-3.5 w-3.5 text-gray-400 flex-shrink-0"}),e.jsx("span",{className:"whitespace-nowrap",children:p})]})}),e.jsxs("td",{className:"py-4 px-3 text-sm font-medium text-gray-900 text-right",children:[ie(s.effective_hours,2,"0.00"),"h",s.edited_at&&e.jsx("span",{className:"ml-1 text-xs text-orange-600",title:"Edited",children:e.jsx(Me,{className:"h-3 w-3 inline"})})]}),e.jsxs("td",{className:"py-4 px-3 text-sm text-gray-700 text-right",children:["$",ie(s.effective_hourly_rate,2,"0.00"),"/h"]}),e.jsxs("td",{className:"py-4 px-3 text-sm font-semibold text-gray-900 text-right",children:["$",ie(s.effective_pay,2,"0.00")]}),e.jsx("td",{className:"py-4 text-right",children:r?e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium text-blue-700 bg-blue-100 rounded",children:[e.jsx(Me,{className:"h-3.5 w-3.5"}),"Editing"]}):e.jsx("div",{className:"flex items-center justify-end gap-2",children:s.status==="no_show"?e.jsx(e.Fragment,{children:e.jsxs("span",{className:"inline-flex items-center gap-1 text-xs font-medium text-red-700",children:[e.jsx(ns,{className:"h-3.5 w-3.5"}),"No-Show"]})}):s.status==="cancelled"?e.jsx(e.Fragment,{children:e.jsxs("span",{className:"inline-flex items-center gap-1 text-xs font-medium text-gray-700",children:[e.jsx(Ae,{className:"h-3.5 w-3.5"}),"Cancelled"]})}):e.jsxs("div",{className:"flex items-center justify-end gap-3",children:[O?e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium text-green-700 bg-green-100 rounded flex-shrink-0",children:[e.jsx(Se,{className:"h-3.5 w-3.5"}),"Approved"]}):e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium text-amber-700 bg-amber-100 rounded flex-shrink-0",children:[e.jsx(_e,{className:"h-3.5 w-3.5"}),"Pending"]}),s.can_edit_hours&&e.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>O?Q(s):x(s),className:"p-1.5 text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors",title:O?"Re-edit":"Edit",children:e.jsx(Me,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>Z(s),className:"p-1.5 text-gray-600 hover:text-orange-600 hover:bg-orange-50 rounded transition-colors",title:"No-Show",children:e.jsx(we,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>f(s),className:"p-1.5 text-gray-600 hover:text-red-600 hover:bg-red-50 rounded transition-colors",title:"Remove",children:e.jsx(Re,{className:"h-4 w-4"})})]})]})})})]}),r&&e.jsx("tr",{className:"bg-slate-50",children:e.jsx("td",{colSpan:8,className:"px-3 py-0",children:e.jsx("div",{className:"overflow-hidden transition-all duration-300 ease-in-out",children:e.jsx("div",{className:"py-3",children:e.jsxs("div",{className:"bg-white border border-slate-300 rounded-lg p-3 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(Me,{className:"h-4 w-4 text-slate-600"}),e.jsx("h4",{className:"text-sm font-semibold text-gray-900",children:"Edit Hours Worked"})]}),e.jsxs("div",{className:"mb-3 flex items-center gap-2 text-xs text-gray-600 bg-gray-50 px-3 py-1.5 rounded",children:[e.jsx(_e,{className:"h-3.5 w-3.5 text-gray-400"}),e.jsx("span",{children:p}),T>0&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-gray-400",children:"Â·"}),e.jsxs("span",{children:[T," hour shift"]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>R(-1),disabled:t,className:"p-1.5 border border-gray-300 rounded hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",type:"button",title:"Decrease by 1 hour",children:e.jsx(Is,{className:"h-4 w-4 text-gray-600"})}),e.jsx("input",{type:"number",step:"0.25",min:"0",max:"24",value:n,onChange:v=>J(v.target.value),onKeyDown:ee,disabled:t,className:"flex-1 px-3 py-1.5 border border-gray-300 rounded-lg text-center text-base font-semibold focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100",placeholder:"0.0",autoFocus:!0}),e.jsx("button",{onClick:()=>R(1),disabled:t,className:"p-1.5 border border-gray-300 rounded hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",type:"button",title:"Increase by 1 hour",children:e.jsx(We,{className:"h-4 w-4 text-gray-600"})})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Quick:"}),e.jsx("button",{onClick:()=>R(-1),disabled:t,className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-50 disabled:opacity-50 transition-colors",children:"-1h"}),e.jsx("button",{onClick:()=>R(-.5),disabled:t,className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-50 disabled:opacity-50 transition-colors",children:"-0.5h"}),e.jsx("button",{onClick:()=>R(.5),disabled:t,className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-50 disabled:opacity-50 transition-colors",children:"+0.5h"}),e.jsx("button",{onClick:()=>R(1),disabled:t,className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-50 disabled:opacity-50 transition-colors",children:"+1h"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Updated Total"}),e.jsxs("div",{className:"text-lg font-bold text-blue-600",children:["$",X(n,s.effective_hourly_rate||0)]})]}),u&&e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-amber-50 border-l-2 border-amber-400 rounded text-xs text-amber-800",children:[e.jsx(we,{className:"h-3.5 w-3.5 text-amber-600 flex-shrink-0"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Note:"})," Re-editing will un-approve these hours."]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-3 border-t border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsxs("button",{onClick:()=>{Z(s),z()},disabled:t,className:"px-2.5 py-1.5 text-xs font-medium text-orange-700 bg-orange-50 border border-orange-200 rounded hover:bg-orange-100 flex items-center gap-1 disabled:opacity-50 transition-colors",children:[e.jsx(we,{className:"h-3.5 w-3.5"}),"No-Show"]}),e.jsxs("button",{onClick:()=>{f(s),z()},disabled:t,className:"px-2.5 py-1.5 text-xs font-medium text-red-700 bg-red-50 border border-red-200 rounded hover:bg-red-100 flex items-center gap-1 disabled:opacity-50 transition-colors",children:[e.jsx(Re,{className:"h-3.5 w-3.5"}),"Remove"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:z,disabled:t,className:"px-3 py-1.5 text-sm font-medium text-gray-700 hover:text-gray-900 disabled:opacity-50 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:C,disabled:t,className:"px-3 py-1.5 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white text-sm font-medium rounded-lg shadow-sm flex items-center gap-1.5 transition-colors",children:t?e.jsxs(e.Fragment,{children:[e.jsx(Ke,{className:"h-4 w-4 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Se,{className:"h-4 w-4"}),"Save Changes"]})})]})]})]})]})})})})}),e.jsx("tr",{className:"sm:hidden",children:e.jsx("td",{colSpan:8,className:"py-3 px-3",children:e.jsxs("div",{className:Fe("p-3 rounded-lg space-y-2 transition-all duration-150",r&&"bg-blue-50 border-2 border-blue-500",!r&&O&&"bg-green-50 border border-green-200",!r&&s.status==="no_show"&&"bg-red-50 border border-red-200",!r&&s.status==="cancelled"&&"bg-gray-50 border border-gray-200",!r&&"bg-white border border-gray-200"),children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:Fe("h-8 w-8 rounded-full flex items-center justify-center text-white font-semibold text-xs flex-shrink-0",c),children:h}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium text-gray-900 truncate",children:s.worker_name}),e.jsx("div",{className:"text-xs text-gray-500",children:s.shift_role||"N/A"})]})]}),e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-gray-600 mt-1 ml-10",children:[e.jsx(_e,{className:"h-3 w-3 text-gray-400 flex-shrink-0"}),e.jsx("span",{children:p})]}),O&&!r&&s.approved_by_name&&e.jsxs("div",{className:"text-xs text-green-700 mt-1 ml-10 font-medium",children:["Approved by ",s.approved_by_name.split("@")[0]," on"," ",s.approved_at?k(s.approved_at):"N/A"]})]}),s.approved?e.jsxs("span",{className:"inline-flex items-center gap-1 text-xs font-medium text-green-700",children:[e.jsx(Se,{className:"h-3.5 w-3.5"}),"Approved"]}):s.status==="no_show"?e.jsxs("span",{className:"inline-flex items-center gap-1 text-xs font-medium text-red-700",children:[e.jsx(ns,{className:"h-3.5 w-3.5"}),"No-Show"]}):s.status==="cancelled"?e.jsxs("span",{className:"inline-flex items-center gap-1 text-xs font-medium text-gray-700",children:[e.jsx(Ae,{className:"h-3.5 w-3.5"}),"Cancelled"]}):e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium text-amber-700 bg-amber-50 rounded",children:[e.jsx(_e,{className:"h-3.5 w-3.5"}),"Pending"]})]}),r&&e.jsx("div",{className:"pt-2 border-t border-gray-200",children:e.jsxs("div",{className:"bg-white border-2 border-blue-400 rounded-lg p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Me,{className:"h-4 w-4 text-blue-600"}),e.jsx("h4",{className:"text-sm font-semibold text-gray-900",children:"Edit Hours Worked"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Hours Worked"}),e.jsx("input",{type:"number",step:"0.25",min:"0",max:"24",value:n,onChange:v=>J(v.target.value),onKeyDown:ee,disabled:t,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100",autoFocus:!0})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Updated Total"}),e.jsxs("div",{className:"text-lg font-bold text-blue-600",children:["$",X(n,s.effective_hourly_rate||0)]})]}),u&&e.jsxs("div",{className:"flex items-start gap-2 p-3 bg-amber-50 border border-amber-200 rounded-lg",children:[e.jsx(we,{className:"h-4 w-4 text-amber-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-xs text-amber-800",children:[e.jsx("strong",{children:"Note:"})," Re-editing will un-approve these hours."]})]}),e.jsxs("div",{className:"flex gap-2 pt-2 border-t",children:[e.jsx("button",{onClick:z,disabled:t,className:"flex-1 px-3 py-2 text-sm font-medium text-gray-700 hover:text-gray-900 disabled:opacity-50",children:"Cancel"}),e.jsx("button",{onClick:C,disabled:t,className:"flex-1 px-3 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium rounded-lg flex items-center justify-center gap-2 disabled:bg-blue-400",children:t?e.jsxs(e.Fragment,{children:[e.jsx(Ke,{className:"h-4 w-4 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Se,{className:"h-4 w-4"}),"Save Changes"]})})]})]})]})}),!r&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-sm pt-2 border-t border-gray-200",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Hours"}),e.jsxs("div",{className:"font-medium",children:[ie(s.effective_hours,2,"0.00"),"h",s.edited_at&&e.jsx("span",{className:"ml-1 text-xs text-orange-600",title:"Edited",children:e.jsx(Me,{className:"h-3 w-3 inline"})})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Rate"}),e.jsxs("div",{className:"font-medium",children:["$",ie(s.effective_hourly_rate,2,"0.00"),"/h"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Total"}),e.jsxs("div",{className:"font-semibold",children:["$",ie(s.effective_pay,2,"0.00")]})]})]}),s.can_edit_hours&&s.status!=="no_show"&&s.status!=="cancelled"&&e.jsx("div",{className:"flex items-center gap-2 pt-2 border-t border-gray-200",children:s.approved?e.jsx("button",{onClick:()=>Q(s),className:"w-full px-3 py-1.5 text-xs font-medium text-gray-700 bg-gray-100 rounded hover:bg-gray-200 transition-colors",children:"Re-edit"}):e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>x(s),className:"flex-1 px-3 py-1.5 text-xs font-medium text-blue-700 bg-blue-50 rounded hover:bg-blue-100 transition-colors flex items-center justify-center gap-1",children:[e.jsx(Me,{className:"h-3.5 w-3.5"}),"Edit"]}),e.jsxs("button",{onClick:()=>Z(s),className:"flex-1 px-3 py-1.5 text-xs font-medium text-orange-700 bg-orange-50 rounded hover:bg-orange-100 transition-colors flex items-center justify-center gap-1",children:[e.jsx(we,{className:"h-3.5 w-3.5"}),"No-Show"]}),e.jsx("button",{onClick:()=>f(s),className:"px-3 py-1.5 text-xs font-medium text-red-700 bg-red-50 rounded hover:bg-red-100 transition-colors",children:e.jsx(Re,{className:"h-3.5 w-3.5"})})]})})]})]})})})]})}function Ct({event:s,isOpen:r,onClose:n,onSuccess:t}){const[u,a]=b.useState([]),[y,m]=b.useState(null),[x,C]=b.useState(!1),[z,J]=b.useState(null),[ee,X]=b.useState(""),[Z,f]=b.useState(!1),[Q,M]=b.useState(!1),[D,k]=b.useState(!1),[V,B]=b.useState(new Set),[H,E]=b.useState({isVisible:!1,message:"",type:"success"}),[j,R]=b.useState({open:!1,title:"",variant:"default"});b.useEffect(()=>{r&&s&&(O(),B(new Set))},[r,s]);const O=async()=>{var o,G;if(s!=null&&s.id){C(!0);try{const W=await re.get(`/events/${s.id}/approvals`);a(W.data.data.assignments||[]),m(W.data.data.cost_summary||null)}catch(W){console.error("Error loading assignments:",W),E({isVisible:!0,type:"error",message:((G=(o=W.response)==null?void 0:o.data)==null?void 0:G.error)||W.message||"Unable to load assignments for approval"}),a([]),m(null)}finally{C(!1)}}},h=o=>{J(o.id),X(String(o.effective_hours||o.hours_worked||o.scheduled_hours||"0")),M(!1)},c=()=>{J(null),X(""),M(!1)},p=async()=>{var G,W,ae;if(!z)return;const o=parseFloat(ee);if(isNaN(o)||o<0){E({isVisible:!0,type:"error",message:"Please enter a valid number of hours"});return}if(o>24){E({isVisible:!0,type:"error",message:"Hours cannot exceed 24 per shift"});return}f(!0);try{const te=await re.patch(`/approvals/${z}/update_hours`,{hours_worked:o});await O(),c(),(G=te.data)!=null&&G.message?E({isVisible:!0,type:"success",message:te.data.message}):E({isVisible:!0,type:"success",message:"Hours updated successfully"})}catch(te){console.error("Error updating hours:",te),E({isVisible:!0,type:"error",message:((ae=(W=te.response)==null?void 0:W.data)==null?void 0:ae.message)||"Failed to update hours. Please try again."})}finally{f(!1)}},T=o=>{o.key==="Enter"?(o.preventDefault(),p()):o.key==="Escape"&&(o.preventDefault(),c())},v=(o,G)=>{const W=parseFloat(o);return isNaN(W)?"0.00":(W*G).toFixed(2)},w=o=>{R({open:!0,title:"Re-Edit Approved Hours",message:`Re-editing will un-approve ${o.worker_name}'s hours. The assignment will need to be re-approved after you make changes. Continue?`,variant:"warning",onConfirm:async()=>{R({open:!1,title:""}),J(o.id),X(String(o.effective_hours||o.hours_worked||o.scheduled_hours||"0")),M(!0),E({isVisible:!0,type:"success",message:"Hours un-approved. Make your changes and save."})}})},P=async o=>{R({open:!0,title:"Mark No-Show",message:`Mark ${o.worker_name} as no-show? This will set hours to 0.`,requireNote:!0,note:"",variant:"warning",onConfirm:async G=>{var ae,te;const W=G||j.note||"";R({open:!1,title:""});try{await re.post(`/approvals/${o.id}/mark_no_show`,{notes:W}),await O(),E({isVisible:!0,type:"success",message:"Marked as no-show"})}catch(pe){console.error("Error marking no-show:",pe),E({isVisible:!0,type:"error",message:((te=(ae=pe.response)==null?void 0:ae.data)==null?void 0:te.message)||"Failed to mark no-show"})}}})},d=async o=>{R({open:!0,title:"Remove from Job",message:`Remove ${o.worker_name} from this job? This cannot be undone.`,requireNote:!0,note:"",variant:"danger",onConfirm:async G=>{var ae,te;const W=G||j.note||"";R({open:!1,title:""});try{await re.delete(`/approvals/${o.id}/remove`,{data:{notes:W}}),await O(),E({isVisible:!0,type:"success",message:"Assignment removed"})}catch(pe){console.error("Error removing assignment:",pe),E({isVisible:!0,type:"error",message:((te=(ae=pe.response)==null?void 0:ae.data)==null?void 0:te.message)||"Failed to remove assignment"})}}})},A=u.filter(o=>!o.approved&&o.can_approve&&o.status!=="no_show"&&o.status!=="cancelled"),i=A.filter(o=>V.has(o.id)),g=o=>{B(G=>{const W=new Set(G);return W.has(o)?W.delete(o):W.add(o),W})},F=()=>{i.length===A.length&&A.length>0?B(new Set):B(new Set(A.map(o=>o.id)))},N=async()=>{if(i.length===0){E({isVisible:!0,type:"error",message:"Please select at least one assignment to approve"});return}R({open:!0,title:"Approve Selected Hours",message:`Approve hours for ${i.length} selected ${i.length===1?"worker":"workers"}?`,onConfirm:async()=>{var o,G;k(!0);try{await re.post(`/events/${s.id}/approve_selected`,{assignment_ids:Array.from(i.map(W=>W.id))}),await O(),B(new Set),t(),E({isVisible:!0,type:"success",message:`Approved ${i.length} ${i.length===1?"assignment":"assignments"}`})}catch(W){console.error("Error approving selected:",W),E({isVisible:!0,type:"error",message:((G=(o=W.response)==null?void 0:o.data)==null?void 0:G.message)||"Failed to approve selected hours"})}finally{k(!1),R({open:!1,title:""})}}})},L=async()=>{const o=A.length;R({open:!0,title:"Approve All Hours",message:`Approve hours for all ${o} eligible workers?`,onConfirm:async()=>{var G,W;k(!0);try{await re.post(`/events/${s.id}/approve_all`),await O(),B(new Set),t(),E({isVisible:!0,type:"success",message:`Approved ${o} assignments`})}catch(ae){console.error("Error approving all:",ae),E({isVisible:!0,type:"error",message:((W=(G=ae.response)==null?void 0:G.data)==null?void 0:W.message)||"Failed to approve all hours"})}finally{k(!1),R({open:!1,title:""})}}})};if(!r)return null;const U=u.filter(o=>o.status!=="no_show"&&o.status!=="cancelled"),se=U.filter(o=>!o.approved).length;U.filter(o=>o.approved).length;const K=U.length,fe=U.filter(o=>!o.approved).reduce((o,G)=>o+Number(G.effective_pay||0),0),ce=U.filter(o=>o.approved).reduce((o,G)=>o+Number(G.effective_pay||0),0),be=fe+ce,ye=U.reduce((o,G)=>o+Number(G.effective_hours||0),0),je=o=>{if(!o)return"";try{return Ne(ge(o),"MMM d, yyyy")}catch{return new Date(o).toLocaleDateString()}};return e.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-0 sm:p-4 overflow-y-auto",children:[e.jsx(ts,{isVisible:H.isVisible,message:H.message,type:H.type,onClose:()=>E({...H,isVisible:!1})}),e.jsxs("div",{className:"bg-white w-full h-full sm:h-auto sm:max-w-5xl sm:rounded-lg shadow-xl overflow-hidden flex flex-col sm:max-h-[90vh] my-0 sm:my-4",children:[e.jsx("header",{className:"border-b px-6 py-4 bg-white flex-shrink-0",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Approve Hours"}),e.jsxs("p",{className:"text-sm text-gray-500 mt-0.5",children:[s==null?void 0:s.title," Â· ",s!=null&&s.event_date?je(s.event_date):""]})]}),e.jsx("button",{onClick:n,className:"text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Close modal",children:e.jsx(Ae,{className:"h-5 w-5"})})]})}),se>0&&e.jsx("div",{className:"bg-amber-50 border-l-4 border-amber-400 px-6 py-3 flex-shrink-0",children:e.jsxs("p",{className:"text-sm text-amber-800 flex items-center gap-2",children:[e.jsx(we,{className:"h-4 w-4"}),e.jsx("strong",{children:se})," ",se===1?"assignment":"assignments"," pending approval"]})}),e.jsx("div",{className:"flex-1 overflow-auto px-3 sm:px-6 py-4",children:x?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading assignments..."})]}):u.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(we,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"No assignments found for this event."})]}):e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"border-b border-gray-200 hidden sm:table-header-group",children:e.jsxs("tr",{className:"text-left",children:[e.jsx("th",{className:"pb-3 text-xs font-medium text-gray-500 uppercase tracking-wider w-12 px-3",children:A.length>0&&e.jsx("input",{type:"checkbox",checked:i.length===A.length&&A.length>0,onChange:F,className:"h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300 rounded cursor-pointer",title:i.length===A.length?"Deselect all":"Select all"})}),e.jsx("th",{className:"pb-3 text-xs font-medium text-gray-500 uppercase tracking-wider w-[25%]",children:"Worker"}),e.jsx("th",{className:"pb-3 text-xs font-medium text-gray-500 uppercase tracking-wider w-[15%]",children:"Role"}),e.jsx("th",{className:"pb-3 text-xs font-medium text-gray-500 uppercase tracking-wider w-[18%]",children:"Time Worked"}),e.jsx("th",{className:"pb-3 text-xs font-medium text-gray-500 uppercase tracking-wider text-right w-[10%]",children:"Hours"}),e.jsx("th",{className:"pb-3 text-xs font-medium text-gray-500 uppercase tracking-wider text-right w-[10%]",children:"Rate"}),e.jsx("th",{className:"pb-3 text-xs font-medium text-gray-500 uppercase tracking-wider text-right w-[12%]",children:"Total"}),e.jsx("th",{className:"pb-3 text-xs font-medium text-gray-500 uppercase tracking-wider text-right w-[10%]",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:u.map(o=>{const G=!o.approved&&o.can_approve&&o.status!=="no_show"&&o.status!=="cancelled";return e.jsx(St,{assignment:o,isEditing:z===o.id,editHours:ee,isSavingEdit:Z,wasApprovedBeforeEdit:Q,isSelected:V.has(o.id),canSelect:G,onToggleSelect:g,onStartEdit:h,onSaveEdit:p,onCancelEdit:c,onEditHoursChange:X,onEditKeyDown:T,calculateLiveTotal:v,onNoShow:P,onRemove:d,onReEdit:w},o.id)})})]})}),e.jsx("footer",{className:"border-t bg-gray-50 px-3 sm:px-6 py-4 flex-shrink-0",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"text-gray-600",children:se===0?"Final approved cost:":"Total cost:"}),e.jsxs("span",{className:"ml-2 text-lg font-bold text-gray-900",children:["$",ie(be,2,"0.00")]}),e.jsxs("span",{className:"ml-1 text-gray-600",children:["(",K," ",K===1?"worker":"workers",", ",ie(ye,2,"0.00"),"h)"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:n,className:"px-4 py-2 text-sm font-medium text-gray-700 hover:text-gray-900 transition-colors",children:"Close"}),se>0&&e.jsx("button",{onClick:()=>{i.length>0?N():L()},disabled:D,className:"px-5 py-2.5 bg-green-600 hover:bg-green-700 disabled:bg-green-400 text-white text-sm font-semibold rounded-lg shadow-sm flex items-center gap-2 transition-colors",children:D?e.jsxs(e.Fragment,{children:[e.jsx(Ke,{className:"h-4 w-4 animate-spin"}),"Approving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Se,{className:"h-4 w-4"}),i.length>0?"Approve Selected":"Approve All"]})})]})]})})]}),j.open&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>R({open:!1,title:""})}),e.jsxs("div",{className:"relative bg-white w-full max-w-md rounded-lg shadow-xl p-5",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:j.title}),j.message&&e.jsx("p",{className:"mt-2 text-sm text-gray-700",children:j.message}),j.requireNote&&e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Notes (optional)"}),e.jsx("textarea",{value:j.note||"",onChange:o=>R(G=>({...G,note:o.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:3})]}),e.jsxs("div",{className:"mt-5 flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>R({open:!1,title:""}),className:"px-4 py-2 bg-gray-100 text-gray-700 text-sm font-medium rounded-md hover:bg-gray-200",children:"Cancel"}),e.jsx("button",{onClick:async()=>{const o=j.note||"";j.onConfirm&&await j.onConfirm(o)},className:"px-4 py-2 text-white text-sm font-medium rounded-md "+(j.variant==="danger"?"bg-red-600 hover:bg-red-700":j.variant==="warning"?"bg-yellow-600 hover:bg-yellow-700":"bg-blue-600 hover:bg-blue-700"),children:"Confirm"})]})]})]})]})}function he({className:s="",count:r=1}){return e.jsx(e.Fragment,{children:Array.from({length:r}).map((n,t)=>e.jsx("div",{className:`animate-pulse bg-gray-200 rounded-lg ${s}`},t))})}function Ge(){return e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(he,{className:"h-6 w-48 mb-2"}),e.jsx(he,{className:"h-4 w-32"})]}),e.jsx(he,{className:"h-8 w-8 rounded-full"})]}),e.jsxs("div",{className:"space-y-3 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(he,{className:"h-4 w-4 rounded"}),e.jsx(he,{className:"h-4 w-40"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(he,{className:"h-4 w-4 rounded"}),e.jsx(he,{className:"h-4 w-36"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(he,{className:"h-4 w-4 rounded"}),e.jsx(he,{className:"h-4 w-32"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(he,{className:"h-2 w-full rounded-full mb-2"}),e.jsx(he,{className:"h-3 w-24"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(he,{className:"h-9 w-24 rounded-md"}),e.jsx(he,{className:"h-9 w-24 rounded-md"})]})]})})}function At(s,r=500){const[n,t]=b.useState(s);return b.useEffect(()=>{const u=setTimeout(()=>{t(s)},r);return()=>{clearTimeout(u)}},[s,r]),n}function Kt(){const s=ds(),[r,n]=Ms(),t=(r.get("tab")==="completed"?"completed":r.get("tab"))||"active",u=r.get("filter")||"needs_workers",[a,y]=b.useState(t),[m,x]=b.useState(u),[C,z]=b.useState(""),J=At(C,500),[ee,X]=b.useState("date"),[Z,f]=b.useState(!0),[Q,M]=b.useState([]),[D,k]=b.useState(new Set),[V,B]=b.useState(new Set),[H,E]=b.useState({isOpen:!1}),[j,R]=b.useState({isOpen:!1}),[O,h]=b.useState({isVisible:!1,message:"",type:"success"}),[c,p]=b.useState({isOpen:!1,isLoading:!1}),[T,v]=b.useState({isOpen:!1,isLoading:!1}),[w,P]=b.useState({isOpen:!1,isLoading:!1}),[d,A]=b.useState({isOpen:!1,unfilledShiftIds:[]}),[i,g]=b.useState({isOpen:!1});b.useEffect(()=>{F()},[a,m,r]),b.useEffect(()=>{const l=(r.get("tab")==="completed"?"completed":r.get("tab"))||"active",$=r.get("filter")||"all";l!==a&&y(l),$!==m&&x($)},[r,a,m]),b.useEffect(()=>{const l=r.get("event_id"),$=r.get("shift_id");if(l){const I=parseInt(l);isNaN(I)||(k(new Set([I])),$&&console.log(`Auto-expanding event ${I} with shift ${$}`))}},[r]),b.useEffect(()=>{const l=r.get("event_id");if(!l)return;const $=parseInt(l);if(isNaN($))return;const I=Q.find(Y=>Y.id===$);I&&(!I.shifts_by_role||I.shifts_by_role.length===0)&&(U($),k(new Set([$])))},[r,Q]);async function F(){f(!0);try{const l=a==="completed"?"completed":a,$=r.get("date");let I=`/events?tab=${l}`;m!=="all"&&(I+=`&filter=${m}`),$&&(I+=`&date=${$}`),console.log("Loading events with URL:",I,"filterStatus:",m,"date:",$);const Y=await re.get(I);if(Y.data.status==="success"){console.log("Received events:",Y.data.data.length);const de=Y.data.data;if(a==="completed"){const me=await Promise.all(de.map(async ue=>{var ve;try{const le=await re.get(`/events/${ue.id}/approvals`);if(((ve=le.data)==null?void 0:ve.status)==="success"){const xe=le.data.data.assignments||[],ze=xe.length,Ee=xe.filter(Ss=>Ss.approved).length,_s=le.data.data.cost_summary||null;return{...ue,approval_status:{total:ze,approved:Ee,pending:ze-Ee},cost_summary:_s}}}catch(le){console.warn(`Failed to load approval status for event ${ue.id}:`,le)}return ue}));M(me)}else{const me=Array.from(D);M(ue=>{const ve=new Map(ue.map(le=>[le.id,le]));return de.map(le=>{const xe=ve.get(le.id);return me.includes(le.id)&&(xe!=null&&xe.shifts_by_role)&&xe.shifts_by_role.length>0?{...le,shifts_by_role:xe.shifts_by_role,full_details:xe.full_details||xe}:le})}),me.length>0&&Promise.all(me.map(ue=>U(ue))).catch(ue=>{console.error("Failed to refresh expanded event details:",ue)})}}}catch(l){console.error("Failed to load events:",l)}finally{f(!1)}}const N=l=>{y(l),n({tab:l}),x(l==="active"?"needs_workers":"all")},L=l=>{x(l);const $=new URLSearchParams;$.set("tab",a),l!=="all"&&$.set("filter",l),n($)},U=async l=>{var $,I;B(Y=>new Set(Y).add(l));try{const[Y,de]=await Promise.all([re.get(`/events/${l}`),re.get(`/events/${l}/approvals`).catch(()=>null)]);if((($=Y.data)==null?void 0:$.status)==="success"){const me=Y.data.data;if(((I=de==null?void 0:de.data)==null?void 0:I.status)==="success"){const ue=de.data.data.assignments||[],ve=new Map(ue.map(le=>[le.id,le]));me.shifts_by_role&&(me.shifts_by_role=me.shifts_by_role.map(le=>({...le,shifts:le.shifts.map(xe=>({...xe,assignments:xe.assignments.map(ze=>{const Ee=ve.get(ze.id);return Ee&&typeof Ee=="object"?{...ze,...Ee}:ze})}))})))}M(ue=>ue.map(ve=>ve.id===l?{...ve,...me}:ve))}}catch(Y){console.error("Failed to load event details",Y)}finally{B(Y=>{const de=new Set(Y);return de.delete(l),de})}},se=l=>{const $=new Set(D);if($.has(l))$.delete(l),B(I=>{const Y=new Set(I);return Y.delete(l),Y});else{$.add(l);const I=Q.find(me=>me.id===l),Y=V.has(l),de=(I==null?void 0:I.shifts_by_role)&&I.shifts_by_role.length>0;!Y&&!de&&U(l)}k($)};async function K(l){const $=Q==null?void 0:Q.find(I=>I.id===l);P({isOpen:!0,isLoading:!1,eventId:l,eventTitle:$==null?void 0:$.title})}async function fe(){if(w.eventId){P(l=>({...l,isLoading:!0}));try{const l=await re.delete(`/events/${w.eventId}`);l.data.status==="success"?(P({isOpen:!1,isLoading:!1}),h({isVisible:!0,message:`"${l.data.event_title}" moved to trash`,type:"success",action:{label:"Undo",onClick:()=>ce(l.data.event_id),variant:"primary"}}),F()):h({isVisible:!0,message:l.data.message||"Unable to delete event",type:"error"})}catch(l){console.error("Failed to delete event:",l),h({isVisible:!0,message:"Unable to delete event",type:"error"})}finally{P(l=>({...l,isLoading:!1}))}}}async function ce(l){try{const $=await re.post(`/events/${l}/restore`);$.data.status==="success"?(h({isVisible:!0,message:"Event restored to draft",type:"success"}),F()):h({isVisible:!0,message:$.data.message||"Unable to restore event",type:"error"})}catch($){console.error("Failed to restore event:",$),h({isVisible:!0,message:"Unable to restore event",type:"error"})}}function be(){P({isOpen:!1,isLoading:!1})}function ye(l){p({isOpen:!0,eventId:l,isLoading:!1})}async function je(){if(c.eventId){p(l=>({...l,isLoading:!0}));try{const l=await re.post(`/events/${c.eventId}/publish`);l.data.status==="success"?(h({isVisible:!0,message:"Event published successfully",type:"success"}),p({isOpen:!1,isLoading:!1}),F()):(h({isVisible:!0,message:l.data.message||"Unable to publish event",type:"error"}),p({isOpen:!1,isLoading:!1}))}catch(l){console.error("Failed to publish event:",l),h({isVisible:!0,message:"Unable to publish event",type:"error"}),p({isOpen:!1,isLoading:!1})}}}function o(){p({isOpen:!1,isLoading:!1})}function G(l,$){v({isOpen:!0,assignmentId:l,isLoading:!1,workerName:$})}async function W(){var l,$;if(T.assignmentId){v(I=>({...I,isLoading:!0}));try{const I=await re.delete(`/staffing/${T.assignmentId}`);((l=I.data)==null?void 0:l.status)==="success"?(h({isVisible:!0,message:"Worker unassigned successfully",type:"success"}),v({isOpen:!1,isLoading:!1}),F()):(h({isVisible:!0,message:(($=I.data)==null?void 0:$.message)||"Unable to unassign worker",type:"error"}),v({isOpen:!1,isLoading:!1}))}catch(I){console.error("Failed to unassign worker:",I),h({isVisible:!0,message:"Unable to unassign worker",type:"error"}),v({isOpen:!1,isLoading:!1})}}}const ae=l=>{R({isOpen:!0,shiftId:l})},te=()=>{R({isOpen:!1})},pe=()=>{te(),h({isVisible:!0,message:"Worker assigned",type:"success"}),F()},ne=Q.filter(l=>{var $;if(J){const I=J.toLowerCase();if(!(l.title.toLowerCase().includes(I)||(($=l.venue)==null?void 0:$.name.toLowerCase().includes(I))))return!1}if(a==="active")switch(m){case"needs_workers":return l.unfilled_roles_count>0;case"partially_filled":return l.unfilled_roles_count>0&&l.assigned_workers_count>0;case"fully_staffed":return l.unfilled_roles_count===0&&l.assigned_workers_count>0;case"all":default:return!0}return!0}).sort((l,$)=>{var I,Y;switch(ee){case"name":return l.title.localeCompare($.title);case"staffing":return l.staffing_percentage-$.staffing_percentage;case"date":default:const de=((I=l.schedule)==null?void 0:I.start_time_utc)||l.created_at,me=((Y=$.schedule)==null?void 0:Y.start_time_utc)||$.created_at;return new Date(de).getTime()-new Date(me).getTime()}});return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-2",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-900",children:"Events"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Manage events and assign workers"})]}),e.jsxs("button",{onClick:()=>s("/events/create"),className:"w-full sm:w-auto inline-flex items-center justify-center gap-2 px-4 py-2 bg-teal-600 text-white font-medium rounded-lg hover:bg-teal-700 transition-colors shadow-sm min-h-touch",children:[e.jsx(We,{size:20}),"Create New Event"]})]}),r.get("date")&&e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-teal-50 border border-teal-200 rounded-lg",children:[e.jsx(qe,{size:16,className:"text-teal-600"}),e.jsxs("span",{className:"text-sm font-medium text-teal-900",children:["Showing events for ",Ne(ge(r.get("date")),"EEEE, MMMM d, yyyy")]}),e.jsx("button",{onClick:()=>{const l=new URLSearchParams(r);l.delete("date"),n(l)},className:"ml-auto text-teal-600 hover:text-teal-700",title:"Clear date filter",children:e.jsx(Ae,{size:16})})]})]}),e.jsxs("div",{className:"flex gap-6 border-b border-gray-200 mb-6",children:[e.jsx("button",{onClick:()=>N("draft"),className:`pb-3 px-1 font-medium transition-colors border-b-2 ${a==="draft"?"border-teal-600 text-teal-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Draft Events"}),e.jsx("button",{onClick:()=>N("active"),className:`pb-3 px-1 font-medium transition-colors border-b-2 ${a==="active"?"border-teal-600 text-teal-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Active Events"}),e.jsx("button",{onClick:()=>N("completed"),className:`pb-3 px-1 font-medium transition-colors border-b-2 ${a==="completed"?"border-teal-600 text-teal-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Completed Events"})]}),e.jsxs("div",{className:"flex flex-col md:flex-row items-stretch md:items-center gap-3 sm:gap-4 mb-6",children:[e.jsxs("div",{className:"w-full md:flex-1 md:max-w-md relative",children:[e.jsx(ss,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),e.jsx("input",{type:"text",placeholder:"Search events or venues...",value:C,onChange:l=>z(l.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent"})]}),e.jsxs("select",{value:ee,onChange:l=>X(l.target.value),className:"w-full sm:w-auto px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500 bg-white",children:[e.jsx("option",{value:"date",children:"Sort by Date"}),e.jsx("option",{value:"name",children:"Sort by Name"}),a!=="draft"&&e.jsx("option",{value:"staffing",children:"Sort by Staffing"})]}),a==="active"&&e.jsxs("div",{className:"w-full sm:w-auto flex flex-wrap gap-2",children:[e.jsx("button",{onClick:()=>L("all"),className:`w-full sm:w-auto px-3 py-2 text-sm font-medium rounded-lg transition ${m==="all"?"bg-gray-100 text-gray-700":"bg-white text-gray-600 hover:bg-gray-50 border border-gray-300"}`,children:"All"}),e.jsx("button",{onClick:()=>L("needs_workers"),className:`w-full sm:w-auto px-3 py-2 text-sm font-medium rounded-lg transition ${m==="needs_workers"?"bg-red-100 text-red-700":"bg-white text-gray-600 hover:bg-gray-50 border border-gray-300"}`,children:"Needs Workers"}),e.jsx("button",{onClick:()=>L("fully_staffed"),className:`w-full sm:w-auto px-3 py-2 text-sm font-medium rounded-lg transition ${m==="fully_staffed"?"bg-green-100 text-green-700":"bg-white text-gray-600 hover:bg-gray-50 border border-gray-300"}`,children:"Ready"})]})]}),Z?e.jsxs("div",{className:"space-y-4",children:[e.jsx(Ge,{}),e.jsx(Ge,{}),e.jsx(Ge,{})]}):e.jsxs(e.Fragment,{children:[a==="draft"&&e.jsx(Mt,{events:ne,onDelete:K,onPublish:ye,onNavigate:l=>s(l),searchQuery:C}),a==="active"&&e.jsx($t,{events:ne,expandedEvents:D,loadingEventDetails:V,onToggleEvent:se,onAssignWorker:ae,onUnassign:G,onQuickFill:(l,$,I,Y)=>A({isOpen:!0,eventId:l,roleName:$,unfilledShiftIds:I,payRate:Y}),onPublish:ye,onDelete:K,onEdit:l=>g({isOpen:!0,event:l}),searchQuery:C}),a==="completed"&&e.jsx(Ft,{events:ne,searchQuery:C,onApproveHours:l=>E({isOpen:!0,event:l})})]})]}),j.isOpen&&j.shiftId&&e.jsx(Nt,{shiftId:j.shiftId,onClose:te,onSuccess:pe}),e.jsx(ts,{isVisible:O.isVisible,message:O.message,type:O.type,action:O.action,onClose:()=>h({...O,isVisible:!1})}),e.jsx(He,{isOpen:c.isOpen,onClose:o,onConfirm:je,title:"Publish Event",message:"Ready to publish? This will create shifts and make them available for worker assignment.",confirmText:c.isLoading?"Publishingâ€¦":"Publish",cancelText:"Cancel",isLoading:c.isLoading,isDestructive:!1}),e.jsx(He,{isOpen:T.isOpen,onClose:()=>v({isOpen:!1,isLoading:!1}),onConfirm:W,title:"Unassign Worker",message:`Remove ${T.workerName||"this worker"} from this shift?`,confirmText:T.isLoading?"Removingâ€¦":"Unassign",cancelText:"Cancel",isLoading:T.isLoading,isDestructive:!0}),e.jsx(He,{isOpen:w.isOpen,onClose:be,onConfirm:fe,title:"Delete Event",message:`Delete "${w.eventTitle}"? This action cannot be undone.`,confirmText:w.isLoading?"Deletingâ€¦":"Delete",cancelText:"Cancel",isLoading:w.isLoading,isDestructive:!0}),e.jsx(kt,{isOpen:d.isOpen,eventId:d.eventId||0,roleName:d.roleName||"",unfilledShiftIds:d.unfilledShiftIds,defaultPayRate:d.payRate,onClose:()=>A({isOpen:!1,unfilledShiftIds:[]}),onDone:({assigned:l,conflicts:$,details:I})=>{A({isOpen:!1,unfilledShiftIds:[]});let Y=`Assigned ${l} workers â€¢ ${$} skipped`;$>0&&I&&(Y+=`: ${I}`),h({isVisible:!0,message:Y,type:$>0?"error":"success"}),F()}}),i.event&&e.jsx(_t,{event:i.event,isOpen:i.isOpen,onClose:()=>g({isOpen:!1,event:void 0}),onSuccess:()=>{F(),g({isOpen:!1,event:void 0})}}),H.isOpen&&H.event&&e.jsx(Ct,{event:H.event,isOpen:H.isOpen,onClose:()=>{E({isOpen:!1}),F()},onSuccess:()=>{F(),E({isOpen:!1})}})]})}function Mt({events:s,onDelete:r,onPublish:n,onNavigate:t,searchQuery:u}){const a=m=>{if(!m)return"No date set";const x=ge(m);return Ne(x,"MMM d, yyyy")},y=m=>{if(!m)return"";const x=ge(m);return Ne(x,"h:mm a")};return s.length===0?e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ“…"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:u?"No draft events found":"No draft events yet"}),e.jsx("p",{className:"text-gray-600 mb-6",children:u?"Try adjusting your search query":"Create your first event to get started"}),!u&&e.jsxs("button",{onClick:()=>t("/events/create"),className:"inline-flex items-center gap-2 px-4 py-2 bg-teal-600 text-white font-medium rounded-lg hover:bg-teal-700 transition-colors",children:[e.jsx(We,{size:20}),"Create Event"]})]}):e.jsx("div",{className:"space-y-4",children:s.map(m=>{var x;return e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 hover:shadow-md transition-shadow",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:[m.title,m.schedule&&e.jsxs("span",{className:"ml-2 text-sm font-normal text-gray-600",children:["â€¢ ",y(m.schedule.start_time_utc),"â€“",y(m.schedule.end_time_utc)]})]})}),e.jsx("span",{className:"px-2.5 py-1 bg-gray-100 text-gray-700 text-xs font-medium rounded-full",children:"Draft"})]}),m.venue&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 mb-2",children:[e.jsx(Ue,{size:16,className:"text-gray-400 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:((x=m.venue)==null?void 0:x.name)||"No venue"})]}),m.schedule&&e.jsx("div",{className:"flex items-center gap-4 text-sm text-gray-600 mb-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(qe,{size:16,className:"text-gray-400 flex-shrink-0"}),e.jsx("span",{children:a(m.schedule.start_time_utc)})]})}),m.total_workers_needed>0&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(Je,{size:16,className:"text-gray-400"}),e.jsxs("span",{children:[m.total_workers_needed," workers needed"]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{onClick:()=>t(`/events/${m.id}/edit`),className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition",title:"Edit",children:e.jsx(us,{size:18})})})]})})},m.id)})})}function $t({events:s,expandedEvents:r,loadingEventDetails:n,onToggleEvent:t,onAssignWorker:u,onUnassign:a,onQuickFill:y,onPublish:m,onDelete:x,onEdit:C,searchQuery:z}){const J=f=>{const Q=ge(f);return Ne(Q,"EEE, MMM d, yyyy")},ee=f=>{const Q=ge(f);return Ne(Q,"h:mm a")},X=f=>{if(!f.schedule)return!1;const M=(ge(f.schedule.start_time_utc).getTime()-new Date().getTime())/(1e3*60*60);return M>0&&M<=48},Z=f=>{switch(f){case"fully_staffed":return e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 bg-green-100 text-green-700 text-xs font-medium rounded-full",children:[e.jsx(Se,{size:14}),"Ready"]});case"partially_staffed":return e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 bg-yellow-100 text-yellow-700 text-xs font-medium rounded-full",children:[e.jsx(we,{size:14}),"Partial"]});case"needs_workers":return e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 bg-red-100 text-red-700 text-xs font-medium rounded-full",children:[e.jsx(Ae,{size:14}),"Needs Workers"]});default:return null}};return s.length===0?e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ“…"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:z?"No active events found":"No active events"}),e.jsx("p",{className:"text-gray-600",children:z?"Try adjusting your search query or filters":"Publish draft events to see them here"})]}):e.jsx("div",{className:"space-y-4",children:s.map(f=>{const Q=r.has(f.id);return e.jsxs("div",{className:"border border-gray-200 rounded-lg p-5 hover:border-gray-300 hover:shadow-sm transition-all",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-1 truncate",children:f.title}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600 flex-wrap",children:[f.schedule&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(qe,{className:"h-4 w-4 flex-shrink-0"}),J(f.schedule.start_time_utc)]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(_e,{className:"h-4 w-4 flex-shrink-0"}),ee(f.schedule.start_time_utc)," - ",ee(f.schedule.end_time_utc),X(f)&&e.jsx("span",{className:"bg-red-600 text-white text-xs font-semibold px-2 py-0.5 rounded-full ml-2","aria-label":"Urgent: starts within 48 hours",children:"Urgent"})]})]}),f.venue&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ue,{className:"h-4 w-4 flex-shrink-0"}),f.venue.name]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0 ml-4",children:[Z(f.staffing_status),C&&f.status==="published"&&e.jsx("button",{onClick:M=>{M.stopPropagation(),C(f)},title:"Edit Event",className:"p-1.5 text-teal-600 hover:text-teal-700 hover:bg-teal-50 rounded transition-colors",children:e.jsx(Vs,{size:14})}),x&&e.jsx("button",{onClick:M=>{M.stopPropagation(),x(f.id)},title:"Delete",className:"p-1.5 text-red-600 hover:text-red-700 hover:bg-red-50 rounded transition-colors",children:e.jsx(Re,{size:14})}),e.jsx("button",{onClick:()=>t(f.id),className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:Q?e.jsx(As,{size:20,className:"text-gray-600"}):e.jsx(Ds,{size:20,className:"text-gray-600"})})]})]}),e.jsx("div",{className:"py-3 border-y border-gray-100 space-y-2",children:(()=>{const M=f.assigned_workers_count||0,D=f.total_workers_needed||0,k=D>0?Math.round(M/D*100):0;f.unfilled_roles_count;const V=(()=>{const H=f.estimated_cost??f.total_cost??f.total_pay_amount??0;return ie(H,2,"0.00")})(),B=()=>k>=100?"bg-green-500":k>=75?"bg-amber-500":k>=50?"bg-orange-500":"bg-red-500";return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700 whitespace-nowrap",children:[M," of ",D," roles filled"]}),e.jsx("div",{className:"flex-1 h-2 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:Fe("h-full rounded-full transition-all duration-300",B()),style:{width:`${k}%`}})}),e.jsxs("span",{className:"text-sm font-semibold text-gray-900 whitespace-nowrap",children:[k,"%"]})]}),e.jsxs("div",{className:"text-sm font-medium text-gray-700",children:[M,"/",D," hired"]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("span",{children:"Est. Cost: "}),e.jsxs("span",{className:"font-semibold text-gray-900",children:["$",V]})]})]})})()}),Q&&e.jsx("div",{className:"border-t border-gray-200 bg-gray-50 px-6 py-4",children:n.has(f.id)?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 border-4 border-teal-600 border-t-transparent rounded-full animate-spin"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Loading assignments..."})]})}):f.shifts_by_role&&f.shifts_by_role.length>0?e.jsx("div",{className:"space-y-4",children:f.shifts_by_role.map(M=>e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:M.role_name}),e.jsxs("span",{className:"text-sm text-gray-600",children:[M.filled_shifts,"/",M.total_shifts," hired"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[M.filled_shifts<M.total_shifts&&e.jsxs("span",{className:"px-2.5 py-1 bg-red-100 text-red-700 text-xs font-medium rounded-full",children:[M.total_shifts-M.filled_shifts," needed"]}),M.filled_shifts<M.total_shifts&&e.jsx("button",{onClick:D=>{var B;D.stopPropagation();const k=M.shifts.filter(H=>H.staffing_progress.percentage<100).sort((H,E)=>new Date(H.start_time_utc).getTime()-new Date(E.start_time_utc).getTime()).map(H=>H.id),V=(B=M.shifts[0])==null?void 0:B.pay_rate;y(f.id,M.role_name,k,V)},className:"px-2.5 py-1 text-xs font-semibold bg-teal-600 text-white rounded hover:bg-teal-700",title:"Quick Fill by Skill",children:"Quick Fill by Skill"})]})]}),e.jsx("div",{className:"space-y-2",children:M.shifts.map((D,k)=>e.jsxs("div",{className:"flex items-center justify-between py-2 px-3 bg-gray-50 rounded border border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-6 h-6 bg-gray-200 text-gray-700 rounded-md flex items-center justify-center text-xs font-medium",children:k+1}),e.jsxs("span",{className:"text-sm text-gray-700",children:[ee(D.start_time_utc)," - ",ee(D.end_time_utc)]}),D.assignments.length>0&&e.jsx("div",{className:"flex items-center gap-1 flex-wrap",children:D.assignments.map(V=>{const B=`${V.worker.first_name} ${V.worker.last_name}`,H=Number(V.hourly_rate||D.pay_rate||0);return e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"bg-white text-black border border-gray-200 rounded-full px-2.5 py-1 text-sm font-medium shadow-sm max-w-[140px] truncate",title:`${B} â€¢ $${ie(H,0,"0")}/hr`,children:B}),e.jsx("button",{onClick:E=>{E.stopPropagation(),a(V.id,B)},className:"w-5 h-5 flex items-center justify-center text-red-600 hover:text-red-700 hover:bg-red-50 rounded",title:"Unassign worker",children:e.jsx(Ae,{size:12})})]},V.id)})})]}),D.staffing_progress.percentage===100?e.jsxs("span",{className:"flex items-center gap-1.5 text-sm font-medium text-green-600",children:[e.jsx(Se,{size:16}),"Assigned"]}):e.jsx("button",{onClick:V=>{V.stopPropagation(),u(D.id)},className:"px-3 py-1.5 bg-teal-600 text-white text-sm font-medium rounded-lg hover:bg-teal-700 transition-colors",children:"Assign Worker"})]},D.id))})]},M.role_name))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-gray-500 mb-4",children:f.status==="draft"?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"font-medium",children:"This event is still in draft status"}),e.jsx("p",{className:"text-sm",children:"Publish the event to generate shifts and assign workers"})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"font-medium",children:"No shifts available"}),e.jsx("p",{className:"text-sm",children:"This event may not have any shifts generated yet"})]})}),e.jsx("div",{className:"flex items-center justify-center gap-3",children:f.status==="draft"&&e.jsx("button",{onClick:()=>m(f.id),className:"px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-colors",children:"Publish Event"})})]})})]},f.id)})})}function Ft({events:s,searchQuery:r,onApproveHours:n}){const t=a=>{const y=ge(a);return Ne(y,"MMM d, yyyy")},u=a=>{const y=ge(a);return Ne(y,"h:mm a")};return s.length===0?e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ“‹"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:r?"No past events found":"No past events yet"}),e.jsx("p",{className:"text-gray-600",children:r?"Try adjusting your search query":"Completed events will appear here"})]}):e.jsx("div",{className:"space-y-4",children:s.map(a=>{var m;const y=xs(a.total_hours??a.total_hours_worked??0);return e.jsxs("div",{className:"border border-gray-200 rounded-lg p-5 hover:border-gray-300 hover:shadow-sm transition-all",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-1 truncate",children:a.title}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600 flex-wrap",children:[a.schedule&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(qe,{className:"h-4 w-4 flex-shrink-0"}),t(a.schedule.start_time_utc)]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(_e,{className:"h-4 w-4 flex-shrink-0"}),u(a.schedule.start_time_utc)," - ",u(a.schedule.end_time_utc)]})]}),a.venue&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ue,{className:"h-4 w-4 flex-shrink-0"}),a.venue.name]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0 ml-4",children:[e.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-gray-100 text-gray-700 rounded",children:"Completed"}),a.approval_status&&a.approval_status.pending>0&&e.jsxs("span",{className:"px-2 py-1 text-xs font-medium bg-amber-100 text-amber-700 rounded",children:[a.approval_status.pending," Pending"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4 py-3 border-y border-gray-100",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Workers"}),e.jsx("div",{className:"text-lg font-semibold text-gray-900",children:a.assigned_workers_count||0})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Hours"}),e.jsx("div",{className:"text-lg font-semibold text-gray-900",children:ie(y,2,"0.00")})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Cost"}),e.jsxs("div",{className:"text-lg font-semibold text-gray-900",children:["$",(m=a.cost_summary)!=null&&m.total_estimated_cost?ie(a.cost_summary.total_estimated_cost,2,"0.00"):a.total_pay_amount?ie(a.total_pay_amount,2,"0.00"):"0.00"]}),a.approval_status&&a.approval_status.pending>0&&a.cost_summary&&e.jsxs("div",{className:"text-xs text-amber-600 font-medium mt-0.5",children:["$",ie(a.cost_summary.pending_cost,2,"0.00")," pending"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Staffing"}),(()=>{const x=a.total_workers_needed||0,C=a.assigned_workers_count||0;if(x===0&&C===0)return e.jsx("div",{className:"text-lg font-semibold text-gray-400",children:"Not staffed"});const z=a.staffing_percentage||(x>0?Math.round(C/x*100):0);return e.jsxs("div",{className:Fe("text-lg font-semibold",z===100?"text-green-600":z>0?"text-yellow-600":"text-red-600"),children:[z,"%"]})})()]})]}),e.jsx("div",{className:"mt-4 flex justify-end",children:n&&(()=>{const x=a.total_workers_needed||0,C=a.assigned_workers_count||0,z=a.approval_status&&a.approval_status.total>0;return x===0&&C===0&&!z?null:e.jsxs("button",{onClick:()=>n(a),className:Fe("px-4 py-2 text-sm font-medium rounded-lg flex items-center gap-2 transition-colors shadow-sm",a.approval_status&&a.approval_status.pending>0?"bg-amber-600 hover:bg-amber-700 text-white":a.approval_status&&a.approval_status.approved===a.approval_status.total&&z||z?"bg-green-600 hover:bg-green-700 text-white":"bg-gray-300 text-gray-500 cursor-not-allowed"),disabled:!z,children:[a.approval_status&&a.approval_status.pending>0?e.jsxs(e.Fragment,{children:[e.jsx(_e,{className:"h-4 w-4"}),"Approve Hours (",a.approval_status.pending,")"]}):z?e.jsxs(e.Fragment,{children:[e.jsx(Se,{className:"h-4 w-4"}),"Approved"]}):e.jsxs(e.Fragment,{children:[e.jsx(Se,{className:"h-4 w-4"}),"No assignments"]}),e.jsx(Rs,{className:"h-4 w-4"})]})})()})]},a.id)})})}export{Kt as EventsPage};
