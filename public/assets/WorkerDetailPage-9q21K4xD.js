import{c as z,a as u,j as e}from"./index-DdvmZsOd.js";import{i as I,b as W,r as o}from"./vendor-79DyBOV9.js";import{b as h,a as w,g as k}from"./dateUtils-DOgDl2w8.js";import{L as $}from"./LoadingSpinner-DlnrMedm.js";import{f as L}from"./phone-DFL4-DJ9.js";import{A as M,P as B}from"./phone-DfCogSID.js";import{C as F,X as R}from"./x-circle-D3e7tY5f.js";import{P as U}from"./pen-square-Uy4nvxIl.js";import{M as j}from"./map-pin-Bpa4LeX2.js";import{B as X}from"./briefcase-Br2PXs1p.js";import{C as A}from"./calendar-Cxm3DC9H.js";import{C}from"./index-DWd4JYoW.js";import"./index-B8jveqfy.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=z("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=z("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);function ie(){const{id:i}=I(),m=W(),[s,D]=o.useState(null),[v,P]=o.useState([]),[E,y]=o.useState(!0),[g,b]=o.useState("upcoming");o.useEffect(()=>{N()},[i]);async function N(){var t;if(i){console.log("Loading worker data for ID:",i,"Type:",typeof i),y(!0);try{const r=await u.get(`/workers/${i}`);console.log("Worker API response:",r.data),r.data.status==="success"&&D(r.data.data.worker);const a=await u.get(`/assignments?worker_id=${i}`);console.log("Assignments API response:",a.data),a.data.status==="success"&&P(a.data.data||[])}catch(r){console.error("Failed to load worker data:",r),console.error("Error details:",(t=r.response)==null?void 0:t.data)}finally{y(!1)}}}async function S(){if(s)try{(await u({method:"PATCH",url:`/workers/${i}`,data:{worker:{active:!s.active}}})).data.status==="success"&&N()}catch(t){console.error("Failed to update worker status:",t),alert("Failed to update worker status")}}if(E)return e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx($,{})});if(!i)return e.jsx("div",{className:"p-8",children:e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"❌"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Invalid Worker ID"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"No worker ID provided in the URL."}),e.jsx("button",{onClick:()=>m("/workers"),className:"mt-4 px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition",children:"Back to Workers"})]})});if(!s)return e.jsx("div",{className:"p-8",children:e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"❌"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Worker Not Found"}),e.jsxs("p",{className:"text-gray-600 mb-4",children:['Worker with ID "',i,'" could not be found.']}),e.jsx("button",{onClick:()=>m("/workers"),className:"mt-4 px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition",children:"Back to Workers"})]})});const T=v.filter(t=>{var l,n;if(!["assigned","confirmed"].includes(t.status)||!((l=t.shift)!=null&&l.start_time_utc)||new Date(t.shift.start_time_utc)<=new Date)return!1;const a=((n=t.shift.event)==null?void 0:n.title)||t.shift.event_title||t.shift.client_name;return!(!a||a==="Unknown Event"||a.trim()==="")}).sort((t,r)=>{var n,d;const a=new Date(((n=t.shift)==null?void 0:n.start_time_utc)||0).getTime(),l=new Date(((d=r.shift)==null?void 0:d.start_time_utc)||0).getTime();return a-l}),x=new Map;T.forEach(t=>{var n,d,_;const r=((n=t.shift.event)==null?void 0:n.id)||t.shift.event_id||t.shift.id,a=((d=t.shift.event)==null?void 0:d.title)||t.shift.event_title||t.shift.client_name,l=r;if(!x.has(l))x.set(l,{id:r,event_name:a,event_date:t.shift.start_time_utc,shift_start_time:t.shift.start_time_utc,shift_end_time:t.shift.end_time_utc,venue_name:((_=t.shift.event)==null?void 0:_.venue_name)||t.shift.location||"TBD",role:t.shift.role_needed,assignments:[t]});else{const c=x.get(l);c.roles||(c.roles=[c.role]),c.roles.includes(t.shift.role_needed)||c.roles.push(t.shift.role_needed),c.assignments.push(t)}});const f=Array.from(x.values()),p=v.filter(t=>{var r;return["completed","cancelled"].includes(t.status)||((r=t.shift)==null?void 0:r.start_time_utc)&&new Date(t.shift.start_time_utc)<new Date});return e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-5xl mx-auto p-8",children:[e.jsxs("button",{onClick:()=>m("/workers"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-6 transition",children:[e.jsx(M,{size:20}),"Back to Workers"]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 mb-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"w-20 h-20 rounded-full bg-gray-200 flex items-center justify-center text-gray-600 text-2xl font-semibold",children:[s.first_name[0],s.last_name[0]]}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-semibold text-gray-900",children:[s.first_name," ",s.last_name]}),e.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[s.active?e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 bg-green-100 text-green-700 text-sm font-medium rounded-full",children:[e.jsx(F,{size:14}),"Active"]}):e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 bg-gray-100 text-gray-600 text-sm font-medium rounded-full",children:[e.jsx(R,{size:14}),"Inactive"]}),e.jsxs("span",{className:"text-sm text-gray-500",children:["Joined ",h(s.created_at)]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:S,className:`px-4 py-2 text-sm font-medium rounded-lg transition ${s.active?"bg-gray-100 text-gray-700 hover:bg-gray-200":"bg-green-100 text-green-700 hover:bg-green-200"}`,children:s.active?"Deactivate":"Activate"}),e.jsxs("button",{onClick:()=>m(`/workers/${i}/edit`),className:"px-4 py-2 bg-teal-600 text-white text-sm font-medium rounded-lg hover:bg-teal-700 transition flex items-center gap-2",children:[e.jsx(U,{size:16}),"Edit"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gray-100 flex items-center justify-center",children:e.jsx(H,{size:18,className:"text-gray-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Email"}),e.jsx("p",{className:"text-sm font-medium text-gray-900",children:s.email})]})]}),s.phone&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gray-100 flex items-center justify-center",children:e.jsx(B,{size:18,className:"text-gray-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Phone"}),e.jsx("p",{className:"text-sm font-medium text-gray-900",children:s.phone_formatted||L(s.phone)})]})]}),(s.address_line1||s.address_line2)&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gray-100 flex items-center justify-center",children:e.jsx(j,{size:18,className:"text-gray-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Address"}),e.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[s.address_line1,s.address_line2&&`, ${s.address_line2}`]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Skills"}),s.skills_json&&s.skills_json.length>0?e.jsx("div",{className:"flex flex-wrap gap-2",children:s.skills_json.map((t,r)=>e.jsx("span",{className:"px-3 py-1.5 bg-teal-100 text-teal-700 text-sm font-medium rounded-lg",children:t},r))}):e.jsx("p",{className:"text-gray-500 text-sm",children:"No skills added yet"})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Certifications"}),s.certifications&&s.certifications.length>0?e.jsx("div",{className:"space-y-2",children:s.certifications.map(t=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(q,{size:16,className:"text-teal-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:t.name})]}),t.expires_at_utc&&e.jsxs("span",{className:"text-xs text-gray-500",children:["Exp: ",h(t.expires_at_utc)]})]},t.id))}):e.jsx("p",{className:"text-gray-500 text-sm",children:"No certifications added yet"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200",children:[e.jsx("div",{className:"border-b border-gray-200 px-6",children:e.jsxs("div",{className:"flex gap-6",children:[e.jsxs("button",{onClick:()=>b("upcoming"),className:`py-4 px-1 font-medium transition-colors border-b-2 ${g==="upcoming"?"border-teal-600 text-teal-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:["Upcoming (",f.length,")"]}),e.jsxs("button",{onClick:()=>b("past"),className:`py-4 px-1 font-medium transition-colors border-b-2 ${g==="past"?"border-teal-600 text-teal-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:["Past (",p.length,")"]})]})}),e.jsx("div",{className:"p-6",children:g==="upcoming"?f.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(X,{size:48,className:"mx-auto mb-2 text-gray-300"}),e.jsx("p",{children:"No upcoming assignments"})]}):e.jsx("div",{className:"space-y-3",children:f.map(t=>e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg hover:border-gray-300 transition",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:t.event_name}),e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 text-xs font-medium rounded",children:t.role})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(A,{size:14}),h(t.shift_start_time)]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(C,{size:14}),w(t.shift_start_time)," - ",w(t.shift_end_time)]}),t.venue_name&&t.venue_name!=="No venue"&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(j,{size:14}),t.venue_name]})]})]},t.id))}):p.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(C,{size:48,className:"mx-auto mb-2 text-gray-300"}),e.jsx("p",{children:"No past assignments"})]}):e.jsx("div",{className:"space-y-3",children:p.map(t=>{var r,a;return e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:((r=t.shift.event)==null?void 0:r.title)||t.shift.event_title||"Unknown Event"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 text-xs font-medium rounded",children:t.shift.role_needed}),t.hours_worked&&e.jsxs("span",{className:"px-2 py-1 bg-green-100 text-green-700 text-xs font-medium rounded",children:[t.hours_worked," hrs"]})]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(A,{size:14}),h(t.actual_start_time_utc||t.shift.start_time_utc)]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(j,{size:14}),((a=t.shift.event)==null?void 0:a.venue_name)||(typeof t.shift.location=="string"?t.shift.location:null)||"No venue"]})]}),k(t)&&e.jsxs("div",{className:`mt-2 text-xs font-medium ${t.status==="no_show"||t.status==="cancelled"||t.status==="removed"?"text-red-600":t.approved?"text-green-700":"text-gray-500"}`,children:[k(t),t.approval_notes&&e.jsxs("span",{className:"block mt-0.5 text-gray-400",children:["• ",t.approval_notes]})]})]},t.id)})})})]})]})})}export{ie as WorkerDetailPage};
