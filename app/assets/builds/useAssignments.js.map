{"version":3,"file":"useAssignments.js","sources":["../../../social-catering-ui/social-catering-ui/src/hooks/useAssignments.ts"],"sourcesContent":["import { useState, useEffect, useMemo } from 'react';\nimport { getAssignments, updateAssignmentStatus as updateAssignmentStatusApi, deleteAssignment as deleteAssignmentApi } from '../services/assignmentsApi';\nimport type { Assignment } from '../services/assignmentsApi';\nimport type { AssignmentFilterParams } from '../types';\n\ninterface UseAssignmentsParams {\n  worker_id?: number;\n  shift_id?: number;\n  status?: string;\n  timeframe?: 'past' | 'today' | 'upcoming';\n  start_date?: string;\n  end_date?: string;\n}\n\ninterface UseAssignmentsReturn {\n  assignments: Assignment[];\n  loading: boolean;\n  error: string | null;\n  filters: AssignmentFilterParams;\n  setFilters: (filters: AssignmentFilterParams) => void;\n  refetch: () => void;\n  updateAssignmentStatus: (id: number, status: string) => Promise<void>;\n  deleteAssignment: (id: number) => Promise<void>;\n}\n\nexport function useAssignments(params?: UseAssignmentsParams): UseAssignmentsReturn {\n  const [assignments, setAssignments] = useState<Assignment[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [filters, setFilters] = useState<AssignmentFilterParams>({});\n\n  // Memoize the merged params to prevent unnecessary re-renders\n  const mergedParams = useMemo(() => ({ ...filters, ...params }), [filters, params]);\n\n  const fetchAssignments = async () => {\n    try {\n      setLoading(true);\n      setError(null);\n      \n      const response = await getAssignments(mergedParams);\n      \n      if (response.status === 'success' && response.data?.assignments) {\n        setAssignments(response.data.assignments);\n      } else {\n        setError('Failed to fetch assignments');\n      }\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'An error occurred');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const updateAssignmentStatus = async (id: number, status: string) => {\n    try {\n      const response = await updateAssignmentStatusApi(id, status as any);\n      \n      if (response.status === 'success') {\n        // Update local state\n        setAssignments(prev => \n          prev.map(assignment => \n            assignment.id === id \n              ? { ...assignment, status: status as any }\n              : assignment\n          )\n        );\n      } else {\n        setError('Failed to update assignment status');\n      }\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to update assignment status');\n    }\n  };\n\n  const deleteAssignment = async (id: number) => {\n    try {\n      await deleteAssignmentApi(id);\n      \n      // Remove from local state\n      setAssignments(prev => prev.filter(assignment => assignment.id !== id));\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to delete assignment');\n    }\n  };\n\n  useEffect(() => {\n    fetchAssignments();\n  }, [mergedParams]);\n\n  return {\n    assignments,\n    loading,\n    error,\n    filters,\n    setFilters,\n    refetch: fetchAssignments,\n    updateAssignmentStatus,\n    deleteAssignment,\n  };\n}\n"],"names":["useAssignments","params","assignments","setAssignments","useState","loading","setLoading","error","setError","filters","setFilters","mergedParams","useMemo","fetchAssignments","response","getAssignments","err","updateAssignmentStatus","id","status","updateAssignmentStatusApi","prev","assignment","deleteAssignment","deleteAssignmentApi","useEffect"],"mappings":"kGAyBO,SAASA,EAAeC,EAAqD,CAClF,KAAM,CAACC,EAAaC,CAAc,EAAIC,EAAAA,SAAuB,CAAA,CAAE,EACzD,CAACC,EAASC,CAAU,EAAIF,EAAAA,SAAS,EAAI,EACrC,CAACG,EAAOC,CAAQ,EAAIJ,EAAAA,SAAwB,IAAI,EAChD,CAACK,EAASC,CAAU,EAAIN,EAAAA,SAAiC,CAAA,CAAE,EAG3DO,EAAeC,EAAAA,QAAQ,KAAO,CAAE,GAAGH,EAAS,GAAGR,CAAA,GAAW,CAACQ,EAASR,CAAM,CAAC,EAE3EY,EAAmB,SAAY,CACnC,GAAI,CACFP,EAAW,EAAI,EACfE,EAAS,IAAI,EAEb,MAAMM,EAAW,MAAMC,EAAeJ,CAAY,EAE9CG,EAAS,SAAW,WAAaA,EAAS,MAAM,YAClDX,EAAeW,EAAS,KAAK,WAAW,EAExCN,EAAS,6BAA6B,CAE1C,OAASQ,EAAK,CACZR,EAASQ,aAAe,MAAQA,EAAI,QAAU,mBAAmB,CACnE,QAAA,CACEV,EAAW,EAAK,CAClB,CACF,EAEMW,EAAyB,MAAOC,EAAYC,IAAmB,CACnE,GAAI,EACe,MAAMC,EAA0BF,EAAIC,CAAa,GAErD,SAAW,UAEtBhB,KACEkB,EAAK,IAAIC,GACPA,EAAW,KAAOJ,EACd,CAAE,GAAGI,EAAY,OAAAH,GACjBG,CAAA,CACN,EAGFd,EAAS,oCAAoC,CAEjD,OAASQ,EAAK,CACZR,EAASQ,aAAe,MAAQA,EAAI,QAAU,oCAAoC,CACpF,CACF,EAEMO,EAAmB,MAAOL,GAAe,CAC7C,GAAI,CACF,MAAMM,EAAoBN,CAAE,EAG5Bf,KAAuBkB,EAAK,UAAqBC,EAAW,KAAOJ,CAAE,CAAC,CACxE,OAASF,EAAK,CACZR,EAASQ,aAAe,MAAQA,EAAI,QAAU,6BAA6B,CAC7E,CACF,EAEAS,OAAAA,EAAAA,UAAU,IAAM,CACdZ,EAAA,CACF,EAAG,CAACF,CAAY,CAAC,EAEV,CACL,YAAAT,EACA,QAAAG,EACA,MAAAE,EACA,QAAAE,EACA,WAAAC,EACA,QAASG,EAAA,uBACTI,EAAA,iBACAM,CAAA,CAEJ"}